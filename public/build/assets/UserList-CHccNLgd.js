import{_ as d,c as m,d as n,f as p,w as f,i as u,C as c,D as g,a as h,p as b,a4 as S,b as w}from"./app-Cv_muMPT.js";import{s as x}from"./router_aware_sort_and_filter-DfeIEInP.js";const y={name:"ComponentName",props:{},setup(){const{sort:t,filter:e}=x({field:"person.name",desc:!1});return{sort:t,filter:e}},data(){return{users:[],fields:[{name:"id",type:Number,sortable:!0},{name:"person.name",label:"Name",type:String,sortable:!0},{name:"person.email",label:"Email",type:String,sortable:!0},{name:"roles",label:"System Roles",type:String,sortable:!1,resolveValue(t){return t.roles.map(e=>e.display_name).join(", ")}},{name:"permissions",label:"+ Permissions",type:String,sortable:!1,resolveValue(t){return t.permissions.map(e=>e.display_name).join(", ")},class:"text-xs"}]}},computed:{filteredUsers(){if(!this.filter)return this.users;const t=new RegExp(`.*${this.filter}.*`,"i");return this.users.filter(e=>e.person.name.match(t)||e.person.email.match(t))}},watch:{filter:{immediate:!0,handler(){this.triggerSearch&&this.triggerSearch()}},sort:{immediate:!0,handler(){this.triggerSearch&&this.triggerSearch()}}},created(){this.triggerSearch=S(()=>this.$refs.dataTable.getItems(),500)},methods:{async getUsers(t,e,a,r){const i={page:t,page_size:e,"sort[field]":a.field.name,"sort[dir]":a.desc?"DESC":"ASC","where[filterString]":this.filter,with:["roles","permissions"],paginated:!0},s=await b.get("/api/users",{params:i}).then(o=>o.data);return r(s.meta.total),s.data},goToUser(t){this.$router.push({name:"UserDetail",params:{id:t.id}})}}};function U(t,e,a,r,i,s){const o=h("data-table");return w(),m("div",null,[e[3]||(e[3]=n("h1",null,"Users",-1)),p(o,{ref:"dataTable",sort:r.sort,"onUpdate:sort":e[1]||(e[1]=l=>r.sort=l),fields:i.fields,data:s.getUsers,"row-class":"cursor-pointer",paginated:"",onRowClick:s.goToUser},{header:f(()=>[n("div",null,[e[2]||(e[2]=u("Filter: Â ")),c(n("input",{"onUpdate:modelValue":e[0]||(e[0]=l=>r.filter=l),type:"text",placeholder:"name, email"},null,512),[[g,r.filter]])])]),_:1},8,["sort","fields","data","onRowClick"])])}const v=d(y,[["render",U]]);export{v as default};
//# sourceMappingURL=UserList-CHccNLgd.js.map
