import{r as c,_ as p,B as f,a as g,c as m,b as h,d as l,f as S,w as b,i as w,C as P,D as x,p as _,N as v}from"./app-Dodz6L5-.js";import{s as T}from"./router_aware_sort_and_filter-BuajIqLi.js";const d=20,u=c(0),k=e=>{const t=u.value*d,s=t+d-1;return e.slice(t,s)},y=[{name:"name",sortable:!0,type:String},{name:"email",sortable:!0,type:String},{name:"institution.name",label:"Institution",sortable:!0,type:String,resolveSort(e){return e.institution?e.institution.name:""}}],C={data(){return{fields:y}},computed:{...f({currentUser:"currentUser"})},watch:{filter:{immediate:!0,handler(){this.triggerSearch&&this.triggerSearch()}},sort:{immediate:!0,handler(){this.triggerSearch&&this.triggerSearch()}}},created(){this.triggerSearch&&this.triggerSearch(),this.triggerSearch=v(()=>this.$refs.dataTable.getItems(),500)},methods:{goToPerson(e){this.$router.push(`/people/${e.uuid}`)},goToEditPerson(e){this.$router.push(`/people/${e.uuid}/edit`)},canEdit(e){return!!(this.hasPermission("people-manage")||this.currentUser.id===e.user_id)},async itemProvider(e,t,s,r){const i={page:e,page_size:t,"sort[field]":s.field.name,"sort[dir]":s.desc?"DESC":"ASC","where[filterString]":this.filter},a=await _.get("/api/people",{params:i}).then(o=>o.data);return r(a.meta.total),a.data}},setup(){const{sort:e,filter:t}=T();return{sort:e,filter:t,pageSize:d,currentPage:u,getPageItems:k}}},I={class:"block mb-2",for:"filter-input"};function U(e,t,s,r,i,a){const o=g("data-table");return h(),m("div",null,[t[3]||(t[3]=l("h1",null,"People",-1)),S(o,{ref:"dataTable",sort:r.sort,"onUpdate:sort":t[1]||(t[1]=n=>r.sort=n),data:a.itemProvider,fields:i.fields,class:"width-full","row-click-handler":a.goToPerson,"row-class":"cursor-pointer","page-size":20,paginated:""},{header:b(()=>[l("label",I,[t[2]||(t[2]=w("Filter:Â ")),P(l("input",{"onUpdate:modelValue":t[0]||(t[0]=n=>r.filter=n),type:"text",placeholder:"filter"},null,512),[[x,r.filter]])])]),_:1},8,["sort","data","fields","row-click-handler"])])}const N=p(C,[["render",U]]);export{N as default};
//# sourceMappingURL=PeopleList-KNomGmoc.js.map
