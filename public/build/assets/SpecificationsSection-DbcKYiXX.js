import{r as x,q as U,c as i,d as e,h as _,C as j,D as be,Z as Q,F,m as Y,a5 as pe,i as y,j as u,p as J,v as he,b as a,n as fe,_ as me,an as Ve,aL as Pe,aM as Ee,aN as Ie,y as Ue,o as Le,f as M,w as B,e as te,a as L,a0 as Ne,a2 as ge,E as Oe,am as Me,A as Fe,a1 as Be}from"./app-uoJXbb9N.js";const Re={class:"space-y-4"},qe={class:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-2"},je={class:"flex items-center gap-2"},Ke=["value"],ze={class:"flex items-center gap-2"},He=["value"],Ye={key:0,class:"flex items-center gap-2 bg-gray-50 p-3 border rounded mb-3"},Ze=["disabled"],Je={class:"border"},Qe={class:"table-auto w-full border min-w-full"},We={class:"bg-gray-100 sticky top-0 z-10"},Xe={key:0,class:"px-2"},$e=["checked","disabled"],et={key:0},tt={key:0},ot={key:0},lt={class:"hover:bg-gray-50"},st={key:0,class:"px-2"},nt=["checked","onChange","disabled"],at=["onClick"],it=["onClick"],rt={class:"px-4 py-2"},dt=["onUpdate:modelValue","onChange","disabled"],ut={key:0,class:"ml-2 text-gray-500"},ct={key:1},pt={key:0},mt={colspan:"4",class:"bg-gray-100 px-6 py-3 text-sm"},vt={class:"grid grid-cols-2 text-sm text-gray-700"},_t={class:"flex justify-center items-center gap-2 mt-4"},yt=["disabled"],ft={class:"text-sm"},bt=["disabled"],il={__name:"GeneCurationStatus",props:{genes:{type:Array,required:!0,default:()=>[]},groupID:{type:String,required:!0},editing:{type:Boolean,default:!0},readonly:{type:Boolean,default:!1}},setup(v){const t=v,f=he(),l=x(""),p=x(1),h=x(20),G=x(null),A=x([]),b=x([]),N=x(""),S=x(!1),k=x("gene_symbol"),I=x("asc"),s=x(""),P={"Not Curated":0,Uploaded:1,Precuration:2,"Disease entity assigned":3,"Precuration Complete":4,"Curation Provisional":5,"Curation Approved":6,"Recuration assigned":7,"Retired Assignment":8,Published:9},K=U(()=>{const m=new Set;return t.genes.forEach(n=>n.statuses.forEach(r=>m.add(r))),Array.from(m).sort((n,r)=>P[n]-P[r])}),R=U(()=>{const m=l.value.toLowerCase();return t.genes.filter(n=>{const r=n.gene_symbol.toLowerCase().includes(m),T=n.statuses.some(Z=>Z.toLowerCase().includes(m)),w=!l.value||r||T,X=!s.value||n.statuses.includes(s.value);return w&&X})}),O=U(()=>[...R.value].sort((m,n)=>{let r,T;if(k.value==="statuses"){const w=Math.max(...m.statuses.map(Z=>P[Z]||0)),X=Math.max(...n.statuses.map(Z=>P[Z]||0));r=w,T=X}else k.value==="tier"?(r=m.tier||0,T=n.tier||0):(r=m.gene_symbol,T=n.gene_symbol);return I.value==="asc"?r>T?1:-1:r<T?1:-1})),g=U(()=>Math.ceil(O.value.length/h.value)),z=U(()=>{const m=(p.value-1)*h.value;return O.value.slice(m,m+h.value)}),V=m=>{A.value.includes(m)?A.value=A.value.filter(n=>n!==m):A.value.push(m)},oe=m=>{b.value.includes(m)?b.value=b.value.filter(n=>n!==m):b.value.push(m)},W=()=>{const m=z.value.map(r=>r.id);m.every(r=>b.value.includes(r))?b.value=b.value.filter(r=>!m.includes(r)):b.value=[...new Set([...b.value,...m])]},q=U(()=>z.value.every(m=>b.value.includes(m.id))),le=async m=>{var r;if(console.log(t.groupID),t.readonly||!t.editing)return;G.value=m.id;const n=m.tier;try{await J.put(`/api/groups/${t.groupID}/expert-panel/genes/update-tier`,{ids:[m.id],tier:m.tier||null}),f.commit("pushSuccess",`Tier updated for ${m.gene_symbol}`)}catch(T){m.tier=n,f.commit("pushError",`Failed to update tier for ${m.gene_symbol}`),console.error(((r=T.response)==null?void 0:r.data)||T.message)}finally{G.value=null}},se=async()=>{if(!(!N.value||b.value.length===0)){S.value=!0;try{await J.put(`/api/groups/${t.groupID}/expert-panel/genes/update-tier`,{ids:b.value,tier:N.value}),f.commit("pushSuccess",`Tier updated for ${b.value.length} genes`),t.genes.forEach(m=>{b.value.includes(m.id)&&(m.tier=N.value)}),b.value=[],N.value=""}catch{f.commit("pushError","Failed to update tiers in bulk")}finally{S.value=!1}}},$=m=>{k.value===m?I.value=I.value==="asc"?"desc":"asc":(k.value=m,I.value="asc")};return(m,n)=>(a(),i("div",Re,[e("div",qe,[j(e("input",{"onUpdate:modelValue":n[0]||(n[0]=r=>l.value=r),type:"text",placeholder:"Search gene or status...",class:"border px-3 py-1.5 rounded text-sm w-full sm:w-64"},null,512),[[be,l.value]]),e("div",je,[n[10]||(n[10]=e("label",{class:"text-sm"},"Filter by Status:",-1)),j(e("select",{"onUpdate:modelValue":n[1]||(n[1]=r=>s.value=r),class:"border rounded px-2 py-1 text-sm"},[n[9]||(n[9]=e("option",{value:""},"All",-1)),(a(!0),i(F,null,Y(K.value,r=>(a(),i("option",{key:r,value:r},u(r),9,Ke))),128))],512),[[Q,s.value]])]),e("div",ze,[n[11]||(n[11]=e("label",{class:"text-sm"},"Page size:",-1)),j(e("select",{"onUpdate:modelValue":n[2]||(n[2]=r=>h.value=r),class:"border px-2 py-1 rounded text-sm"},[(a(),i(F,null,Y([20,50,100],r=>e("option",{key:r,value:r},u(r),9,He)),64))],512),[[Q,h.value]])])]),b.value.length>0&&v.editing&&!v.readonly?(a(),i("div",Ye,[n[13]||(n[13]=e("span",{class:"font-semibold"},"Bulk Tier Update:",-1)),j(e("select",{"onUpdate:modelValue":n[3]||(n[3]=r=>N.value=r),class:"border rounded px-2 py-1 text-sm"},n[12]||(n[12]=[pe('<option value="">Select Tier</option><option value="1">Tier 1</option><option value="2">Tier 2</option><option value="3">Tier 3</option><option value="4">Tier 4</option>',5)]),512),[[Q,N.value]]),e("button",{class:"bg-blue-600 text-white px-3 py-1 rounded disabled:opacity-50",onClick:se,disabled:!N.value||b.value.length===0}," Apply ",8,Ze)])):_("",!0),e("div",Je,[e("table",Qe,[e("thead",We,[e("tr",null,[v.editing&&!v.readonly?(a(),i("th",Xe,[e("input",{type:"checkbox",checked:q.value,onChange:W,disabled:v.readonly||!v.editing},null,40,$e)])):_("",!0),e("th",{class:"text-left px-4 py-2 cursor-pointer",onClick:n[4]||(n[4]=r=>$("gene_symbol"))},[n[14]||(n[14]=y(" Gene ")),k.value==="gene_symbol"?(a(),i("span",et,u(I.value==="asc"?"▲":"▼"),1)):_("",!0)]),e("th",{class:"text-left px-4 py-2 cursor-pointer",onClick:n[5]||(n[5]=r=>$("statuses"))},[n[15]||(n[15]=y(" Statuses ")),k.value==="statuses"?(a(),i("span",tt,u(I.value==="asc"?"▲":"▼"),1)):_("",!0)]),e("th",{class:"text-left px-4 py-2 cursor-pointer",onClick:n[6]||(n[6]=r=>$("tier"))},[n[16]||(n[16]=y(" Tier ")),k.value==="tier"?(a(),i("span",ot,u(I.value==="asc"?"▲":"▼"),1)):_("",!0)])])]),e("tbody",null,[(a(!0),i(F,null,Y(z.value,(r,T)=>(a(),i(F,{key:r.id},[e("tr",lt,[v.editing&&!v.readonly?(a(),i("td",st,[e("input",{type:"checkbox",checked:b.value.includes(r.id),onChange:w=>oe(r.id),disabled:v.readonly||!v.editing},null,40,nt)])):_("",!0),e("td",{class:fe(["font-mono text-blue-800 px-4 py-2",{"cursor-pointer":r.details.length>0,"cursor-default":r.details.length===0}]),onClick:w=>r.details.length>0&&V(T)},u(r.gene_symbol),11,at),e("td",{class:fe(["px-4 py-2",{"cursor-pointer":r.details.length>0,"cursor-default":r.details.length===0}]),onClick:w=>r.details.length>0&&V(T)},u(r.statuses.join(", "))+" ("+u(r.details.length)+") ",11,it),e("td",rt,[!v.readonly&&v.editing?(a(),i(F,{key:0},[j(e("select",{"onUpdate:modelValue":w=>r.tier=w,class:"border rounded px-1 py-0.5",onChange:w=>le(r),disabled:G.value===r.id||v.readonly||!v.editing},n[17]||(n[17]=[pe('<option value="">—</option><option value="1">Tier 1</option><option value="2">Tier 2</option><option value="3">Tier 3</option><option value="4">Tier 4</option>',5)]),40,dt),[[Q,r.tier]]),G.value===r.id?(a(),i("span",ut,"Saving...")):_("",!0)],64)):(a(),i("span",ct,u(r.tier||"—"),1))])]),A.value.includes(T)?(a(),i("tr",pt,[e("td",mt,[(a(!0),i(F,null,Y(r.details,w=>(a(),i("div",{key:w.disease+w.curation_status,class:"mb-2"},[e("div",vt,[e("div",null,[n[18]||(n[18]=e("strong",null,"Status:",-1)),y(" "+u(w.curation_status),1)]),e("div",null,[n[19]||(n[19]=e("strong",null,"Status Date:",-1)),y(" "+u(new Date(w==null?void 0:w.date_approved).toLocaleString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"numeric",minute:"2-digit",hour12:!0})),1)]),e("div",null,[n[20]||(n[20]=e("strong",null,"Disease:",-1)),y(" "+u(w.mondo_id)+" "+u(w.disease),1)]),e("div",null,[n[21]||(n[21]=e("strong",null,"Expert Panel:",-1)),y(" "+u(w.expert_panel),1)]),e("div",null,[n[22]||(n[22]=e("strong",null,"Classification:",-1)),y(" "+u(w.classification),1)]),e("div",null,[n[23]||(n[23]=e("strong",null,"MOI:",-1)),y(" "+u(w.moi),1)]),e("div",null,[n[24]||(n[24]=e("strong",null,"Type:",-1)),y(" "+u(w.curation_type),1)]),e("div",null,[n[25]||(n[25]=e("strong",null,"Phenotype:",-1)),y(" "+u(w.phenotypes),1)])]),n[26]||(n[26]=e("hr",null,null,-1))]))),128))])])):_("",!0)],64))),128))])])]),e("div",_t,[e("button",{onClick:n[7]||(n[7]=r=>p.value--),disabled:p.value===1,class:"btn"},"Prev",8,yt),e("span",ft,"Page "+u(p.value)+" / "+u(g.value),1),e("button",{onClick:n[8]||(n[8]=r=>p.value++),disabled:p.value===g.value,class:"btn"},"Next",8,bt)])]))}},ht={name:"VcepGeneList",components:{GeneSearchSelect:Ie,DiseaseSearchSelect:Ee,CuratedGeneSearchSelect:Pe,RichTextEditor:Ve},props:{readonly:{type:Boolean,required:!1,default:!1},editing:{type:Boolean,required:!1,default:!0}},emits:["saved"],setup(v,{emit:t}){const f=he(),l=x([]),p=x(null),h=x(!1),G=x(!1),A=x(0),b=x({}),N=x([]),S=x([]),k=x(""),I=x(null),s=x(""),P=x(""),K=x(""),R=x("gene_symbol"),O=x("asc"),g=x(1),z=x(20),V=U(()=>f.getters["groups/currentItemOrNew"]),oe=U(()=>Ue(["ep-applications-manage",["application-edit",V.value]])&&!v.readonly),W=x(!1),q=x(null),le=o=>{q.value=o,W.value=!0},se=()=>{q.value=null,W.value=!1},$=async()=>{if(q.value)try{await J.delete(`/api/groups/${V.value.uuid}/expert-panel/genes/${q.value.id}`),W.value=!1,f.commit("pushSuccess",`Successfully removed gene ${q.value.gene_symbol}`),q.value=null,await n()}catch(o){f.commit("pushError",o.response.data)}},m=async()=>{try{const o=await J.get("/api/mois");N.value=o.data}catch(o){f.commit("pushError",o.response.data)}},n=async()=>{var o;if(V.value.uuid)try{await f.dispatch("groups/getGenes",V.value),l.value=V.value.expert_panel.genes}catch(d){f.commit("pushError",((o=d.response)==null?void 0:o.data)||d)}},r=o=>{R.value===o?O.value=O.value==="asc"?"desc":"asc":(R.value=o,O.value="asc")},T=()=>{G.value=!0,h.value=!1,p.value=null,A.value++},w=o=>{var d,c,C,E;if(G.value=!0,h.value=o.id,(d=o.plan)!=null&&d.is_other)p.value={id:o.id,is_other:!0,custom_gene:{hgnc_id:o.hgnc_id,gene_symbol:o.gene_symbol},custom_disease:{mondo_id:o.mondo_id,name:o.disease_name},custom_moi:N.value.find(D=>D.abbreviation===o.moi)||null,custom_plan:o.plan.the_plan||""};else{const D={...o.plan,is_other:!1,curated_plan_text:((c=o.plan)==null?void 0:c.curated_plan_text)??((C=o.plan)==null?void 0:C.the_plan)??""};p.value={id:o.id,hgnc_id:o.hgnc_id,gene_symbol:o.gene_symbol,disease_name:o.disease_name,mondo_id:o.mondo_id,moi:o.moi,date_approved:o.date_approved,requires_plan:["Moderate","Limited"].includes((E=o.plan)==null?void 0:E.classification),plan:D,curated_plan_text:D.curated_plan_text,is_other:!1}}A.value++},X=()=>{G.value=!1,h.value=!1,p.value=null,b.value={}},Z=U(()=>{var o,d,c,C;return(o=p.value)!=null&&o.is_other?!!((d=p.value.custom_gene)!=null&&d.hgnc_id)&&!!((c=p.value.custom_disease)!=null&&c.mondo_id)&&((C=p.value.custom_plan)==null?void 0:C.trim().length)>=20:!1}),ie=()=>{var d;const o=((d=p.value)==null?void 0:d.id)||null;p.value={id:o,is_other:!0,custom_gene:null,custom_disease:null,custom_moi:null,custom_plan:""}},re=o=>{o&&!o.is_other&&(p.value={...o,is_other:!1,requires_plan:["Moderate","Limited"].includes(o.classification),curated_plan_text:""})},de=U(()=>{var d;return(d=p.value)!=null&&d.requires_plan?(p.value.curated_plan_text||"").replace(/<[^>]+>/g,"").trim().length>=20:!0}),ue=o=>{const d=o!=null&&o.plan&&Object.keys(o.plan).length?o.plan:{},c={curation_id:d.curation_id??o.curation_id,gene_symbol:d.gene_symbol??o.gene_symbol,hgnc_id:d.hgnc_id??o.hgnc_id,hgnc_name:d.hgnc_name??o.hgnc_name??null,disease_name:d.disease_name??o.disease_name,mondo_id:d.mondo_id??o.mondo_id,expert_panel:d.expert_panel??o.expert_panel??null,moi:d.moi??o.moi,moi_name:d.moi_name??o.moi_name??null,hp_id:d.hp_id??o.hp_id??null,classification_id:d.classification_id??o.classification_id??null,classification:d.classification??o.classification??null,curation_status_id:d.curation_status_id??o.curation_status_id??null,curation_type:d.curation_type??o.curation_type??null,curation_status:d.curation_status??o.curation_status??null,date_approved:d.date_approved??o.date_approved??null,phenotypes:d.phenotypes??o.phenotypes??null,phenotypeIDs:d.phenotypeIDs??o.phenotypeIDs??null,checkKey:d.checkKey??o.checkKey??null,is_other:!1,requires_plan:!!(o!=null&&o.requires_plan),curated_plan_text:o!=null&&o.requires_plan?(o==null?void 0:o.curated_plan_text)||d.curated_plan_text||"":d.curated_plan_text||""};return Object.keys(c).forEach(C=>c[C]===void 0&&delete c[C]),c},ce=async()=>{var o,d,c,C,E,D,ae;try{let ee;if(p.value.is_other){const ye={is_other:!0,the_plan:p.value.custom_plan,moi_name:((o=p.value.custom_moi)==null?void 0:o.name)||"",hp_id:((d=p.value.custom_moi)==null?void 0:d.hp_id)||""};ee={is_other:!0,hgnc_id:((c=p.value.custom_gene)==null?void 0:c.hgnc_id)||null,gene_symbol:((C=p.value.custom_gene)==null?void 0:C.gene_symbol)||"",disease_name:((E=p.value.custom_disease)==null?void 0:E.name)||"",mondo_id:((D=p.value.custom_disease)==null?void 0:D.mondo_id)||"",moi:((ae=p.value.custom_moi)==null?void 0:ae.abbreviation)||"",plan:ye,date_approved:null}}else{const ye=ue(p.value);ee={hgnc_id:p.value.hgnc_id,gene_symbol:p.value.gene_symbol,disease_name:p.value.disease_name,mondo_id:p.value.mondo_id,moi:p.value.moi,date_approved:p.value.date_approved,plan:ye,is_other:!1}}h.value?await J.put(`/api/groups/${V.value.uuid}/expert-panel/genes/${h.value}`,ee):await J.post(`/api/groups/${V.value.uuid}/expert-panel/genes`,{genes:[ee]}),await n(),X(),t("saved")}catch(ee){ge(ee)?b.value=ee.response.data.errors:f.commit("pushError",ee.response.data)}},H=async o=>{try{await J.delete(`/api/groups/${V.value.uuid}/expert-panel/genes/${o.id}`),await n()}catch(d){f.commit("pushError",d.response.data)}},xe=async o=>{I.value=o.id;const d=o.tier;try{await J.put(`/api/groups/${V.value.uuid}/expert-panel/genes/update-tier`,{ids:[o.id],tier:o.tier||null}),f.commit("pushSuccess",`Tier updated for ${o.gene_symbol}`)}catch{o.tier=d,f.commit("pushError","Failed to update tier")}finally{I.value=null}},ke=async()=>{if(!(!k.value||S.value.length===0))try{await J.put(`/api/groups/${V.value.uuid}/expert-panel/genes/update-tier`,{ids:S.value,tier:k.value}),f.commit("pushSuccess",`Tier updated for ${S.value.length} genes`),S.value=[],await n(),k.value=""}catch{f.commit("pushError","Failed to update tiers in bulk")}},we=o=>{S.value.includes(o)?S.value=S.value.filter(d=>d!==o):S.value.push(o)},Ce=()=>{const o=_e.value.map(c=>c.id);o.every(c=>S.value.includes(c))?S.value=S.value.filter(c=>!o.includes(c)):S.value=[...new Set([...S.value,...o])]},ve=U(()=>{let o=[...l.value];const d=s.value.toLowerCase();return d&&(o=o.filter(c=>{var C,E,D,ae;return c.gene_symbol&&c.gene_symbol.toLowerCase().includes(d)||c.mondo_id&&c.mondo_id.toLowerCase().includes(d)||c.disease_name&&c.disease_name.toLowerCase().includes(d)||c.moi&&c.moi.toLowerCase().includes(d)||((C=c.plan)==null?void 0:C.the_plan)&&c.plan.the_plan.toLowerCase().includes(d)||((E=c.plan)==null?void 0:E.expert_panel)&&c.plan.expert_panel.toLowerCase().includes(d)||((D=c.plan)==null?void 0:D.classification)&&c.plan.classification.toLowerCase().includes(d)||((ae=c.plan)==null?void 0:ae.phenotypes)&&c.plan.phenotypes.toLowerCase().includes(d)})),P.value&&(o=o.filter(c=>c.moi===P.value)),K.value&&(o=o.filter(c=>{var C;return((C=c.plan)==null?void 0:C.classification)===K.value})),o.sort((c,C)=>{let E,D;switch(R.value){case"disease":E=`${c.mondo_id||""} ${c.disease_name||""}`.toLowerCase(),D=`${C.mondo_id||""} ${C.disease_name||""}`.toLowerCase();break;case"moi":E=c.moi||"",D=C.moi||"";break;case"tier":return E=c.tier?Number(c.tier):0,D=C.tier?Number(C.tier):0,O.value==="asc"?E-D:D-E;default:E=c.gene_symbol||"",D=C.gene_symbol||""}return O.value==="asc"?E.localeCompare(D):D.localeCompare(E)}),o}),Se=async o=>{var d;try{const c=o.gt_data;if(!c)return;const C={is_other:!1,hgnc_id:c.hgnc_id,gene_symbol:c.gene_symbol,disease_name:c.disease_name,mondo_id:c.mondo_id,moi:c.moi,date_approved:c.date_approved,plan:{...c,checkKey:c.checkKey,requires_plan:["Moderate","Limited"].includes((d=c.plan)==null?void 0:d.classification)}};await J.put(`/api/groups/${V.value.uuid}/expert-panel/genes/${o.id}`,C),f.commit("pushSuccess",`Updated ${o.gene_symbol} from GeneTracker`),await n()}catch{f.commit("pushError","Failed to apply update from GeneTracker")}},Te=U(()=>[...new Set(l.value.map(o=>o.moi).filter(Boolean))]),De=U(()=>[...new Set(l.value.map(o=>{var d;return(d=o.plan)==null?void 0:d.classification}).filter(Boolean))]),Ge=U(()=>Math.ceil(ve.value.length/z.value)),_e=U(()=>{const o=(g.value-1)*z.value;return ve.value.slice(o,o+z.value)}),Ae=U(()=>_e.value.every(o=>S.value.includes(o.id)));Le(()=>{n(),m()});const ne=x([]);return{group:V,genes:l,formGene:p,curatedGeneKey:A,isEditing:h,isFormVisible:G,mois:N,errors:b,search:s,filterMoi:P,filterClassification:K,sortKey:R,sortOrder:O,pageSize:z,currentPage:g,totalPages:Ge,paginatedGenes:_e,filteredAndSortedGenes:ve,moiOptions:Te,classificationOptions:De,selectedGenes:S,bulkTier:k,savingTierFor:I,isAllSelected:Ae,canEdit:oe,isOtherFormValid:Z,isCuratedPlanValid:de,toggleExpanded:o=>{ne.value.includes(o)?ne.value=ne.value.filter(d=>d!==o):ne.value.push(o)},expanded:ne,showConfirmRemove:W,selectedGene:q,confirmRemove:le,cancelRemove:se,removeGene:$,setSort:r,startAdd:T,startEdit:w,cancelForm:X,selectOther:ie,handleCuratedSelection:re,saveForm:ce,remove:H,updateTier:xe,applyBulkTier:ke,toggleSelect:we,toggleSelectAll:Ce,applyGtUpdate:Se}}},gt={class:"flex justify-between items-center mb-4"},xt={key:0,class:"flex items-center gap-2"},kt=["disabled"],wt={class:"flex items-center gap-4"},Ct=["value"],St=["value"],Tt={class:"flex items-center gap-2"},Dt=["value"],Gt={key:0,class:"border rounded bg-gray-50 p-4 mb-4"},At={class:"text-lg font-semibold mb-3"},Vt={key:0,class:"space-y-2"},Pt={key:0,class:"mt-3 border rounded bg-amber-50 p-3"},Et={class:"flex items-start gap-2 mb-2"},It={class:"text-sm text-gray-800"},Ut={key:0,class:"text-xs text-red-500 mt-1"},Lt={key:1,class:"border rounded bg-white p-3 mt-3"},Nt={class:"grid grid-cols-2 gap-2"},Ot={key:0,class:"text-red-500 text-xs mt-1"},Mt=["value"],Ft={key:0,class:"text-red-500 text-xs mt-1"},Bt={class:"col-span-2"},Rt={class:"col-span-2 mb-3"},qt={key:0,class:"text-red-500 text-xs mt-1"},jt={class:"mt-4 flex justify-end gap-2"},Kt=["disabled"],zt={key:0,class:"flex items-center gap-2 bg-gray-50 p-3 border rounded mb-3"},Ht=["disabled"],Yt={key:1,class:"border-none w-full"},Zt={key:0},Jt=["checked"],Qt={key:0},Wt={key:0},Xt={key:0},$t={key:0},eo={key:0},to={key:0},oo=["checked","onChange"],lo={class:"text-xs"},so={key:0,class:"grid grid-cols-2 gap-x-4 text-gray-600"},no={key:0,class:"font-bold text-orange-500"},ao={class:"col-span-2"},io={key:0,class:"col-span-2"},ro=["innerHTML"],uo=["innerHTML"],co={key:0,class:"flex flex-col gap-1"},po=["onUpdate:modelValue","onChange","disabled"],mo=["onClick"],vo={key:1},_o={key:0},yo=["colspan"],fo={role:"status","aria-live":"polite",class:"rounded-md border border-amber-300 bg-amber-50 px-3 py-2 text-xs text-amber-900 col-span-2"},bo={class:"flex items-start gap-2"},ho={class:"text-amber-900/80"},go=["onClick"],xo={key:1},ko=["onClick"],wo=["colspan"],Co={class:"grid grid-cols-2 gap-x-4 text-gray-600"},So={key:0,class:"font-bold text-orange-500"},To={class:"col-span-2"},Do=["onClick"],Go={class:"mt-4 flex justify-between items-center"},Ao=["disabled"],Vo=["disabled"],Po={key:2,class:"fixed inset-0 flex items-center justify-center bg-black bg-opacity-50 z-50"},Eo={class:"bg-white rounded-lg shadow-lg w-96 p-6"},Io={class:"mb-6"},Uo={class:"flex justify-end gap-2"};function Lo(v,t,f,l,p,h){var I;const G=L("CuratedGeneSearchSelect"),A=L("RichTextEditor"),b=L("GeneSearchSelect"),N=L("DiseaseSearchSelect"),S=L("dropdown-item"),k=L("dropdown-menu");return a(),i("div",null,[e("div",gt,[f.editing?(a(),i("div",xt,[e("button",{class:"btn blue",onClick:t[0]||(t[0]=(...s)=>l.startAdd&&l.startAdd(...s)),disabled:l.isFormVisible}," + Add Gene ",8,kt)])):_("",!0),e("div",wt,[j(e("input",{"onUpdate:modelValue":t[1]||(t[1]=s=>l.search=s),type:"text",placeholder:"Search genes, diseases, MOI, notes...",class:"border rounded px-2 py-1 text-sm"},null,512),[[be,l.search]]),j(e("select",{"onUpdate:modelValue":t[2]||(t[2]=s=>l.filterMoi=s),class:"border p-1 rounded text-sm"},[t[25]||(t[25]=e("option",{value:""},"All MOIs",-1)),(a(!0),i(F,null,Y(l.moiOptions,s=>(a(),i("option",{key:s,value:s},u(s),9,Ct))),128))],512),[[Q,l.filterMoi]]),j(e("select",{"onUpdate:modelValue":t[3]||(t[3]=s=>l.filterClassification=s),class:"border p-1 rounded text-sm"},[t[26]||(t[26]=e("option",{value:""},"All Classifications",-1)),(a(!0),i(F,null,Y(l.classificationOptions,s=>(a(),i("option",{key:s,value:s},u(s),9,St))),128))],512),[[Q,l.filterClassification]]),e("div",Tt,[t[27]||(t[27]=e("label",{class:"text-sm"},"Page size:",-1)),j(e("select",{"onUpdate:modelValue":t[4]||(t[4]=s=>l.pageSize=s),class:"border px-2 py-1 rounded text-sm"},[(a(),i(F,null,Y([20,50,100],s=>e("option",{key:s,value:s},u(s),9,Dt)),64))],512),[[Q,l.pageSize]])])])]),M(Ne,{name:"fade"},{default:B(()=>{var s,P,K,R,O;return[l.isFormVisible?(a(),i("div",Gt,[e("h3",At,u(l.isEditing?"Edit Gene":"Add Gene"),1),(s=l.formGene)!=null&&s.is_other?_("",!0):(a(),i("div",Vt,[t[33]||(t[33]=e("label",{class:"block font-semibold"},"Select Gene-Disease-MOI:",-1)),(a(),te(G,{modelValue:l.formGene,"onUpdate:modelValue":[t[5]||(t[5]=g=>l.formGene=g),l.handleCuratedSelection],placeholder:"Search curated Gene-Disease-MOI",class:"w-full",key:l.curatedGeneKey},null,8,["modelValue","onUpdate:modelValue"])),e("button",{type:"button",class:"text-blue-600 underline text-sm hover:text-blue-800",onClick:t[6]||(t[6]=(...g)=>l.selectOther&&l.selectOther(...g))},t[28]||(t[28]=[y(" Click here for "),e("strong",null,"Other (Not Curated)",-1)])),(P=l.formGene)!=null&&P.requires_plan?(a(),i("div",Pt,[e("div",Et,[t[31]||(t[31]=e("span",{class:"text-orange-500 font-bold"},"⚠",-1)),e("div",It,[t[29]||(t[29]=y(" This gene’s classification is ")),e("strong",null,u((K=l.formGene.plan)==null?void 0:K.classification),1),t[30]||(t[30]=y(". Please describe your plan for curation. "))])]),t[32]||(t[32]=e("label",{class:"block text-sm font-medium mb-1"},"Plan for Curation *",-1)),M(A,{modelValue:l.formGene.curated_plan_text,"onUpdate:modelValue":t[7]||(t[7]=g=>l.formGene.curated_plan_text=g),placeholder:"Describe your plan (min 20 characters)",class:"w-full"},null,8,["modelValue"]),l.isCuratedPlanValid?_("",!0):(a(),i("p",Ut," Plan must be at least 20 characters. "))])):_("",!0)])),l.formGene&&l.formGene.is_other?(a(),i("div",Lt,[t[39]||(t[39]=e("h5",{class:"text-lg font-semibold mb-2"},"Provide details for non-curated gene",-1)),e("div",Nt,[e("div",null,[t[34]||(t[34]=e("label",{class:"block text-sm font-medium mb-1"},"Gene *",-1)),M(b,{modelValue:l.formGene.custom_gene,"onUpdate:modelValue":t[8]||(t[8]=g=>l.formGene.custom_gene=g),placeholder:"Search gene..."},null,8,["modelValue"]),l.errors.custom_gene?(a(),i("p",Ot,u(l.errors.custom_gene[0]),1)):_("",!0)]),e("div",null,[t[36]||(t[36]=e("label",{class:"block text-sm font-medium mb-1"},"MOI",-1)),j(e("select",{"onUpdate:modelValue":t[9]||(t[9]=g=>l.formGene.custom_moi=g),class:"form-select w-full"},[t[35]||(t[35]=e("option",{value:""},"----Select MOI-----",-1)),(a(!0),i(F,null,Y(l.mois,g=>(a(),i("option",{key:g.id,value:g},u(g.name)+" ("+u(g.abbreviation)+")",9,Mt))),128))],512),[[Q,l.formGene.custom_moi]]),l.errors.custom_moi?(a(),i("p",Ft,u(l.errors.custom_moi[0]),1)):_("",!0)]),e("div",Bt,[t[37]||(t[37]=e("label",{class:"block text-sm font-medium mb-1"},"Disease *",-1)),M(N,{modelValue:l.formGene.custom_disease,"onUpdate:modelValue":t[10]||(t[10]=g=>l.formGene.custom_disease=g),placeholder:"Search disease..."},null,8,["modelValue"])]),e("div",Rt,[t[38]||(t[38]=e("label",{class:"block text-sm font-medium mb-1"},"Plan for Curation *",-1)),M(A,{modelValue:l.formGene.custom_plan,"onUpdate:modelValue":t[11]||(t[11]=g=>l.formGene.custom_plan=g),placeholder:"Describe your plan (min 20 characters)",class:"w-full"},null,8,["modelValue"]),l.errors.custom_plan?(a(),i("p",qt,u(l.errors.custom_plan[0]),1)):_("",!0)])])])):_("",!0),e("div",jt,[e("button",{class:"btn btn-gray",onClick:t[12]||(t[12]=(...g)=>l.cancelForm&&l.cancelForm(...g))},"Cancel"),e("button",{class:"btn blue",disabled:l.isEditing?!1:((R=l.formGene)==null?void 0:R.is_other)&&!l.isOtherFormValid||!((O=l.formGene)!=null&&O.is_other)&&!l.isCuratedPlanValid,onClick:t[13]||(t[13]=(...g)=>l.saveForm&&l.saveForm(...g))}," Save ",8,Kt)])])):_("",!0)]}),_:1}),l.selectedGenes.length>0&&!f.readonly?(a(),i("div",zt,[t[41]||(t[41]=e("span",{class:"font-semibold"},"Bulk Tier Update:",-1)),j(e("select",{"onUpdate:modelValue":t[14]||(t[14]=s=>l.bulkTier=s),class:"border rounded px-2 py-1 text-sm"},t[40]||(t[40]=[pe('<option value="" data-v-87412ce2>Select Tier</option><option value="1" data-v-87412ce2>Tier 1</option><option value="2" data-v-87412ce2>Tier 2</option><option value="3" data-v-87412ce2>Tier 3</option><option value="4" data-v-87412ce2>Tier 4</option>',5)]),512),[[Q,l.bulkTier]]),e("button",{class:"bg-blue-600 text-white px-3 py-1 rounded disabled:opacity-50",onClick:t[15]||(t[15]=(...s)=>l.applyBulkTier&&l.applyBulkTier(...s)),disabled:!l.bulkTier||l.selectedGenes.length===0}," Apply ",8,Ht)])):_("",!0),l.genes?(a(),i("table",Yt,[e("thead",null,[e("tr",null,[l.canEdit&&f.editing?(a(),i("th",Zt,[e("input",{type:"checkbox",checked:l.isAllSelected,onChange:t[16]||(t[16]=(...s)=>l.toggleSelectAll&&l.toggleSelectAll(...s))},null,40,Jt)])):_("",!0),e("th",{onClick:t[17]||(t[17]=s=>l.setSort("gene_symbol")),class:"cursor-pointer"},[t[42]||(t[42]=y(" HGNC Symbol ")),l.sortKey==="gene_symbol"?(a(),i("span",Qt,u(l.sortOrder==="asc"?"▲":"▼"),1)):_("",!0)]),e("th",{onClick:t[18]||(t[18]=s=>l.setSort("disease")),class:"cursor-pointer"},[t[43]||(t[43]=y(" Disease ")),l.sortKey==="disease"?(a(),i("span",Wt,u(l.sortOrder==="asc"?"▲":"▼"),1)):_("",!0)]),e("th",{onClick:t[19]||(t[19]=s=>l.setSort("moi")),class:"cursor-pointer"},[t[44]||(t[44]=y(" MOI ")),l.sortKey==="moi"?(a(),i("span",Xt,u(l.sortOrder==="asc"?"▲":"▼"),1)):_("",!0)]),t[46]||(t[46]=e("th",null,"Plan",-1)),e("th",{onClick:t[20]||(t[20]=s=>l.setSort("tier")),class:"cursor-pointer"},[t[45]||(t[45]=y(" Tier ")),l.sortKey==="tier"?(a(),i("span",$t,u(l.sortOrder==="asc"?"▲":"▼"),1)):_("",!0)])])]),l.paginatedGenes.length===0?(a(),i("tbody",eo,t[47]||(t[47]=[e("tr",null,[e("td",{colspan:"6",class:"p-3 text-center"},"No genes found.")],-1)]))):_("",!0),e("tbody",null,[(a(!0),i(F,null,Y(l.paginatedGenes,(s,P)=>{var K,R,O,g,z,V,oe,W,q,le,se,$,m,n,r,T,w,X,Z,ie,re,de,ue,ce;return a(),i(F,{key:s.id},[e("tr",{style:Oe(((K=s.plan)==null?void 0:K.classification)==="Moderate"?"background-color: oklch(98.7% 0.026 102.212);":((R=s.plan)==null?void 0:R.classification)==="Limited"||s.is_outdated?"background-color: oklch(97.3% 0.071 103.193);":"")},[l.canEdit&f.editing?(a(),i("td",to,[e("input",{type:"checkbox",checked:l.selectedGenes.includes(s.id),onChange:H=>l.toggleSelect(s.id)},null,40,oo)])):_("",!0),e("td",null,u(s.gene_symbol),1),e("td",null,[y(u(s.mondo_id),1),t[48]||(t[48]=e("br",null,null,-1)),y(u(s.disease_name),1)]),e("td",null,u(s.moi),1),e("td",lo,[(O=s.plan)!=null&&O.is_other?(a(),i("div",{key:1,innerHTML:(m=s.plan)==null?void 0:m.the_plan},null,8,uo)):(a(),i("div",so,[e("div",null,[t[49]||(t[49]=e("strong",null,"Expert Panel:",-1)),y(" "+u(((g=s.plan)==null?void 0:g.expert_panel)??"N/A"),1)]),e("div",null,[t[50]||(t[50]=e("strong",null,"Classification:",-1)),y(" "+u(((z=s.plan)==null?void 0:z.classification)??"N/A")+" ",1),["Moderate","Limited"].includes((V=s.plan)==null?void 0:V.classification)?(a(),i("span",no,"⚠")):_("",!0)]),e("div",null,[t[51]||(t[51]=e("strong",null,"Status:",-1)),y(" "+u(((oe=s.plan)==null?void 0:oe.curation_status)??"N/A"),1)]),e("div",null,[t[52]||(t[52]=e("strong",null,"Date Approved:",-1)),y(" "+u((W=s.plan)!=null&&W.date_approved?new Date((q=s.plan)==null?void 0:q.date_approved).toLocaleDateString():"N/A"),1)]),e("div",ao,[t[53]||(t[53]=e("strong",null,"Phenotypes:",-1)),y(" "+u(((le=s.plan)==null?void 0:le.phenotypes)??"N/A"),1)]),(se=s.plan)!=null&&se.requires_plan?(a(),i("div",io,[t[54]||(t[54]=e("strong",null,"Plan:",-1)),t[55]||(t[55]=y()),e("span",{innerHTML:($=s.plan)==null?void 0:$.curated_plan_text},null,8,ro)])):_("",!0)]))]),e("td",null,[f.editing?(a(),i("div",co,[j(e("select",{"onUpdate:modelValue":H=>s.tier=H,class:"border rounded px-1 py-0.5 text-sm",onChange:H=>l.updateTier(s),disabled:l.savingTierFor===s.id||f.readonly},t[56]||(t[56]=[pe('<option value="null" data-v-87412ce2>—</option><option value="1" data-v-87412ce2>Tier 1</option><option value="2" data-v-87412ce2>Tier 2</option><option value="3" data-v-87412ce2>Tier 3</option><option value="4" data-v-87412ce2>Tier 4</option>',5)]),40,po),[[Q,s.tier]]),s.is_outdated&&s.gt_data?(a(),i("button",{key:0,onClick:H=>l.applyGtUpdate(s),class:"btn btn-xs w-full text-center text-amber-800 font-semibold",title:"Snapshot differs from latest GeneTracker data"}," Refresh data from GT ⚠ ",8,mo)):_("",!0),s.toDelete?_("",!0):(a(),te(k,{key:1,"hide-cheveron":!0,class:"relative"},{label:B(()=>t[57]||(t[57]=[e("button",{class:"btn btn-xs w-full text-center"},"⋯",-1)])),default:B(()=>[M(S,{onClick:H=>l.startEdit(s)},{default:B(()=>t[58]||(t[58]=[y("Edit")])),_:2},1032,["onClick"]),M(S,{onClick:H=>l.confirmRemove(s)},{default:B(()=>t[59]||(t[59]=[y("Remove")])),_:2},1032,["onClick"])]),_:2},1024))])):(a(),i("span",vo,u(s.tier||"—"),1))])],4),s.is_outdated&&s.gt_data?(a(),i("tr",_o,[e("td",{colspan:f.editing?6:5},[e("div",fo,[e("div",bo,[t[62]||(t[62]=y(" ⚠ ")),e("div",null,[t[61]||(t[61]=e("div",{class:"font-medium"},"Snapshot out of date",-1)),e("div",ho,[t[60]||(t[60]=y("This record differs from the latest GeneTracker data. ")),e("span",{onClick:H=>s.is_outdated&&l.toggleExpanded(P),class:"underline cursor-pointer font-semibold"},u(l.expanded.includes(P)?"Hide":"View")+" GeneTracker data ",9,go)])])])])],8,yo)])):_("",!0),s.is_outdated&&s.gt_data&&l.expanded.includes(P)?(a(),i("tr",xo,[f.editing?(a(),i("td",{key:0,onClick:H=>l.toggleExpanded(P)},t[63]||(t[63]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",width:"18",height:"18",viewBox:"0 0 20 20","aria-labelledby":"box",role:"presentation",name:"cheveron-down",class:"m-auto cursor-pointer"},[e("title",{id:"box",lang:"en"},"box"),e("g",{fill:"currentColor"},[e("path",{d:"M9.293 12.95l.707.707L15.657 8l-1.414-1.414L10 10.828 5.757 6.586 4.343 8z"})])],-1)]),8,ko)):_("",!0),e("td",null,u((n=s.gt_data)==null?void 0:n.gene_symbol),1),e("td",null,[y(u((r=s.gt_data)==null?void 0:r.mondo_id),1),t[64]||(t[64]=e("br",null,null,-1)),y(u((T=s.gt_data)==null?void 0:T.disease_name),1)]),e("td",null,u((w=s.gt_data)==null?void 0:w.moi),1),e("td",{class:"text-xs",colspan:f.editing?2:1},[e("div",Co,[e("div",null,[t[65]||(t[65]=e("strong",null,"Expert Panel:",-1)),y(" "+u(((X=s.gt_data)==null?void 0:X.expert_panel)??"N/A"),1)]),e("div",null,[t[66]||(t[66]=e("strong",null,"Classification:",-1)),y(" "+u(((Z=s.gt_data)==null?void 0:Z.classification)??"N/A")+" ",1),["Moderate","Limited"].includes((ie=s.gt_data)==null?void 0:ie.classification)?(a(),i("span",So,"⚠")):_("",!0)]),e("div",null,[t[67]||(t[67]=e("strong",null,"Status:",-1)),y(" "+u(((re=s.gt_data)==null?void 0:re.curation_status)??"N/A"),1)]),e("div",null,[t[68]||(t[68]=e("strong",null,"Date Approved:",-1)),y(" "+u((de=s.gt_data)!=null&&de.date_approved?new Date((ue=s.gt_data)==null?void 0:ue.date_approved).toLocaleDateString():"N/A"),1)]),e("div",To,[t[69]||(t[69]=e("strong",null,"Phenotypes:",-1)),y(" "+u(((ce=s.gt_data)==null?void 0:ce.phenotypes)??"N/A"),1)])])],8,wo),f.editing?_("",!0):(a(),i("td",{key:1,onClick:H=>l.toggleExpanded(P)}," Hide ",8,Do))])):_("",!0)],64)}),128))])])):_("",!0),e("div",Go,[e("button",{class:"btn btn-gray",disabled:l.currentPage===1,onClick:t[21]||(t[21]=s=>l.currentPage--)},"Prev",8,Ao),e("span",null,"Page "+u(l.currentPage)+" of "+u(l.totalPages),1),e("button",{class:"btn btn-gray",disabled:l.currentPage===l.totalPages,onClick:t[22]||(t[22]=s=>l.currentPage++)},"Next",8,Vo)]),l.showConfirmRemove?(a(),i("div",Po,[e("div",Eo,[t[72]||(t[72]=e("h3",{class:"text-lg font-semibold mb-4"},"Confirm Removal",-1)),e("p",Io,[t[70]||(t[70]=y("Are you sure you want to remove ")),e("strong",null,u((I=l.selectedGene)==null?void 0:I.gene_symbol),1),t[71]||(t[71]=y("?"))]),e("div",Uo,[e("button",{class:"btn btn-gray",onClick:t[23]||(t[23]=(...s)=>l.cancelRemove&&l.cancelRemove(...s))},"Cancel"),e("button",{class:"btn btn-red",onClick:t[24]||(t[24]=(...s)=>l.removeGene&&l.removeGene(...s))},"Remove")])])])):_("",!0)])}const rl=me(ht,[["render",Lo],["__scopeId","data-v-87412ce2"]]),No={name:"CspecSummary",props:{readonly:{type:Boolean,default:!1}},data(){return{sort:{field:"id",desc:!1},specFields:[{name:"name",type:String,sortable:!0},{name:"status",label:"Status",type:String,sortable:!0},{name:"updated_at",label:"Last Updated",type:Date,sortable:!0}]}},computed:{group(){return this.$store.getters["groups/currentItemOrNew"]},hasSpecifications(){return this.group.expert_panel.specifications&&this.group.expert_panel.specifications.length>0},specifications(){return this.group.expert_panel.specifications}},watch:{group(v){this.$store.dispatch("groups/getSpecifications",v)}},mounted(){this.$store.dispatch("groups/getSpecifications",this.group)},methods:{goToCspec(){window.location="https://cspec.genome.network/"}}},Oo={key:0,class:"well mb-2"},Mo={key:1},Fo={class:"mb-2"},Bo=["href"],Ro=["disabled"];function qo(v,t,f,l,p,h){const G=L("icon-arrow-right"),A=L("note");return a(),i("div",null,[h.hasSpecifications?(a(),i("div",Mo,[e("table",Fo,[t[0]||(t[0]=e("thead",null,[e("tr",null,[e("th",null,"Specification Name"),e("th",null,"Status"),e("th",null,"Last Updated"),e("th",null," ")])],-1)),e("tbody",null,[(a(!0),i(F,null,Y(h.specifications,b=>(a(),i("tr",{key:b.id},[e("td",null,u(b.name),1),e("td",null,u(b.status),1),e("td",null,u(v.formatDate(b.updated_at)),1),e("td",null,[e("ul",null,[e("li",null,[e("a",{target:"cspec_edit",href:`https://cspec.genome.network/cspec/ed/svi/doc/${b.cspec_id}`},"Edit",8,Bo)])])])]))),128))])])])):(a(),i("div",Oo," No specifications on record in the CSPEC Registry. ")),e("a",{class:"btn btn-lg blue",target:"cspec-editor",disabled:f.readonly,href:"https://cspec.genome.network/"},[t[1]||(t[1]=y(" Go to the CSpec Registry ")),M(G,{class:"inline"})],8,Ro),M(A,{class:"mt-2"},{default:B(()=>t[2]||(t[2]=[y(" It may take up to an hour for the latest updates in the CSPEC Registry to display here. ")])),_:1})])}const jo=me(No,[["render",qo]]),Ko=Fe.documentsTypes,zo={props:{documentTypeId:{type:[Number,Array],required:!0},step:{type:Number,required:!1,default:null},showNotes:{type:Boolean,default:!0},readonly:{type:Boolean,default:!1}},emits:["saved","canceled"],data(){return{newDocument:{file:null,date_received:new Date().toISOString(),step:this.step},errors:{},activeDocument:{},showDeleteConfirmation:!1}},computed:{group(){return this.$store.getters["groups/currentItemOrNew"]},documents(){return this.group.documents.filter(v=>this.docTypeIsArray?this.documentTypeId.includes(v.document_type_id):v.document_type_id===this.documentTypeId)},docTypeIsArray(){return Array.isArray(this.documentTypeId)},filteredTypes(){return this.docTypeIsArray?Object.values(Ko).filter(v=>this.documentTypeId.includes(v.id)).map(v=>({label:v.long_name,value:v.id})):[]},document_type_id(){return this.docTypeIsArray?null:this.documentTypeId}},mounted(){this.$store.dispatch("groups/getDocuments",this.group)},methods:{async save(){try{const v=new FormData;Object.entries(this.newDocument).forEach(([t,f])=>{f!=null&&v.append(t,f)}),v.set("file",this.$refs.fileInput.files[0]),v.set("document_type_id",this.documentTypeId),await this.$store.dispatch("groups/addApplicationDocument",{group:this.group,data:v}),this.clearForm(),this.$emit("saved")}catch(v){ge(v)&&(this.errors=v.response.data.errors)}},cancel(){this.clearForm(),this.$emit("canceled")},clearForm(){this.initNewDocument(),this.clearErrors()},initNewDocument(){this.$refs.fileInput.value=null,this.newDocument={file:null,date_received:Me(new Date),date_reviewed:null,step:this.step,document_type_id:this.documentTypeId,notes:null}},clearErrors(){this.errors={}},initDownload(v){window.location=v.download_url},initDelete(v){this.activeDocument=v,this.showDeleteConfirmation=!0},cancelDelete(){this.showDeleteConfirmation=!1,this.resetActiveDocument()},async commitDelete(){await this.$store.dispatch("groups/deleteDocument",{group:this.group,document:this.activeDocument}),this.showDeleteConfirmation=!1,this.resetActiveDocument()},resetActiveDocument(){this.activeDocument={type:{}}}}},Ho={key:0,class:"table"},Yo={key:0},Zo=["href"],Jo={class:"note"},Qo={key:0},Wo={key:1},Xo={ref:"fileInput",type:"file"},$o={key:0},el={key:0,class:"mb-3"};function tl(v,t,f,l,p,h){const G=L("dropdown-item"),A=L("dropdown-menu"),b=L("input-row"),N=L("button-row"),S=L("modal-dialog");return a(),i("div",null,[h.documents.length>0?(a(),i("table",Ho,[e("thead",null,[e("tr",null,[t[3]||(t[3]=e("th",null,"File",-1)),h.docTypeIsArray?(a(),i("th",Yo," Type ")):_("",!0),t[4]||(t[4]=e("th",null,"uploaded",-1)),t[5]||(t[5]=e("th",null,null,-1))])]),e("tbody",null,[(a(!0),i(F,null,Y(h.documents,k=>(a(),i("tr",{key:k.id,class:"p-1 border"},[e("td",null,[e("a",{href:k.download_url},u(k.filename),9,Zo),e("span",Jo," (v. "+u(k.version)+")",1)]),h.docTypeIsArray?(a(),i("td",Qo,u(k.type.long_name),1)):_("",!0),e("td",null,u(v.formatDate(k.created_at)),1),e("td",null,[M(A,{"hide-cheveron":""},{label:B(()=>t[6]||(t[6]=[e("button",{class:"btn btn-xs"}," … ",-1)])),default:B(()=>[M(G,{onClick:I=>h.initDownload(k)},{default:B(()=>t[7]||(t[7]=[y(" Download ")])),_:2},1032,["onClick"]),v.hasAnyPermission(["ep-applications-manage",["application-edit",h.group]])?(a(),te(G,{key:0,onClick:I=>h.initDelete(k)},{default:B(()=>t[8]||(t[8]=[y(" Delete ")])),_:2},1032,["onClick"])):_("",!0)]),_:2},1024)])]))),128))])])):_("",!0),f.readonly?_("",!0):(a(),i("div",Wo,[h.docTypeIsArray?(a(),te(b,{key:0,modelValue:p.newDocument.document_type_id,"onUpdate:modelValue":t[0]||(t[0]=k=>p.newDocument.document_type_id=k),label:"Document type",type:"select",options:h.filteredTypes},null,8,["modelValue","options"])):_("",!0),M(b,{label:"Document",errors:p.errors.file},{default:B(()=>[e("input",Xo,null,512)]),_:1},8,["errors"]),e("button",{class:"btn blue",onClick:t[1]||(t[1]=(...k)=>h.save&&h.save(...k))}," Upload ")])),(a(),te(Be,{to:"body"},[M(S,{modelValue:p.showDeleteConfirmation,"onUpdate:modelValue":t[2]||(t[2]=k=>p.showDeleteConfirmation=k),title:`You are about to delete ${p.activeDocument.filename}`},{default:B(()=>[p.activeDocument?(a(),i("div",$o,[p.activeDocument.is_final?(a(),i("p",el," This version has been tagged as the final version of the document. ")):_("",!0),t[9]||(t[9]=e("p",null,"Are you sure you want to continue?",-1)),M(N,{"submit-text":"Delete Document",onCanceled:h.cancelDelete,onSubmitted:h.commitDelete},null,8,["onCanceled","onSubmitted"])])):_("",!0)]),_:1},8,["modelValue","title"])]))])}const ol=me(zo,[["render",tl]]),ll={name:"SpecificationsSection",components:{CspecSummary:jo,ApplicationUploadForm:ol},props:{docTypeId:{required:!0,type:[Number,Array]},readonly:{type:Boolean,default:!1}},data(){return{}},computed:{cspecSummaryEnabled(){return this.$store.state.systemInfo.app.features.cspec_summary},specificationUpload(){return this.$store.state.systemInfo.app.features.specification_upload}},methods:{}};function sl(v,t,f,l,p,h){const G=L("CspecSummary"),A=L("ApplicationUploadForm"),b=L("collapsible");return a(),i("div",null,[h.cspecSummaryEnabled?(a(),te(G,{key:0,readonly:f.readonly},null,8,["readonly"])):_("",!0),M(b,{class:"mt-4"},{title:B(()=>t[0]||(t[0]=[e("h3",null,"Legacy document-based specifications",-1)])),default:B(()=>[h.specificationUpload?(a(),te(A,{key:0,"document-type-id":f.docTypeId,"show-notes":!1,readonly:f.readonly},null,8,["document-type-id","readonly"])):_("",!0)]),_:1})])}const dl=me(ll,[["render",sl]]);export{dl as S,rl as V,il as _};
//# sourceMappingURL=SpecificationsSection-DbcKYiXX.js.map
