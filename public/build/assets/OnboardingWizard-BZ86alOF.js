import{_ as y,c,b as l,d as r,i as w,j as g,h as S,p as C,as as A,at as $,r as p,x,a as h,C as D,f as m,D as U,a2 as _,au as X,v as O,o as B,w as k,E as j,e as b,ah as q,a0 as N,av as P,P as T}from"./app-DNJR23u9.js";const W={name:"OnboardingSteps",props:{invite:{type:Object,required:!0}},emits:["ok"],data(){return{}},computed:{},methods:{}},z={class:"text-lg text-center font-bold"},L={key:0},M={key:1},R={class:"list-decimal pl-8"},G={key:0};function Y(n,e,s,t,o,i){return l(),c("div",null,[r("p",z,[w(" Hi "+g(s.invite.first_name)+". ",1),e[1]||(e[1]=r("br",null,null,-1)),e[2]||(e[2]=w(" You've been invited to join ClinGen ")),s.invite.inviter?(l(),c("span",L," as part of the "+g(s.invite.inviter.name)+" "+g(s.invite.inviter.type.name.toUpperCase())+". ",1)):(l(),c("span",M,"."))]),e[6]||(e[6]=r("p",null,"There are just a few steps to get you set up:",-1)),r("ol",R,[e[3]||(e[3]=r("li",null,"Create an account.",-1)),e[4]||(e[4]=r("li",null,"Fill out your profile.",-1)),e[5]||(e[5]=r("li",null,"Share some demographic information.",-1)),s.invite.inviter?(l(),c("li",G," Complete a Conflict of Interest Survey. ")):S("",!0)]),r("p",null,[r("button",{class:"btn btn-lg blue w-full mt-4",onClick:e[0]||(e[0]=d=>n.$emit("ok"))}," Get Started ")])])}const V=y(W,[["render",Y]]),H=async n=>await C.get(`/api/people/invites/${n}`).then(e=>e.data.data),K=async(n,e,s,t)=>C.put(`/api/people/invites/${n.code}`,{email:e,password:s,password_confirmation:t}),J=async n=>C.put(`/api/people/existing-user/invites/${n.code}`),Q={name:"InviteRedemptionCode",components:{InputErrors:A},props:{code:{required:!1},invite:{type:Object,required:!1,default:()=>({})}},emits:["codeverified"],setup(n,e){const{invite:s}=$(n),t=p(null),o=p([]),i=()=>{t.value=n.invite.code};return x(s,()=>{i()},{deep:!0}),x(t,()=>{o.value=[]}),{inviteCode:t,errors:o,checkInvite:async()=>{try{const a=await H(t.value);e.emit("codeverified",a)}catch(a){if(Number.parseInt(a.response.status)===404){o.value=["The code you entered is not valid"];return}_(a)&&(o.value=a.response.data.errors.code)}},syncCode:i}},data(){return{}},computed:{},mounted(){this.syncCode()},beforeMount(){this.$store.getters.currentUser.id!==null&&(this.$store.commit("pushError","You can't redeem an invite b/c you're already logged in."),this.$router.replace({name:"Dashboard"}))},methods:{}},Z={class:"w-64 mx-auto"};function ee(n,e,s,t,o,i){const d=h("InputErrors");return l(),c("div",Z,[e[2]||(e[2]=r("label",{for:"invite-code-input",class:"text-lg block"}," Enter your registration code: ",-1)),D(r("input",{id:"invite-code-input","onUpdate:modelValue":e[0]||(e[0]=a=>t.inviteCode=a),type:"text",placeholder:"XXXXXXXXXX",class:"w-full"},null,512),[[U,t.inviteCode]]),m(d,{errors:t.errors},null,8,["errors"]),r("button",{class:"btn blue btn-lg block mt-2 w-full",onClick:e[1]||(e[1]=(...a)=>t.checkInvite&&t.checkInvite(...a))}," Submit ")])}const F=y(Q,[["render",ee]]),te={name:"AccountCreationForm",components:{LoginForm:X},props:{invite:{type:Object,required:!0}},emits:["saved"],setup(n,e){const s=O(),t=p({}),o=p(null),i=p(null),d=p(null),a=async()=>{try{await K(n.invite,o.value,i.value,d.value),await s.dispatch("login",{email:o.value,password:i.value}),e.emit("saved")}catch(f){_(f)&&(t.value=f.response.data.errors)}},v=async()=>{try{await J(n.invite),e.emit("saved")}catch(f){_(f)&&(t.value=f.response.data)}},u=()=>{o.value=n.invite.person.email};return B(()=>u()),{errors:t,email:o,password:i,password_confirmation:d,createAccount:a,redeemForExistingUser:v}}},ne={key:0},re={key:1},oe={class:"flex flex-row-reverse"};function ie(n,e,s,t,o,i){const d=h("static-alert"),a=h("LoginForm"),v=h("input-row");return l(),c("div",null,[e[6]||(e[6]=r("pre",null,null,-1)),s.invite.person.user_id?(l(),c("div",ne,[m(d,null,{default:k(()=>e[4]||(e[4]=[w(" It looks like you've already activated you account. Please login to continue. ")])),_:1}),m(a,{onAuthenticated:t.redeemForExistingUser},null,8,["onAuthenticated"])])):(l(),c("div",re,[e[5]||(e[5]=r("p",{class:"text-lg"}," Create your account ",-1)),m(v,{modelValue:t.email,"onUpdate:modelValue":e[0]||(e[0]=u=>t.email=u),label:"Email",errors:t.errors.email,"label-width-class":"w-24"},null,8,["modelValue","errors"]),m(v,{modelValue:t.password,"onUpdate:modelValue":e[1]||(e[1]=u=>t.password=u),label:"Password",type:"password",errors:t.errors.password,"label-width-class":"w-24"},null,8,["modelValue","errors"]),m(v,{modelValue:t.password_confirmation,"onUpdate:modelValue":e[2]||(e[2]=u=>t.password_confirmation=u),label:"Confirm Password",type:"password",errors:t.errors.password,"label-width-class":"w-24"},null,8,["modelValue","errors"]),r("div",oe,[r("button",{class:"btn blue",onClick:e[3]||(e[3]=(...u)=>t.createAccount&&t.createAccount(...u))}," Next ")])]))])}const E=y(te,[["render",ie]]),I=[F,V,E],se=["20rem","20rem","20rem","40rem","40rem"],ae={name:"OverviewWizard",components:{InviteRedemptionForm:F,OnboardingSteps:V,AccountCreationForm:E},props:{code:{required:!1}},data(){return{animationDirection:"forward",currentStepIdx:0,invite:{person:new T({})}}},computed:{currentStepComponent(){return I[this.currentStepIdx]},currentStepWidth(){return se[this.currentStepIdx]},canContinue(){return!this.$store.getters.isAuthed||this.$store.getters.isAuthed&&!this.$store.getters.currentUser.person.timezone}},watch:{code:{immediate:!0,handler(n){this.invite.code=n}}},methods:{handleCodeVerified(n){this.invite=n,this.goForward()},goBack(){this.animationDirection="fade",this.currentStepIdx!==0&&(this.currentStepIdx-=1)},goForward(){if(this.animationDirection="fade",this.currentStepIdx===I.length-1){this.$router.push({name:"Dashboard"});return}this.currentStepIdx+=1},selectStep(){if(!this.invite.id){this.currentStepIdx=0,this.$route.query.code&&(this.invite.code=this.$route.query.code);return}this.invite.id&&this.$store.state.user.id&&(this.currentStepIndex=3)}}},le={class:"flex justify-center"};function de(n,e,s,t,o,i){const d=h("router-link");return l(),c("div",null,[r("div",le,[r("div",{class:"onboarding-container",style:j(`width: ${i.currentStepWidth}`)},[(l(),b(P,null,[m(N,{name:o.animationDirection,mode:"out-in"},{default:k(()=>[(l(),b(q(i.currentStepComponent),{invite:o.invite,person:o.invite.person,code:o.invite.coi_code,onCodeverified:i.handleCodeVerified,onOk:i.goForward,onSaved:i.goForward,onBack:i.goBack},null,40,["invite","person","code","onCodeverified","onOk","onSaved","onBack"]))]),_:1},8,["name"])],1024))],4),r("p",null,[n.$store.getters.isAuthed?S("",!0):(l(),b(d,{key:0,class:"block link pt-2",to:{name:"login"}},{default:k(()=>e[0]||(e[0]=[w(" < Log In ")])),_:1}))])])])}const ce=y(ae,[["render",de],["__scopeId","data-v-c8192d2d"]]);export{ce as default};
//# sourceMappingURL=OnboardingWizard-BZ86alOF.js.map
