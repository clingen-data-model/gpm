import{_ as W,aN as E,c as u,d as y,f as m,i as b,h as g,w as d,F as w,m as F,a as p,q as v,r as P,v as B,u as U,ab as j,b as o,e as k,C as x,D as M,a9 as R,j as G}from"./app-BQ9Yh0Tx.js";import{G as q}from"./GroupForm-jweXmV_S.js";const z={name:"ComponentName",components:{GroupForm:q,SubmissionWrapper:E},props:{},setup(){const a=B(),e=U(),f=v(()=>[{label:"VCEPs",typeId:4,filter:s=>s.is_vcep_or_scvcep},{label:"GCEPs",typeId:3,filter:s=>s.is_gcep},{label:"CDWGs",typeId:2,filter:s=>s.isCdwg()},{label:"WGs",typeId:1,filter:s=>s.isWg()}]),i=P(null),n=v(()=>a.getters["groups/all"]),c=v(()=>n.value.filter(t=>{if(!i.value)return!0;const s=new RegExp(`.*${i.value}.*`,"i");return t.name&&t.name.match(s)||t.displayName&&t.displayName.match(s)||t.expert_panel&&t.expert_panel.full_short_base_name&&t.expert_panel.full_short_base_name.match(s)||Number.parseInt(t.id)===Number.parseInt(i.value)||t.status.name.match(s)||t.expert_panel&&t.expert_panel.currentStepName&&t.expert_panel.currentStepName.match(s)||t.coordinators.filter(C=>C.person.name.match(s)).length>0})),_=t=>{e.push({name:"GroupDetail",params:{uuid:t.uuid}})};return{filterString:i,groups:n,filteredGroups:c,tabDefinitions:f,goToItem:_,goToGroup:_}},data(){return{loading:!1,showCreateForm:!1,loadedFor:{VCEPs:!1,GCEPs:!1,CDWGs:!1,WGs:!1},sort:{field:"id",desc:!1},fields:[{name:"id",label:"ID",sortable:!0},{name:"name",label:"Name",sortable:!0,resolveValue:a=>a.displayName},{name:"coordinators",sortable:!1},{name:"displayStatus",sortable:!0,label:"status"}]}},methods:{startCreateGroup(){this.showCreateForm=!0},async getGroupsForType(a){const e=this.tabDefinitions.find(f=>f.label===a);this.loadedFor[a]||(this.loading=!0,await this.$store.dispatch("groups/getItems",{where:{group_type_id:e.typeId}}),this.loadedFor[a]=!0,this.loading=!1)}}},A={class:"flex justify-between items-center"},L={key:0,class:"text-center w-full"},H={key:1},J={class:"mb-2"},K={key:0},O={key:0},Q={key:0};function X(a,e,f,i,n,c){const _=p("badge"),t=p("router-link"),s=p("data-table"),C=p("tab-item"),S=p("tabs-container"),N=p("GroupForm"),D=p("SubmissionWrapper"),V=p("modal-dialog"),I=j("remaining-height");return o(),u("div",null,[y("h1",A,[e[9]||(e[9]=b(" Groups ")),a.hasPermission("groups-manage")?(o(),u("button",{key:0,class:"btn btn-xs",onClick:e[0]||(e[0]=(...l)=>c.startCreateGroup&&c.startCreateGroup(...l))}," Create a group ")):g("",!0)]),m(S,{onTabChanged:c.getGroupsForType},{default:d(()=>[(o(!0),u(w,null,F(i.tabDefinitions,l=>(o(),k(C,{key:l.label,label:l.label},{default:d(()=>[n.loading?(o(),u("div",L," Loading... ")):(o(),u("div",H,[y("div",J,[e[10]||(e[10]=b(" Filter: ")),x(y("input",{"onUpdate:modelValue":e[1]||(e[1]=r=>i.filterString=r),type:"text",placeholder:"name,id,status,coordinator name"},null,512),[[M,i.filterString]])]),x((o(),k(s,{sort:n.sort,"onUpdate:sort":e[3]||(e[3]=r=>n.sort=r),data:i.filteredGroups.filter(l.filter),fields:n.fields,"row-click-handler":i.goToGroup,"row-class":"cursor-pointer active:bg-blue-100"},{"cell-displayStatus":d(({item:r})=>[m(_,{class:"text-xs",color:r.statusColor},{default:d(()=>[b(G(r.displayStatus),1),r.status.id==1&&r.is_ep?(o(),u("span",K," - "+G(r.expert_panel.currentStepAbbr),1)):g("",!0)]),_:2},1032,["color"])]),"cell-coordinators":d(({value:r})=>[r.length==0?(o(),u("div",O)):g("",!0),(o(!0),u(w,null,F(r,(h,T)=>(o(),u("span",{key:h.id},[T>0?(o(),u("span",Q,", ")):g("",!0),m(t,{to:{name:"PersonDetail",params:{uuid:h.person.uuid}},class:"link",onClick:e[2]||(e[2]=R(()=>{},["stop"]))},{default:d(()=>[b(G(h.person.name),1)]),_:2},1032,["to"])]))),128))]),_:2},1032,["sort","data","fields","row-click-handler"])),[[I]])]))]),_:2},1032,["label"]))),128))]),_:1},8,["onTabChanged"]),m(V,{modelValue:n.showCreateForm,"onUpdate:modelValue":e[8]||(e[8]=l=>n.showCreateForm=l),title:"Create a New Group",size:"sm"},{default:d(()=>[m(D,{onSubmitted:e[6]||(e[6]=l=>a.$refs.groupForm.save()),onCanceled:e[7]||(e[7]=l=>a.$refs.groupForm.cancel())},{default:d(()=>[m(N,{ref:"groupForm",onCanceled:e[4]||(e[4]=l=>n.showCreateForm=!1),onSaved:e[5]||(e[5]=l=>n.showCreateForm=!1)},null,512)]),_:1})]),_:1},8,["modelValue"])])}const $=W(z,[["render",X]]);export{$ as default};
//# sourceMappingURL=GroupList-Bkhu6Cq2.js.map
