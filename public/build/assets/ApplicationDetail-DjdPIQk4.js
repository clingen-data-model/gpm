import{_ as F,B as q,a2 as z,a,c as f,b as s,f as n,w as r,d as l,ac as te,ad as oe,e as N,C as Y,i as y,ae as ne,n as le,a9 as se,h as $,j as k,F as j,m as L,a1 as T,af as E,v as B,q as V,r as I,x as W,g as S,p as U,ag as ae,k as O,ah as K,ai as re,aj as ie,o as ue,a8 as de,ak as J}from"./app-BJASbhl0.js";import{S as pe,P as me,A as ce,_ as P}from"./StepTabs-MuR3BYIx.js";import{G as ge}from"./GroupForm-DmC50J08.js";import{_ as fe,a as _e,c as R}from"./SustainedCurationReview-CO4pF1B7.js";import{j as Q}from"./judgement_utils-CQeBr_sj.js";import"./LogEntryForm-DB6FI0CT.js";import"./log_entry_repository-DBHDb_82.js";import"./SpecificationsSection-Blslffde.js";import"./ExpertisesView-BuFFzip_.js";import"./EvidenceSummaryList-biQb17WH.js";const ve={name:"ComponentName",props:{nextAction:{type:Object,required:!0}},emits:["completed","canceled"],data(){return{errors:[],dateCompleted:null}},computed:{...q({group:"groups/currentItemOrNew"}),application(){return this.group.expert_panel}},methods:{async markComplete(){try{await this.$store.dispatch("applications/completeNextAction",{application:this.application,nextAction:this.nextAction,dateCompleted:this.dateCompleted}),this.clearForm(),this.$emit("completed"),this.showModal=!1}catch(d){z(d)&&(this.errors=d.response.data.errors)}},clearForm(){this.dateCompleted=null},cancel(){this.clearForm(),this.$emit("canceled")}}},be=["innerHTML"];function he(d,e,h,v,t,o){const g=a("dictionary-row"),_=a("object-dictionary"),w=a("input-row"),p=a("button-row");return s(),f("div",null,[n(g,{label:"Action"},{default:r(()=>[l("div",{innerHTML:h.nextAction.entry},null,8,be)]),_:1}),n(_,{obj:h.nextAction,show:["date_created","step","target_date"],dates:["target_date","date_created"]},null,8,["obj"]),n(w,{modelValue:t.dateCompleted,"onUpdate:modelValue":e[0]||(e[0]=c=>t.dateCompleted=c),label:"Date Completed",type:"date",errors:t.errors.date_completed},null,8,["modelValue","errors"]),n(p,null,{default:r(()=>[l("button",{class:"btn white",onClick:e[1]||(e[1]=(...c)=>o.cancel&&o.cancel(...c))}," Cancel "),l("button",{class:"btn blue",onClick:e[2]||(e[2]=(...c)=>o.markComplete&&o.markComplete(...c))}," Mark Complete ")]),_:1})])}const we=F(ve,[["render",he]]),xe={name:"NextActions",components:{CompleteNextActionForm:we,CheckmarkButton:oe,TrashIconButton:te},props:{nextActions:{type:Array,required:!0}},emits:["completed"],data(){return{tableSort:{field:"target_date",desc:!1},showCompleted:!1,showDeleteConfirmation:!1,selectedNextAction:{},errors:{},showCreateModal:!1,fields:[{name:"entry",label:"Next Action",type:String},{name:"assigned_to",label:"Assigned to",sortable:!0,resolveValue(d){let e=d.assigned_to;return d.assigned_to_name&&(e+=`- ${d.assigned_to_name}`),e}},{name:"target_date",label:"Due Date",type:Date,sortable:!0},{name:"action",label:"",sortable:!1}]}},computed:{...q({group:"groups/currentItemOrNew"}),application(){return this.group.expert_panel},filteredNextActions(){return this.nextActions?this.showCompleted?this.nextActions:this.nextActions.filter(d=>!d.date_completed):[]}},methods:{startCompleting(d){this.selectedNextAction=d,this.showCreateModal=!0},handleCompleted(){this.$emit("completed"),this.showCreateModal=!1},initiateDelete(d){this.$router.push({name:"ConfirmDeleteNextAction",params:{applicationUuid:this.application.uuid,id:d.id}})}}},ye={class:"text-sm"},Ce={class:"flex justify-between"},ke=["innerHTML"],Ae={class:"flex"},Ne={key:0},De={class:"flex space-x-1"},Ve={key:1,class:"well bg-gray-200 rounded border px-4 py-2 border-gray-300"},Me={key:0};function $e(d,e,h,v,t,o){const g=a("edit-icon-button"),_=a("TrashIconButton"),w=a("icon-checkmark"),p=a("CheckmarkButton"),c=a("data-table"),i=a("CompleteNextActionForm"),M=a("modal-dialog");return s(),f("div",ye,[l("div",Ce,[e[5]||(e[5]=l("h3",null,"Next Actions",-1)),l("label",null,[Y(l("input",{"onUpdate:modelValue":e[0]||(e[0]=u=>t.showCompleted=u),type:"checkbox"},null,512),[[ne,t.showCompleted]]),e[4]||(e[4]=y(" Show completed "))])]),o.filteredNextActions.length>0?(s(),N(c,{key:0,sort:t.tableSort,"onUpdate:sort":e[1]||(e[1]=u=>t.tableSort=u),fields:t.fields,data:o.filteredNextActions},{"cell-entry":r(({item:u})=>[l("div",{innerHTML:u.entry},null,8,ke)]),"cell-assigned_to":r(({item:u})=>[l("div",Ae,[y(k(u.assignee?u.assignee.name:"??")+"  ",1),u.assigned_to_name?(s(),f("span",Ne," - "+k(u.assigned_to_name),1)):$("",!0)])]),"cell-action":r(({item:u})=>[l("div",De,[n(g,{onClick:m=>d.$router.push({name:"EditNextAction",params:{uuid:o.application.uuid,id:u.id}})},null,8,["onClick"]),n(_,{onClick:m=>o.initiateDelete(u)},null,8,["onClick"]),u.date_completed?(s(),N(w,{key:0,width:"20",height:"20",class:le({"text-green-500":!!u.date_completed,"text-gray-300":!u.date_completed})},null,8,["class"])):(s(),N(p,{key:1,title:"Mark complete",onClick:se(m=>o.startCompleting(u),["prevent"])},null,8,["onClick"]))])]),_:1},8,["sort","fields","data"])):(s(),f("div",Ve,[e[6]||(e[6]=y(" There are no pending ")),t.showCompleted?(s(),f("span",Me,"or completed")):$("",!0),e[7]||(e[7]=y(" next actions. "))])),n(M,{modelValue:t.showCreateModal,"onUpdate:modelValue":e[3]||(e[3]=u=>t.showCreateModal=u),title:"Complete next action"},{default:r(()=>[n(i,{"next-action":t.selectedNextAction,onCanceled:e[2]||(e[2]=u=>t.showCreateModal=!1),onCompleted:o.handleCompleted},null,8,["next-action","onCompleted"])]),_:1},8,["modelValue"])])}const Se=F(xe,[["render",$e]]),Ie={name:"BasicInfoData",components:{GroupForm:ge},data(){return{showInfoEdit:!1}},computed:{group(){return this.$store.getters["groups/currentItemOrNew"]},application(){return this.group.expert_panel}},methods:{}},Fe={class:"flex justify-between border-b pb-2 min-w-fit"},Be={key:0},je={key:0},Ee=["href"],Ue={key:1};function Te(d,e,h,v,t,o){const g=a("dictionary-row"),_=a("router-link"),w=a("GroupForm"),p=a("submission-wrapper"),c=a("modal-dialog");return s(),f("div",null,[l("div",Fe,[e[7]||(e[7]=l("h3",null,"Base Information",-1)),l("button",{class:"btn btn-xs",onClick:e[0]||(e[0]=i=>t.showInfoEdit=!0)}," Edit ")]),n(g,{"label-class":"font-bold w-40",label:"Long Base Name"},{default:r(()=>[y(k(o.application.long_base_name||"--"),1)]),_:1}),n(g,{"label-class":"font-bold w-40",label:"Short Base Name"},{default:r(()=>[y(k(o.application.short_base_name||"--"),1)]),_:1}),n(g,{"label-class":"font-bold w-40",label:"Affiliation ID"},{default:r(()=>[y(k(o.application.affiliation_id||"--"),1)]),_:1}),n(g,{"label-class":"font-bold w-40",label:"CDWG"},{default:r(()=>[y(k(o.group.parent?o.group.parent.name:"--"),1)]),_:1}),n(g,{"label-class":"font-bold w-40",label:"Chair(s)"},{default:r(()=>[(s(!0),f(j,null,L(o.group.chairs,(i,M)=>(s(),f("span",{key:i.id},[n(_,{to:{name:"PersonDetail",params:{id:i.id}}},{default:r(()=>[y(k(i.person.name),1)]),_:2},1032,["to"]),M<o.group.chairs.length-1?(s(),f("span",Be,", ")):$("",!0)]))),128))]),_:1}),n(g,{"label-class":"font-bold w-40",label:"Coordinator(s)"},{default:r(()=>[(s(!0),f(j,null,L(o.group.coordinators,(i,M)=>(s(),f("span",{key:i.id},[n(_,{to:{name:"PersonDetail",params:{id:i.id}}},{default:r(()=>[y(k(i.person.name),1)]),_:2},1032,["to"]),M<o.group.coordinators.length-1?(s(),f("span",je,", ")):$("",!0)]))),128))]),_:1}),n(g,{"label-class":"font-bold w-40",label:"Website URL"},{default:r(()=>[o.application.stepIsApproved(1)?(s(),f("a",{key:0,href:`https://clinicalgenome.org/affiliation/${o.application.affiliation_id}`,target:"ep-website"}," https://clinicalgenome.org/affiliation/"+k(o.application.affiliation_id),9,Ee)):(s(),f("span",Ue,"https://clinicalgenome.org/affiliation/"+k(o.application.affiliation_id||"--"),1))]),_:1}),(s(),N(T,{to:"body"},[n(c,{modelValue:t.showInfoEdit,"onUpdate:modelValue":e[5]||(e[5]=i=>t.showInfoEdit=i),title:"Edit Group Info",size:"md",onClosed:e[6]||(e[6]=i=>t.showInfoEdit=!1)},{default:r(()=>[n(p,{onSubmitted:e[3]||(e[3]=i=>d.$refs.infoForm.save()),onCanceled:e[4]||(e[4]=i=>d.$refs.infoForm.cancel())},{default:r(()=>[n(w,{ref:"infoForm",onCanceled:e[1]||(e[1]=i=>t.showInfoEdit=!1),onSaved:e[2]||(e[2]=i=>t.showInfoEdit=!1)},null,512)]),_:1})]),_:1},8,["modelValue"])]))])}const Ge=F(Ie,[["render",Te]]),Je={name:"ApplicationDetail",components:{ApplicationLog:ce,NextActions:Se,ProgressChart:me,StepTabs:pe,BasicInfoData:Ge},props:{loading:{type:Boolean,default:!1}},emits:["updated"],data(){return{showModal:!1}},watch:{$route(){this.showModal=this.$route.meta.showModal?!!this.$route.meta.showModal:!1}},computed:{...q({group:"groups/currentItemOrNew"}),application(){return this.group.expert_panel},hasPendingNextAction(){return typeof this.application>"u"?!1:this.application.latest_pending_next_action},breadcrumbs(){return this.group.uuid?[{label:this.group.displayName,route:{name:"GroupDetail",params:{uuid:this.group.uuid}}}]:[]}},mounted(){this.showModal=!!this.$route.meta.showModal},methods:{hideModal(){this.$router.replace({name:"ApplicationDetail",params:{uuid:this.group.uuid}})},handleModalClosed(d){this.clearModalForm(d),this.$router.push({name:"ApplicationDetail",params:{uuid:this.group.uuid}})},clearModalForm(){typeof this.$refs.modalView.clearForm=="function"&&this.$refs.modalView.clearForm()}}},Le={class:"flex space-x-2"},Oe={class:"md:flex md:space-x-4"};function Pe(d,e,h,v,t,o){const g=a("static-alert"),_=a("note"),w=a("router-link"),p=a("BasicInfoData"),c=a("NextActions"),i=a("ProgressChart"),M=a("StepTabs"),u=a("tab-item"),m=a("ApplicationLog"),b=a("tabs-container"),C=a("ScreenTemplate"),x=a("router-view"),A=a("modal-dialog");return s(),f("div",null,[!h.loading&&!d.group.hasContacts?(s(),N(g,{key:0,variant:"danger",class:"mb-4"},{default:r(()=>e[3]||(e[3]=[l("strong",null,"Warning!!",-1),y(" There are currently no contacts connected to this application! ")])),_:1})):$("",!0),n(C,{title:d.group.displayName,breadcrumbs:o.breadcrumbs},{"header-dev":r(()=>[n(_,null,{default:r(()=>[y(" Group ID: "+k(d.group.id)+" | Expert Panel ID: "+k(d.group.expert_panel.id),1)]),_:1})]),"header-right":r(()=>[l("div",Le,[n(w,{to:{name:"NextAction"},class:"btn btn-sm"},{default:r(()=>e[4]||(e[4]=[y(" Add Next Action ")])),_:1}),n(w,{to:{name:"LogEntry"},class:"btn btn-sm"},{default:r(()=>e[5]||(e[5]=[y(" Add Log Entry ")])),_:1})])]),default:r(()=>[l("div",Oe,[n(p,{class:"w-1/2 screen-block"}),o.application.next_actions?(s(),N(c,{key:0,"next-actions":o.application.next_actions,class:"w-1/2 space-y-2 md:px-4 md:py-2 bg-white border-b border-gray-200"},null,8,["next-actions"])):$("",!0)]),n(i,{application:o.application,class:"py-4 screen-block"},null,8,["application"]),n(b,null,{default:r(()=>[n(u,{label:"Application"},{default:r(()=>[n(M,{application:o.application,onUpdated:e[0]||(e[0]=D=>d.$emit("updated")),onApproved:e[1]||(e[1]=D=>d.$emit("updated"))},null,8,["application"])]),_:1}),n(u,{label:"Application Log"},{default:r(()=>[n(m,{uuid:o.application.uuid},null,8,["uuid"])]),_:1}),n(u,{label:"Advanced"},{default:r(()=>[e[7]||(e[7]=l("h2",{class:"block-title"}," Advanced actions and controls ",-1)),n(w,{to:{name:"ConfirmDeleteApplication"},class:"btn red"},{default:r(()=>e[6]||(e[6]=[y(" Delete Application and all associated information. ")])),_:1})]),_:1})]),_:1})]),_:1},8,["title","breadcrumbs"]),(s(),N(T,{to:"body"},[n(A,{modelValue:t.showModal,"onUpdate:modelValue":e[2]||(e[2]=D=>t.showModal=D),title:d.$route.meta.title,onClosed:o.handleModalClosed},{default:r(()=>[n(x,{ref:"modalView",onSaved:o.hideModal,onCanceled:o.hideModal},null,8,["onSaved","onCanceled"])]),_:1},8,["modelValue","title","onClosed"])]))])}const qe=F(Je,[["render",Pe]]),Re={key:0,class:"mt-2"},He={class:"flex px-4 space-x-4 items-center p-2 bg-gray-100 rounded-lg"},X={__name:"JudgementForm",props:{modelValue:{type:Object,default:()=>({decision:null,notes:null})}},emits:["saved","canceled","update:modelValue"],setup(d,{emit:e}){const h=d,v=e,t=E("commentManager"),o=B(),g=V(()=>o.getters["groups/currentItemOrNew"]),_=["request-revisions","approve-after-revisions","approve"],w=I({}),p=I({judgement:null,notes:null}),c=C=>{p.value=C};W(()=>h.modelValue,C=>{C&&c(C)},{immediate:!0});const i=()=>{if(h.modelValue){c(h.modelValue);return}p.value={}},M=async()=>U.post(`/api/groups/${g.value.uuid}/application/judgements`,{decision:p.value.decision,notes:p.value.notes}).then(C=>(v("saved",C.data),i(),C.data)),u=async()=>{const C=`/api/groups/${g.value.uuid}/application/judgements/${p.value.id}`;return U.put(C,p.value).then(x=>(v("saved",x.data),x.data))},m=async()=>{try{return p.value.id?await u():await M()}catch(C){z(C)&&(w.value=C.response.data.errors)}},b=()=>{i(),v("canceled")};return(C,x)=>{const A=a("radio-button-group"),D=a("input-row"),Z=a("icon-exclamation"),ee=a("button-row");return s(),f("div",null,[S(t).commentsForEp.length>0?(s(),f("div",Re,[x[2]||(x[2]=l("h3",null,"The following comments will be sent to the expert panel:",-1)),n(P,{comments:S(t).commentsForEp},null,8,["comments"])])):$("",!0),x[5]||(x[5]=l("hr",null,null,-1)),n(D,{errors:w.value.decision,vertical:""},{label:r(()=>x[3]||(x[3]=[l("h3",null,"How should we proceed?",-1)])),default:r(()=>[n(A,{modelValue:p.value.decision,"onUpdate:modelValue":x[0]||(x[0]=G=>p.value.decision=G),options:_,"label-attribute":"label",size:"lg",vertical:""},null,8,["modelValue"])]),_:1},8,["errors"]),n(D,{modelValue:p.value.notes,"onUpdate:modelValue":x[1]||(x[1]=G=>p.value.notes=G),label:"Other notes for the expert panel",type:"large-text",errors:w.value.notes,vertical:""},null,8,["modelValue","errors"]),l("div",He,[n(Z,{class:"text-blue-600 flex-shrink-0",width:"30",height:"30"}),x[4]||(x[4]=l("div",null," Reply to or create comments, suggestions, and required revisions in the comments section on the main screen. ",-1))]),n(ee,{onSubmitted:m,onCanceled:b})])}}},ze={key:0},Ye={key:0,class:"mt-2"},We={__name:"JudgementDetail",emits:["deleted"],setup(d,{emit:e}){const h=e,v=B(),t=E("latestSubmission"),o=V(()=>v.getters["groups/currentItemOrNew"]),g=V(()=>v.getters.currentUser),_=V({get(){return t.value&&t.value.judgements?t.value.judgements.find(m=>m.person_id===g.value.person.id):null}}),w=V(()=>Q(_.value.decision)),p=I(!1),c=()=>{p.value=!0},i=I(!1),M=()=>{i.value=!0},u=async()=>{await U.delete(`/api/groups/${o.value.uuid}/application/judgements/${_.value.id}`),i.value=!1,h("deleted")};return(m,b)=>{const C=a("badge"),x=a("modal-dialog"),A=a("button-row");return _.value?(s(),f("div",ze,[l("h3",null,[b[6]||(b[6]=y(" Your Decision: ")),n(C,{color:w.value,size:"lg"},{default:r(()=>[y(k(S(ae)(_.value.decision)),1)]),_:1},8,["color"])]),_.value.notes?(s(),f("div",Ye,[l("p",null,[b[7]||(b[7]=l("strong",null,"Notes: ",-1)),y(k(_.value.notes),1)])])):$("",!0),l("div",{class:"flex space-x-2"},[l("button",{class:"btn btn-xs",onClick:c}," Change Decision "),l("button",{class:"btn btn-xs",onClick:M}," Cancel Decision ")]),(s(),N(T,{to:"body"},[n(x,{modelValue:p.value,"onUpdate:modelValue":b[3]||(b[3]=D=>p.value=D),title:"Update Your Decision"},{default:r(()=>[n(X,{modelValue:_.value,"onUpdate:modelValue":b[0]||(b[0]=D=>_.value=D),onSaved:b[1]||(b[1]=D=>p.value=!1),onCanceled:b[2]||(b[2]=D=>p.value=!1)},null,8,["modelValue"])]),_:1},8,["modelValue"]),n(x,{modelValue:i.value,"onUpdate:modelValue":b[5]||(b[5]=D=>i.value=D),title:"Delete your decision for this applicaiton"},{footer:r(()=>[n(A,{"submit-text":"Yes, Delete",onSubmitted:u,onCanceled:b[4]||(b[4]=D=>i.value=!1)})]),default:r(()=>[b[8]||(b[8]=y(" You are about to delete your decision for this applicaiton. This cannot be undone. Are you sure you want to continue? "))]),_:1},8,["modelValue"])]))])):$("",!0)}}},Ke={class:"flex flex-col space-y-2 screen-block"},Qe={class:"xl:w-3/4 flex flex-col space-y-2 border-between-children"},Xe={class:"mb-2"},Ze={key:1,class:"note"},et={class:"mb-2"},tt={key:1,class:"note"},ot={key:0},nt={key:1},lt={class:"text-lg"},st={key:0,class:"ml-2 text-sm"},at={class:"pt-2 lg:flex lg:space-x-2 space-y-2 lg:space-y-0 items-start"},rt={class:"lg:w-3/5"},it={class:"flex space-x-2 items-center p-2 bg-gray-100 rounded-lg lg:w-2/5"},ut={__name:"ChairApproverControls",emits:["deleted","saved"],setup(d,{emit:e}){const h=e,v=E("commentManager"),t=E("latestSubmission"),o=B(),g=I(!1),_=()=>{g.value=!0},w=V(()=>t.value.judgements&&t.value.judgements.length>0&&t.value.judgements.filter(u=>u.person_id===o.getters.currentUser.person.id).length>0),p=V(()=>!t.value||!t.value.judgements?[]:t.value.judgements.filter(u=>u.person_id!==o.getters.currentUser.person.id)),c=V(()=>v.value.commentsForEp.length>0),i=V(()=>v.value.openInternal.length>0),M=u=>{g.value=!1,h("saved",u)};return(u,m)=>{const b=a("badge"),C=a("icon-arrow-down"),x=a("modal-dialog");return s(),f("div",Ke,[l("div",Qe,[l("div",null,[m[4]||(m[4]=l("h3",null,"Comments for the Expert Panel",-1)),l("div",Xe,[c.value?(s(),N(P,{key:0,comments:S(v).commentsForEp},null,8,["comments"])):(s(),f("div",Ze," None "))])]),l("div",null,[m[5]||(m[5]=l("h3",null,"Internal Comments",-1)),l("div",et,[i.value?(s(),N(P,{key:0,comments:S(v).openInternal},null,8,["comments"])):(s(),f("div",tt," None "))])]),S(t).notes_for_chairs?(s(),f("div",ot,[m[6]||(m[6]=l("h3",null,"Other notes from the Core Group",-1)),l("p",null,k(S(t).notes_for_chairs),1)])):$("",!0),p.value.length>0?(s(),f("div",nt,[m[8]||(m[8]=l("h3",null,"Other Approver's Judgements:",-1)),l("ul",null,[(s(!0),f(j,null,L(p.value,A=>(s(),f("li",{key:A.id,class:"mt-2 ml-2"},[l("div",lt,[y(k(A.person.name)+": ",1),n(b,{color:S(Q)(A)},{default:r(()=>[y(k(u.titleCase(A.decision)),1)]),_:2},1032,["color"])]),A.notes?(s(),f("p",st,[m[7]||(m[7]=l("strong",null,"Notes for EP: ",-1)),y(k(A.notes),1)])):$("",!0)]))),128))])])):$("",!0)]),m[10]||(m[10]=l("hr",null,null,-1)),l("div",at,[l("div",rt,[w.value?(s(),N(We,{key:1,onDeleted:m[0]||(m[0]=A=>h("deleted")),onSaved:m[1]||(m[1]=A=>h("saved"))})):(s(),f("button",{key:0,class:"block btn btn-lg blue",onClick:_}," Approve or request revisions "))]),l("div",it,[n(C,{class:"text-blue-600 flex-shrink-0",width:"30",height:"30"}),m[9]||(m[9]=l("div",null,"Reply to or create comments, suggestions, and required revisions in the comments sections below.",-1)),n(C,{class:"text-blue-600 flex-shrink-0",width:"30",height:"30"})])]),(s(),N(T,{to:"body"},[n(x,{modelValue:g.value,"onUpdate:modelValue":m[3]||(m[3]=A=>g.value=A),title:"Approve or request revisions"},{default:r(()=>[n(X,{onSaved:M,onCanceled:m[2]||(m[2]=A=>g.value=!1)})]),_:1},8,["modelValue"])]))])}}},dt=F(ut,[["__scopeId","data-v-3d4ff86d"]]),H={__name:"ApplicationReview",emits:["deleted","saved"],setup(d,{emit:e}){const h=e,v=B(),t=V(()=>v.getters["groups/currentItemOrNew"]),o=V(()=>t.value.expert_panel),g=V(()=>t.value.uuid?[{label:t.value.displayName,route:{name:"GroupDetail",params:{uuid:t.value.uuid}}}]:[]),_=V(()=>Number.parseInt(t.value.expert_panel.current_step)===4?fe:Number.parseInt(o.value.current_step)===1?_e:null),w=V(()=>t.value.is_gcep?t.value.displayName:`${t.value.displayName} - ${t.value.expert_panel.currentStepName}`);return(p,c)=>(s(),N(re,{title:w.value,breadcrumbs:g.value},{default:r(()=>[S(O)("ep-applications-approve")?(s(),N(dt,{key:0,onDeleted:c[0]||(c[0]=i=>h("deleted")),onSaved:c[1]||(c[1]=i=>h("deleted"))})):$("",!0),(s(),N(K(_.value)))]),_:1},8,["title","breadcrumbs"]))}},xt={__name:"ApplicationDetail",props:{uuid:{type:String,requird:!0}},setup(d){const e=d,h=I(R("App\\Modules\\Group\\Models\\Group",0));J("commentManager",h);const v=B(),t=I(!1),o=V(()=>v.getters["groups/currentItemOrNew"]);J("group",o);const g=ie(H),_=I({});J("latestSubmission",_);const w=()=>{U.get(`/api/groups/${o.value.uuid}/application/latest-submission`).then(c=>_.value=c.data).catch(c=>{console.log(c)})},p=async()=>{t.value=!0,await v.dispatch("groups/findAndSetCurrent",e.uuid),v.dispatch("groups/getDocuments",o.value),v.dispatch("groups/getNextActions",o.value),v.dispatch("groups/getSubmissions",o.value),w(),v.dispatch("groups/getMembers",o.value),v.dispatch("groups/getGenes",o.value),t.value=!1};return W(()=>e.uuid,async(c,i)=>{c&&(!i||c!==i)&&(await p(),h.value=R("App\\Modules\\Group\\Models\\Group",o.value.id),h.value.getComments())},{immediate:!0}),ue(async()=>{O("ep-applications-comment")&&(g.value=H),O("ep-applications-manage")&&(g.value=qe)}),(c,i)=>(s(),f(j,null,[(s(),N(K(g.value),{loading:t.value,onUpdated:p,onSaved:w,onDeleted:w},null,40,["loading"])),Y(l("div",null," Loading… ",512),[[de,t.value]])],64))}};export{xt as default};
//# sourceMappingURL=ApplicationDetail-DjdPIQk4.js.map
