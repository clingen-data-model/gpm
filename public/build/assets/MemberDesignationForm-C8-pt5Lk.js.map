{"version":3,"file":"MemberDesignationForm-C8-pt5Lk.js","sources":["../../../resources/js/components/expert_panels/MemberDesignationRow.vue","../../../resources/js/components/expert_panels/MemberDesignationForm.vue"],"sourcesContent":["<script>\nimport GroupMember from '@/domain/group_member'\nimport {debounce} from 'lodash-es'\n\nexport default {\n    name: 'ComponentName',\n    props: {\n        member: {\n            type: GroupMember,\n            required: true\n        },\n        readonly: {\n            type: Boolean,\n            required: false,\n            default: false\n        }\n    },\n    emits: [\n        'updated'\n    ],\n    data() {\n        return {\n            workingCopy: new GroupMember(),\n        }\n    },\n    computed: {\n        group () {\n            return this.$store.getters['groups/currentItemOrNew'];\n        },\n        biocurator: {\n            get () {\n                return this.workingCopy.hasRole('biocurator');\n            },\n            set (value) {\n                this.toggleRole(value, 'biocurator')\n            }\n        },\n        biocuratorTrainer: {\n            get () {\n                return this.workingCopy.hasRole('biocurator-trainer')\n            },\n            set (value) {\n                this.toggleRole(value, 'biocurator-trainer')\n            }\n        },\n        coreApprovalMember: {\n            get () {\n                return this.workingCopy.hasRole('core-approval-member')\n            },\n            set (value) {\n                this.toggleRole(value, 'core-approval-member')\n            }\n        },\n        canEdit () {\n            return this.hasAnyPermission([\n                        'ep-applications-manage',\n                        ['application-edit', this.group]\n                    ])\n                    && !this.readonly;\n        }\n    },\n    watch: {\n        member: {\n            immediate: true,\n            handler(to) {\n                this.syncWorkingCopy(to);\n            }\n        }\n    },\n    created () {\n        this.debounceSave = debounce(() => {\n            this.save();\n        }, 1000)\n    },\n    methods: {\n        initWorkingCopy() {\n            this.workingCopy = new GroupMember();\n        },\n\n        syncWorkingCopy (member) {\n            if (member.id) {\n                this.workingCopy = member.clone();\n            }\n        },\n\n        toggleRole (hasRole, roleName) {\n            if (hasRole) {\n                this.workingCopy.addRole(roleName);\n                return;\n            }\n\n            this.workingCopy.removeRole(roleName);\n        },\n\n        save () {\n            const promises = [];\n\n            promises.push(this.updateTrainingInfo());\n            promises.push(this.syncRoles());\n\n            return promises;\n        },\n\n        updateTrainingInfo () {\n            if (this.workingCopy.isDirty('training_level_1') || this.workingCopy.isDirty('training_level_2')) {\n                return this.$store.dispatch(\n                    'groups/memberUpdate',\n                    {\n                        groupUuid: this.group.uuid,\n                        memberId: this.workingCopy.id,\n                        data: {\n                            training_level_1: this.workingCopy.training_level_1,\n                            training_level_2: this.workingCopy.training_level_2,\n                        }\n                    }\n                )\n            }\n        },\n\n        syncRoles() {\n            if (this.workingCopy.isDirty('roles')) {\n                return this.$store.dispatch(\n                        'groups/memberSyncRoles',\n                        {\n                            group: this.group,\n                            member: this.workingCopy\n                        }\n                    );\n            }\n        },\n        emitUpdated () {\n            this.$emit('updated', this.workingCopy)\n        }\n    }\n}\n</script>\n<template>\n  <tr>\n    <td>{{ workingCopy.person.first_name }}</td>\n    <td>{{ workingCopy.person.last_name }}</td>\n    <td colgroup=\"biocurator\">\n      <input v-model=\"biocurator\" type=\"checkbox\" :disabled=\"!canEdit\" @input=\"debounceSave\">\n    </td>\n    <td colgroup=\"biocurator\">\n      <input v-model=\"workingCopy.training_level_1\" type=\"checkbox\" :disabled=\"!canEdit\" @input=\"debounceSave\">\n    </td>\n    <td colgroup=\"biocurator\">\n      <input v-model=\"workingCopy.training_level_2\" type=\"checkbox\" :disabled=\"!canEdit\" @input=\"debounceSave\">\n    </td>\n    <td>\n      <input v-model=\"biocuratorTrainer\" type=\"checkbox\" :disabled=\"!canEdit\" @input=\"debounceSave\">\n    </td>\n    <td>\n      <input v-model=\"coreApprovalMember\" type=\"checkbox\" :disabled=\"!canEdit\" @input=\"debounceSave\">\n    </td>\n  </tr>\n</template>\n<style lang=\"postcss\" scoped>\n    td[colgroup=biocurator] {\n        @apply bg-blue-50;\n    }\n    tr:nth-child(odd) > td[colgroup=biocurator] {\n        @apply bg-blue-100;\n    }\n</style>\n","<script>\nimport MemberDesignationRow from './MemberDesignationRow.vue'\nexport default {\n    name: 'MemberDesignationForm',\n    components: {\n        MemberDesignationRow,\n    },\n    props: {\n        readonly: {\n            type: Boolean,\n            required: false,\n            default: false\n        }\n    },\n    emits: [\n      'updated',\n    ],\n    computed: {\n        group: {\n            get() {\n                return this.$store.getters['groups/currentItemOrNew'];\n            }\n        },\n        canEdit () {\n            return this.hasAnyPermission([\n                        'ep-applications-manage',\n                        ['application-edit', this.group]\n                    ])\n                    && !this.readonly;\n        }\n    },\n    watch: {\n        group: {\n            immediate: true,\n            async handler (to, from) {\n                if ((to.id && (!from || to.id !== from.id))) {\n                    this.$store.dispatch('groups/getMembers', this.group);\n                }\n            }\n        }\n    },\n    methods: {\n        getMembers () {\n            this.$store.dispatch('groups/getMembers', {group: this.group})\n        },\n        handleMemberUpdate () {\n            this.$emit('updated');\n        }\n    },\n}\n</script>\n<template>\n  <div>\n    <table class=\"text-sm\">\n      <thead>\n        <tr>\n          <th colspan=\"2\">\n&nbsp;\n          </th>\n          <th colspan=\"1\" colgroup=\"biocurator\">\n&nbsp;\n          </th>\n          <th colspan=\"2\" colgroup=\"biocurator\" class=\"text-center\">\n            Training\n          </th>\n          <th colspan=\"2\">\n&nbsp;\n          </th>\n        </tr>\n        <tr>\n          <th>First Name</th>\n          <th>Last Name</th>\n          <th colgroup=\"biocurator\" class=\"w-24\">\n            Biocurator\n          </th>\n          <th colgroup=\"biocurator\" class=\"w-20\">\n            Level 1\n          </th>\n          <th colgroup=\"biocurator\" class=\"w-20\">\n            Level 2\n          </th>\n          <th>Biocurator Trainer</th>\n          <th>\n            Core Approval Member\n            <popover\n              arrow\n              content=\"Core approval members are responsible for ongoing final approval of variant classifications.\"\n              hover\n            >\n              <icon-info class=\"inline-block cursor-pointer\" :width=\"16\" :height=\"16\" />\n            </popover>\n          </th>\n        </tr>\n      </thead>\n      <tbody>\n        <MemberDesignationRow\n          v-for=\"member in group.activeMembers\"\n          :key=\"member.id\"\n          :ref=\"`memberRow${member.id}`\"\n          :member=\"member\"\n          :readonly=\"readonly\"\n          @updated=\"handleMemberUpdate\"\n        />\n      </tbody>\n    </table>\n    <!-- <div class=\"flex items-center mt-2 pt-2 border-t\">\n            <icon-info :width=\"14\" :height=\"14\" />\n            &nbsp;\n            <div>Core approval members are responsible for ongoing final approval of variant classifications.</div>\n        </div> -->\n  </div>\n</template>\n<style scoped>\n    th {\n        @apply bg-white border-0;\n    }\n    th[colgroup=biocurator],\n    td[colgroup=biocurator]\n    {\n        @apply bg-blue-50;\n    }\n</style>\n"],"names":["_sfc_main","GroupMember","value","to","debounce","member","hasRole","roleName","promises","_hoisted_1","_hoisted_2","_hoisted_3","_hoisted_4","_hoisted_5","_hoisted_6","_hoisted_7","_hoisted_8","_createElementBlock","_createElementVNode","_toDisplayString","$data","_cache","$event","$options","_ctx","args","_vModelCheckbox","MemberDesignationRow","from","_createTextVNode","_createVNode","_component_popover","_withCtx","_component_icon_info","_openBlock","_Fragment","_renderList","_createBlock","_component_MemberDesignationRow","$props"],"mappings":"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"}