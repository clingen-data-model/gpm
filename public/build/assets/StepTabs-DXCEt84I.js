import{_ as A,q as C,v as z,x as Z,c,e as y,f as p,j as g,w as v,d as r,h as b,a as i,b as a,am as D,n as G,F,m as R,i as w,g as k,a6 as ee,l as te,B as $,aH as Y,C as E,ae as J,a0 as K,a8 as W,a2 as j,p as M,aI as P,r as T,$ as N,aJ as O,a1 as B,af as oe,aK as ne}from"./app-BQ9Yh0Tx.js";import se from"./LogEntryForm-DzG8Sp59.js";import{f as H,l as ae}from"./log_entry_repository-b_Ff-vG9.js";import{j as re}from"./judgement_utils-CQeBr_sj.js";import{c as ie,a as pe,_ as le}from"./SustainedCurationReview-C4eF_mJ-.js";import{S as Q}from"./SpecificationsSection-CwIlRSoA.js";const L=[{name:"created_at",label:"Created",sortName:"created_at",sortable:!0,type:Date},{name:"description",label:"Entry",sortable:!0,type:String},{name:"causer.name",label:"User",sortable:!0},{name:"id",label:"",sortable:!1}],ue={components:{LogEntryForm:se},props:{step:{required:!1,type:Number}},setup(){const o=z(),e=C(()=>o.getters["groups/currentItemOrNew"]),l=C(()=>e.value.expert_panel);return Z(e,()=>{e.value.uuid&&H(`/api/groups/${e.value.uuid}/activity-logs`)},{immediate:!0}),{group:e,application:l,logEntries:ae}},data(){return{sort:{field:"created_at",desc:!0},selectedLogEntry:{},editingEntry:!1}},computed:{fields(){return Number.parseInt(this.group.group_type_id)===4&&!L.map(o=>o.name).includes("step")&&L.splice(2,0,{name:"step",sortable:!0}),L},hasLogEntries(){return this.filteredLogEntries.length>0},filteredLogEntries(){return this.logEntries&&this.step?this.logEntries.filter(o=>Number.parseInt(o.step)===this.step):this.logEntries?this.logEntries:[]},noResultsMessage(){return typeof this.step=="number"?`No progress log entries have been entered for step ${this.step}`:"There are no log entries for this application"}},mounted(){},methods:{async getLogEntries(){await H()},editLogEntry(o){this.editingEntry=!0,this.selectedLogEntry=o}}},de={key:0,class:"px-3 py-2 rounded border border-gray-300 text-gray-500 bg-gray-200"},ce={class:"flex space-x-1"},me=["innerHTML"];function ve(o,e,l,m,n,t){const d=i("icon-edit"),s=i("router-link"),f=i("icon-trash"),S=i("data-table"),_=i("LogEntryForm"),h=i("modal-dialog");return a(),c("div",null,[t.hasLogEntries?(a(),y(S,{key:1,sort:n.sort,"onUpdate:sort":e[0]||(e[0]=u=>n.sort=u),fields:t.fields,data:t.filteredLogEntries},{"cell-id":v(({item:u})=>[r("div",ce,[p(s,{to:{name:"EditLogEntry",params:{id:u.id}},class:"btn btn-xs inline-block"},{default:v(()=>[p(d,{width:"12"})]),_:2},1032,["to"]),u.activity_type===null?(a(),y(s,{key:0,to:{name:"ConfirmDeleteLogEntry",params:{id:u.id}},class:"btn btn-xs inline-block"},{default:v(()=>[p(f,{width:"12"})]),_:2},1032,["to"])):b("",!0)])]),"cell-description":v(({item:u})=>[r("div",{class:"links-blue",innerHTML:u.description},null,8,me)]),_:1},8,["sort","fields","data"])):(a(),c("div",de,g(t.noResultsMessage),1)),p(h,{modelValue:n.editingEntry,"onUpdate:modelValue":e[1]||(e[1]=u=>n.editingEntry=u),title:"Edit log entry"},{default:v(()=>[p(_)]),_:1},8,["modelValue"])])}const fe=A(ue,[["render",ve]]),_e={props:{step:{type:Number,required:!0},application:{type:Object,required:!0}},data(){return{}},computed:{dateInitiated(){return D(this.application.date_initiated)},approvalDate(){return this.application.approvalDateForStep(this.step)?D(this.application.approvalDateForStep(this.step)):" "},displayClass(){const o=[];return this.isApproved?o.push("approved"):this.isCurrentStep&&o.push("active"),this.isFirstStep&&o.push("rounded-l"),this.isLastStep&&o.push("rounded-r"),o.join(" ")},isCurrentStep(){return Number.parseInt(this.application.current_step)===Number.parseInt(this.step)},isApproved(){return this.application.stepIsApproved(this.step)},isFirstStep(){return Number.parseInt(this.step)===1},isLastStep(){const o=Math.max(...this.application.steps);return Number.parseInt(this.step)===Number.parseInt(o)}},methods:{}},be={class:"flex-1"},he={class:"flex flex-row-reverse justify-between bg-transparent mt-1"},ge={key:0};function ye(o,e,l,m,n,t){return a(),c("div",be,[r("div",{class:G(["progress-step",t.displayClass])},null,2),r("div",he,[r("div",{class:G({"-mr-10":!t.isLastStep})},g(t.approvalDate),3),t.isFirstStep?(a(),c("div",ge,g(t.dateInitiated),1)):b("",!0)])])}const Se=A(_e,[["render",ye]]),we={components:{ProgressStep:Se},props:{application:{required:!0,type:Object}},computed:{steps(){return this.application.steps}}},Ce={class:"flex flex-row space-x-1"};function Ae(o,e,l,m,n,t){const d=i("ProgressStep");return a(),c("div",null,[e[0]||(e[0]=r("h3",{class:"pb-2"}," EP Progress ",-1)),r("div",Ce,[(a(!0),c(F,null,R(t.steps,s=>(a(),y(d,{key:s,step:s,application:l.application},null,8,["step","application"]))),128))])])}const Gt=A(we,[["render",Ae],["__scopeId","data-v-de4e582f"]]),xe={key:0},ke={key:0},$e={key:1},De={key:2},Te={key:3},Ue={key:0,class:"list-disc pl-6"},Fe={key:0,class:"text-sm"},Re={key:1,class:"ml-4 text-gray-500"},Ie={__name:"SubmissionInfo",props:{group:{type:Object,required:!0},step:{type:Number,required:!0}},setup(o){const e=o,l=C(()=>e.group.expert_panel.submissionsForStep(e.step)),m=C(()=>l.value&&l.value.length>0),n=C(()=>e.group.expert_panel.latestPendingSubmissionForStep(e.step)),t=C(()=>l.value?Number.parseInt(l.value.length)===1||Number.parseInt(n.value.submission_status_id)===3||Number.parseInt(n.value.submission_status_id)===2?n.value.judgements:l.value[l.value.length-2].judgements:[]);return(d,s)=>{const f=i("badge"),S=i("static-alert");return o.step==o.group.expert_panel.current_step?(a(),c("div",xe,[m.value?(a(),y(S,{key:0,class:"mb-4 border-blue-700",variant:"bland"},{default:v(()=>[n.value.sent_to_chairs_at?b("",!0):(a(),c("div",ke,[s[0]||(s[0]=r("strong",null,"Submitted",-1)),w(" by "+g(n.value.submitter?n.value.submitter.name:"")+" on ",1),r("strong",null,g(k(D)(n.value.created_at)),1),n.value.notes?(a(),y(ee,{key:0,class:"ml-4",markdown:n.value.notes},null,8,["markdown"])):b("",!0)])),n.value.submission_status_id==3?(a(),c("div",$e,[s[1]||(s[1]=r("strong",null,"Sent to chairs",-1)),s[2]||(s[2]=w(" on ")),r("strong",null,g(k(D)(n.value.sent_to_chairs_at)),1),s[3]||(s[3]=w(". "))])):b("",!0),n.value.submission_status_id==2?(a(),c("div",De,[r("strong",null,g(k(D)(n.value.updated_at)),1),s[4]||(s[4]=w(" - Revisions Requested. "))])):b("",!0),k(te)("chair_review")&&n.value.submission_status_id==3?(a(),c("div",Te,[s[7]||(s[7]=r("hr",{class:"my-1"},null,-1)),s[8]||(s[8]=r("strong",null,"Latest Chair Decisions:",-1)),t.value&&t.value.length>0?(a(),c("ul",Ue,[(a(!0),c(F,null,R(t.value,_=>(a(),c("li",{key:_.id},[r("strong",null,g(_.person.name)+":",1),s[6]||(s[6]=w(" Â  ")),p(f,{color:k(re)(_)},{default:v(()=>[w(g(_.decision),1)]),_:2},1032,["color"]),_.notes?(a(),c("div",Fe,[s[5]||(s[5]=r("strong",null,"Notes:",-1)),w(" "+g(_.notes),1)])):b("",!0)]))),128))])):(a(),c("div",Re," Awaiting decisions... "))])):b("",!0)]),_:1})):b("",!0)])):b("",!0)}}},Ne=A(Ie,[["__scopeId","data-v-a0e00bde"]]),Ee={1:"App\\Mail\\UserDefinedMailTemplates\\InitialApprovalMailTemplate",2:"App\\Mail\\UserDefinedMailTemplates\\SpecificationDraftMailTemplate",3:"App\\Mail\\UserDefinedMailTemplates\\SpecificationPilotMailTemplate",4:"App\\Mail\\UserDefinedMailTemplates\\SustainedCurationApprovalMailTemplate"},Me={components:{UserDefinedMailForm:Y},emits:["canceled","saved"],data(){return{dateApproved:null,notifyContacts:!1,email:{subject:"",body:"",cc:[],to:[],files:[]},errors:{}}},computed:{...$({group:"groups/currentItemOrNew"}),application(){return this.group.expert_panel}},watch:{notifyContacts(o){o&&M.get(`/api/email-drafts/groups/${this.group.uuid}`,{params:{templateClass:Ee[this.group.expert_panel.current_step]}}).then(e=>{this.email=e.data,this.email.files=[]})}},mounted(){},methods:{clearForm(){this.dateApproved=null,this.notifyContacts=!1},cancel(){this.clearForm(),this.$emit("canceled")},async save(){const o={group:this.group,dateApproved:this.dateApproved,notifyContacts:this.notifyContacts,subject:this.email.subject,body:this.email.body,attachments:this.email.files};try{await this.$store.dispatch("groups/approveCurrentStep",o),this.clearForm(),this.$emit("saved")}catch(e){j(e)&&(this.errors=e.response.data.errors)}}}},Ve={class:"text-sm"},qe={key:0};function Le(o,e,l,m,n,t){const d=i("input-row"),s=i("dictionary-row"),f=i("static-alert"),S=i("UserDefinedMailForm"),_=i("button-row"),h=i("form-container");return a(),y(h,null,{default:v(()=>[r("h2",null,"Approve Step "+g(t.application.current_step),1),p(d,{modelValue:n.dateApproved,"onUpdate:modelValue":e[0]||(e[0]=u=>n.dateApproved=u),type:"date",errors:n.errors.date_approved,label:"Date Approved"},null,8,["modelValue","errors"]),p(s,{label:""},{default:v(()=>[r("div",null,[r("label",Ve,[E(r("input",{"onUpdate:modelValue":e[1]||(e[1]=u=>n.notifyContacts=u),type:"checkbox",value:!0},null,512),[[J,n.notifyContacts]]),e[5]||(e[5]=r("div",null,"Send notification email to contacts",-1))])])]),_:1}),t.application.hasPendingSubmissionForCurrentStep?b("",!0):(a(),y(f,{key:0,variant:"warning"},{default:v(()=>e[6]||(e[6]=[w(" The expert panel has not yet submitted the application for approval. "),r("br",null,null,-1),w(' You can approve this application but be aware that it is not part of the "normal" application workflow. ')])),_:1})),p(K,{name:"slide-fade-down"},{default:v(()=>[E(p(S,{modelValue:n.email,"onUpdate:modelValue":e[2]||(e[2]=u=>n.email=u)},null,8,["modelValue"]),[[W,n.notifyContacts]])]),_:1}),p(_,null,{default:v(()=>[r("button",{class:"btn",onClick:e[3]||(e[3]=(...u)=>t.cancel&&t.cancel(...u))}," Cancel "),r("button",{class:"btn blue",onClick:e[4]||(e[4]=(...u)=>t.save&&t.save(...u))},[w(" Approve step "+g(t.application.current_step)+" ",1),n.notifyContacts?(a(),c("span",qe," and notify ")):b("",!0)])]),_:1})]),_:1})}const je=A(Me,[["render",Le]]),Pe=["disabled","title"],Oe={key:0,class:"text-red-600 text-sm mt-1"},Be={__name:"StepApproveControl",props:{group:{type:Object,required:!0},step:{type:Number,required:!0}},emits:["stepApproved"],setup(o,{emit:e}){const l=o,m=e,n=P(),t=T(!1),d=C(()=>l.step===Number.parseInt(l.group.expert_panel.current_step)),s=C(()=>f.value?"Cannot approve: Affiliation ID is missing":d.value?"Approve this step":"You can only approve the application's current step"),f=C(()=>{var x,U;if(l.step!==1)return!1;const u=(U=(x=l.group)==null?void 0:x.expert_panel)==null?void 0:U.affiliation_id;return!u||!u.toString().trim()}),S=()=>{if(f.value){alert("Cannot approve: Affiliation ID is missing.");return}t.value=!0},_=()=>{t.value=!1},h=()=>{_(),m("stepApproved")};return(u,x)=>{const U=i("modal-dialog");return a(),c("div",null,[r("button",O({disabled:!d.value||f.value,title:s.value,class:"btn btn-lg w-full"},k(n),{onClick:S}),[N(u.$slots,"default")],16,Pe),f.value&&l.step===1?(a(),c("p",Oe," This step cannot be approved until an Affiliation ID is provided. ")):b("",!0),(a(),y(B,{to:"body"},[p(U,{modelValue:t.value,"onUpdate:modelValue":x[0]||(x[0]=I=>t.value=I),size:"xl",onClosed:x[1]||(x[1]=I=>u.$refs.approvestepform.clearForm())},{default:v(()=>[p(je,{ref:"approvestepform",onSaved:h,onCanceled:_},null,512)]),_:1},8,["modelValue"])]))])}}},Ge={class:"comment-container"},He={class:"flex items-start space-x-2"},ze={class:"replies ml-1"},Ye={key:0,class:""},Je={__name:"ReviewCommentAnonymous",props:{comment:{type:Object,required:!0}},setup(o){const l=T(ie("App\\Models\\Comment",o.comment.id)),m=d=>{switch(d.type.name){case"required revision":return"yellow";case"suggestion":return"blue";case"internal comment":return"gray";default:return null}},n=T(!1),t=async()=>{n.value||await l.value.getComments(),n.value=!n.value};return(d,s)=>{const f=i("badge"),S=i("popper"),_=i("markdown-block"),h=i("ReviewCommentAnonymous",!0);return a(),c("div",null,[r("div",Ge,[r("div",He,[p(S,{content:d.titleCase(o.comment.type.name),hover:"",arrow:"",placement:"left"},{default:v(()=>[p(f,{class:"block",color:m(o.comment),size:"xxs"},{default:v(()=>[w(g(d.titleCase(o.comment.type.name.substr(0,1))),1)]),_:1},8,["color"])]),_:1},8,["content"]),r("div",null,[p(_,{markdown:o.comment.content,class:"text-sm"},null,8,["markdown"]),r("div",ze,[n.value?(a(),c("ul",Ye,[(a(!0),c(F,null,R(l.value.comments,u=>(a(),c("li",{key:u.id,class:"border-l-2 mt-2 px-2 py-1"},[p(h,{comment:u,"comment-manager":l.value,onDeleted:d.handleReplyRemoved},null,8,["comment","comment-manager","onDeleted"])]))),128))])):b("",!0),o.comment.comments_count>0?(a(),c("button",{key:1,class:"link text-sm",onClick:t},g(n.value?"Hide":"Show")+" "+g(o.comment.comments_count)+" "+g(o.comment.comments_count>1?"replies":"reply"),1)):b("",!0)])])])])])}}},Ke={class:"md:w-1/5 flex-shrink-0"},We={key:0},Qe={__name:"CommentSummary",props:{comments:{type:Array,required:!0}},setup(o){const e=o,l=C(()=>{const m={};return e.comments.forEach(n=>{const t=n.metadata.section||"general";m[n.metadata.section]||(m[t]=[]),m[t].push(n)}),m});return(m,n)=>(a(),c("div",null,[(a(!0),c(F,null,R(l.value,(t,d)=>(a(),c("div",{key:d,class:"md:flex md:space-x-4 mt-3 ml-2"},[r("h4",Ke,g(m.titleCase(d)),1),(a(!0),c(F,null,R(t,s=>(a(),y(Je,{key:s.id,comment:s,class:"mb-1 flex-grow-0"},null,8,["comment"]))),128)),t.length==0?(a(),c("div",We," No comments ")):b("",!0)]))),128))]))}},Xe={__name:"StepSendToChairsControl",props:{group:{type:Object,required:!0}},emits:["sentToChairs"],setup(o,{emit:e}){const l=o,m=e,n=P(),t=oe("commentManager"),d=T(),s=T(!1),f=()=>{t.value.getComments(),s.value=!0},S=async()=>{await M.post(`/api/groups/${l.group.uuid}/command`,{command:"app.modules.group.actions.applicationSendToChairs",additionalComments:d.value||null}),m("sentToChairs"),s.value=!1},_=()=>{s.value=!1};return(h,u)=>{const x=i("note"),U=i("input-row"),I=i("button-row"),X=i("modal-dialog");return a(),c("div",null,[r("button",O({class:"btn btn-lg w-full"},k(n),{onClick:f})," Send to Chairs for Review ",16),(a(),y(B,{to:"body"},[p(X,{modelValue:s.value,"onUpdate:modelValue":u[1]||(u[1]=q=>s.value=q),title:"Send to CDWG OC co-chairs for approval"},{footer:v(()=>[p(I,{"submit-text":"Send to Chairs",onSubmitted:S,onCanceled:_})]),default:v(()=>[u[3]||(u[3]=r("p",null,[w(" Sending the application to the chairs for approval will send a message to the "),r("em",null,"cdwgoc_approvals"),w(" with a PDF of the application and the Core Group comments shown below. ")],-1)),u[4]||(u[4]=r("h3",null,"Comments from the Core Group",-1)),p(Qe,{comments:k(t).openComments},null,8,["comments"]),p(U,{modelValue:d.value,"onUpdate:modelValue":u[0]||(u[0]=q=>d.value=q),vertical:"",type:"large-text",label:"Additional notes for chairs","label-class":"font-bold"},{"after-input":v(()=>[p(x,null,{default:v(()=>u[2]||(u[2]=[w("This is not intended for additional comments about the applicaiton. This is intended for notes about process, timeing, etc. To add comments related to the content of the application click 'Cancel' and add notes alongside the application.")])),_:1})]),_:1},8,["modelValue"])]),_:1},8,["modelValue"])]))])}}},Ze={components:{UserDefinedMailForm:Y},emits:["canceled","saved"],data(){return{notifyContacts:!0,email:{subject:"",body:"",cc:[],to:[],files:[]},errors:{}}},computed:{...$({group:"groups/currentItemOrNew"}),application(){return this.group.expert_panel},submissionText(){return`Request Revisions${this.notifyContacts?" and notify":""}`}},watch:{notifyContacts:{immediate:!0,handler(o){o&&this.getEmailTemplate()}}},mounted(){},methods:{clearForm(){this.dateApproved=null,this.notifyContacts=!0},cancel(){this.clearForm(),this.$emit("canceled")},async save(){try{const o={notify_contacts:this.notifyContacts,subject:this.email.subject,body:this.email.body,attachments:this.email.files},e=`/api/groups/${this.group.uuid}/application/submission/${this.group.expert_panel.pendingSubmission.id}/rejection`;await M.post(e,o).then(l=>l.data),this.clearForm(),this.$emit("saved")}catch(o){if(j(o)){this.errors=o.response.data.errors;return}throw o}},getEmailTemplate(){M.get(`/api/email-drafts/groups/${this.group.uuid}`,{params:{templateClass:"App\\Mail\\UserDefinedMailTemplates\\ApplicationRevisionRequestTemplate"}}).then(o=>{this.email=o.data,this.email.files=[]})}}},et={class:"text-sm"};function tt(o,e,l,m,n,t){const d=i("dictionary-row"),s=i("static-alert"),f=i("UserDefinedMailForm"),S=i("button-row"),_=i("form-container");return a(),y(_,null,{default:v(()=>[p(d,{label:""},{default:v(()=>[r("div",null,[r("label",et,[E(r("input",{"onUpdate:modelValue":e[0]||(e[0]=h=>n.notifyContacts=h),type:"checkbox",value:!0},null,512),[[J,n.notifyContacts]]),e[2]||(e[2]=r("div",null,"Send notification email to contacts",-1))])])]),_:1}),t.application.hasPendingSubmissionForCurrentStep?b("",!0):(a(),y(s,{key:0,variant:"warning"},{default:v(()=>e[3]||(e[3]=[w(" The expert panel has not yet submitted the application for approval. "),r("br",null,null,-1),w(' You can approve this application but be aware that it is not part of the "normal" application workflow. ')])),_:1})),p(K,{name:"slide-fade-down"},{default:v(()=>[E(p(f,{modelValue:n.email,"onUpdate:modelValue":e[1]||(e[1]=h=>n.email=h)},null,8,["modelValue"]),[[W,n.notifyContacts]])]),_:1}),p(S,{"submit-text":t.submissionText,onCanceled:t.cancel,onSubmitted:t.save},null,8,["submit-text","onCanceled","onSubmitted"])]),_:1})}const ot=A(Ze,[["render",tt]]),nt={__name:"StepRequestRevisionsControl",props:{group:{type:Object,required:!0}},emits:["revisionsRequested"],setup(o,{emit:e}){const l=e,m=P(),n=T(null),t=T(!1),d=()=>{t.value=!0,n.value.getEmailTemplate()},s=()=>{t.value=!1},f=()=>{s(),l("revisionsRequested")};return(S,_)=>{const h=i("modal-dialog");return a(),c("div",null,[o.group.expert_panel.hasPendingSubmissionForCurrentStep?(a(),c("button",O({key:0,class:"btn btn-lg w-full"},k(m),{onClick:d})," Request revisions ",16)):b("",!0),(a(),y(B,{to:"body"},[p(h,{modelValue:t.value,"onUpdate:modelValue":_[0]||(_[0]=u=>t.value=u),title:"Request Revisions to Application",size:"xl",onClosed:_[1]||(_[1]=u=>S.$refs.rejectsubmissionform.clearForm())},{default:v(()=>[p(ot,{ref_key:"rejectsubmissionform",ref:n,onSaved:f,onCanceled:s},null,512)]),_:1},8,["modelValue"])]))])}}},st={class:"border-t border-b py-4 mb-6"},at={class:"flex w-full space-x-4"},rt={__name:"StepControls",props:{step:{type:Number,required:!0},approveLabel:{type:String,required:!1,default:"Approve"}},emits:["updated","stepApproved","sentToChairs","revisionsRequested"],setup(o,{emit:e}){const l=o,m=e,n=z(),t=C(()=>n.getters["groups/currentItemOrNew"]),d=C(()=>{if(!t.value)return!1;const s=t.value.expert_panel.latestPendingSubmissionForStep(l.step);return s&&Number.parseInt(s.submission_status_id)===1});return(s,f)=>(a(),c("div",st,[p(Ne,{class:"mb-4",group:t.value,step:o.step},null,8,["group","step"]),r("div",at,[p(Be,{class:"flex-1",group:t.value,step:o.step,onStepApproved:f[0]||(f[0]=()=>{m("stepApproved"),m("updated")})},{default:v(()=>[w(g(o.approveLabel),1)]),_:1},8,["group","step"]),d.value?(a(),y(Xe,{key:0,class:"flex-1",group:t.value,onSentToChairs:f[1]||(f[1]=()=>{m("sentToChairs"),m("updated")})},null,8,["group"])):b("",!0),t.value.expert_panel.hasPendingSubmissionForCurrentStep?(a(),y(nt,{key:1,class:"flex-1",group:t.value,onRevisionsRequested:f[2]||(f[2]=()=>{m("revisionsRequested"),m("updated")})},null,8,["group"])):b("",!0)])]))}},it={components:{ApplicationLog:fe,StepControls:rt,RemoveButton:ne},props:{title:{type:String,required:!1,default:"YOU SHOULD SET A TITLE"},step:{type:Number,required:!0},documentName:{type:String,required:!1,default:`Set a document-type attribute if you don't use the "document" slot`},documentType:{type:Number,required:!1,default:1},documentGetsReviewed:{type:Boolean,required:!1,default:!0},approveButtonLabel:{type:String,required:!1,default:'Set "approve-button-label" if not overriding slot "approve-button"'}},emits:["documentUploaded","approved","updated"],data(){return{showApproveForm:!1,editApprovalDate:!1,newApprovalDate:null,showRejectForm:!1}},computed:{...$({group:"groups/currentItemOrNew"}),application(){return this.group.expert_panel},isCurrentStep(){return Number.parseInt(this.step)===Number.parseInt(this.application.current_step)},dateApproved(){return this.application.approvalDateForStep(this.step)?D(this.application.approvalDateForStep(this.step)):null}},methods:{goToPrintable(){window.open(`/groups/${this.group.uuid}/application/review`)},handleUpdated(){this.$emit("updated")},initEditApprovalDate(){this.editApprovalDate=!0,this.newApprovalDate=this.dateApproved},async updateApprovalDate(){try{await this.$store.dispatch("groups/updateApprovalDate",{group:this.group,dateApproved:this.newApprovalDate,step:this.step}),this.editApprovalDate=!1}catch(o){j(o)&&(this.errors=o.response.data.errors)}}}},pt={class:"overflow-x-auto"},lt={class:"mb-6"},ut={class:"flex justify-between text-lg font-bold pb-2 mb-2 border-b"},dt={class:"flex space-x-2"},ct={key:0},mt={key:0,class:"flex space-x-1"},vt={class:"text-white bg-green-600 rounded-xl px-2"},ft={key:1,class:"flex space-x-1"},_t={class:"screen-block-container"},bt={class:"mb-6 mt-4 border-t pt-4"},ht={class:"mb-2"};function gt(o,e,l,m,n,t){const d=i("StepControls"),s=i("edit-icon-button"),f=i("date-input"),S=i("RemoveButton"),_=i("ApplicationLog");return a(),c("div",pt,[r("div",lt,[t.application.stepIsApproved(l.step)?b("",!0):(a(),y(d,{key:0,step:l.step,onUpdated:t.handleUpdated},null,8,["step","onUpdated"])),r("div",ut,[r("div",dt,[r("h2",null,g(l.title),1),t.dateApproved?(a(),c("div",ct,[n.editApprovalDate?(a(),c("div",ft,[p(f,{modelValue:n.newApprovalDate,"onUpdate:modelValue":e[0]||(e[0]=h=>n.newApprovalDate=h)},null,8,["modelValue"]),r("button",{class:"btn blue",onClick:e[1]||(e[1]=(...h)=>t.updateApprovalDate&&t.updateApprovalDate(...h))}," Save "),p(S,{onClick:e[2]||(e[2]=h=>n.editApprovalDate=!1)})])):(a(),c("div",mt,[r("div",vt," Approved: "+g(t.dateApproved),1),p(s,{class:"text-black",onClick:t.initEditApprovalDate},null,8,["onClick"])]))])):b("",!0)]),r("div",null,[r("button",{class:"btn btn-xs",onClick:e[3]||(e[3]=(...h)=>t.goToPrintable&&t.goToPrintable(...h))}," Printable Application ")])]),r("div",_t,[N(o.$slots,"sections",{},()=>[e[4]||(e[4]=w(" Step sections here! "))])])]),r("div",null,[N(o.$slots,"default")]),N(o.$slots,"log",{},()=>[r("div",bt,[r("h3",ht," Step "+g(l.step)+" Progress Log ",1),p(_,{step:l.step},null,8,["step"])])])])}const V=A(it,[["render",gt]]),yt={name:"StepOne",components:{BaseStep:V,DefinitionReview:pe},emits:["approved","updated"],data(){return{}},computed:{...$({group:"groups/currentItemOrNew"}),application(){return this.group.expert_panel}},methods:{}},St={class:"application-review"};function wt(o,e,l,m,n,t){const d=i("DefinitionReview"),s=i("BaseStep");return a(),c("div",St,[p(s,{step:1,"document-name":"Scope and Membership Application",title:"Scope and Membership","document-type":1,"document-gets-reviewed":!0,"approve-button-label":"Approve Scope and Membership",onUpdated:e[0]||(e[0]=f=>o.$emit("updated"))},{sections:v(()=>[p(d)]),_:1})])}const Ct=A(yt,[["render",wt]]),At={name:"StepTwo",components:{BaseStep:V,SpecificationsSection:Q},props:{},emits:["approved","updated"],data(){return{}},computed:{...$({group:"groups/currentItemOrNew"}),application(){return this.group.expert_panel}},methods:{}},xt={class:"application-section screen-block"};function kt(o,e,l,m,n,t){const d=i("SpecificationsSection"),s=i("BaseStep");return a(),y(s,{step:2,"document-type":2,"document-name":"Draft Specifications","document-gets-reviewed":!1,"approve-button-label":"Approve Draft Specifications",title:"Draft ACMG Guideline Specifications",onUpdated:e[0]||(e[0]=f=>o.$emit("updated"))},{sections:v(()=>[r("div",xt,[e[1]||(e[1]=r("h2",null,"Draft Specifications",-1)),p(d,{"doc-type-id":2})])]),_:1})}const $t=A(At,[["render",kt]]),Dt={name:"StepThree",components:{BaseStep:V,SpecificationsSection:Q},props:{},emits:["approved","updated"],data(){return{}},computed:{...$({group:"groups/currentItemOrNew"}),application(){return this.group.expert_panel}},methods:{formatDate(o){return D(o)}}},Tt={class:"application-section screen-block"};function Ut(o,e,l,m,n,t){const d=i("SpecificationsSection"),s=i("BaseStep");return a(),y(s,{step:3,"approve-button-label":"Approve Pilot and Specifications",title:"Pilot ACMG Guideline Specificiations",onUpdated:e[0]||(e[0]=f=>o.$emit("updated"))},{sections:v(()=>[r("div",Tt,[e[1]||(e[1]=r("h2",null,"Pilot Specifications",-1)),p(d,{"doc-type-id":[3,4,7]})])]),_:1})}const Ft=A(Dt,[["render",Ut]]),Rt={name:"StepFour",components:{BaseStep:V,SustainedCurationReview:le},props:{},emits:["approved","updated"],data(){return{}},computed:{...$({group:"groups/currentItemOrNew"}),application(){return this.group.expert_panel}},methods:{}};function It(o,e,l,m,n,t){const d=i("SustainedCurationReview"),s=i("BaseStep");return a(),y(s,{step:4,"document-type":5,"document-name":"Sustained Curation","document-gets-reviewed":!0,"approve-button-label":"Approve Sustained Curation",title:"Sustained Curation",onUpdated:e[0]||(e[0]=f=>o.$emit("updated"))},{sections:v(()=>[p(d)]),_:1})}const Nt=A(Rt,[["render",It]]),Et={components:{StepOne:Ct,StepTwo:$t,StepThree:Ft,StepFour:Nt},emits:["approved","updated"],data(){return{activeStep:1}},computed:{...$({group:"groups/currentItemOrNew"}),application(){return this.group.expert_panel},activeIndex:{deep:!0,get(){return this.application&&this.application.current_step?this.application.current_step-1:0},set(o){this.activeStep=o+1}}},methods:{handleApproved(){this.$emit("approved"),this.$emit("updated")},handleUpdated(){this.$emit("updated")}}},Mt={key:0};function Vt(o,e,l,m,n,t){const d=i("StepOne"),s=i("tab-item"),f=i("StepTwo"),S=i("StepThree"),_=i("StepFour"),h=i("tabs-container");return a(),c("div",null,[t.application.is_gcep?(a(),c("div",Mt,[p(d,{onStepApproved:t.handleApproved,onUpdated:t.handleUpdated},null,8,["onStepApproved","onUpdated"])])):b("",!0),t.application.expert_panel_type_id==2?(a(),y(h,{key:1,modelValue:t.activeIndex,"onUpdate:modelValue":e[0]||(e[0]=u=>t.activeIndex=u),"tab-location":"right"},{default:v(()=>[p(s,{label:"Group Definition"},{default:v(()=>[p(d,{onStepApproved:t.handleApproved,onUpdated:t.handleUpdated},null,8,["onStepApproved","onUpdated"])]),_:1}),p(s,{label:"Draft Specifications"},{default:v(()=>[p(f,{onStepApproved:t.handleApproved,onUpdated:t.handleUpdated},null,8,["onStepApproved","onUpdated"])]),_:1}),p(s,{label:"Pilot Specfications"},{default:v(()=>[p(S,{onStepApproved:t.handleApproved,onUpdated:t.handleUpdated},null,8,["onStepApproved","onUpdated"])]),_:1}),p(s,{label:"Sustained Curation"},{default:v(()=>[p(_,{onStepApproved:t.handleApproved,onUpdated:t.handleUpdated},null,8,["onStepApproved","onUpdated"])]),_:1})]),_:1},8,["modelValue"])):b("",!0)])}const Ht=A(Et,[["render",Vt]]);export{fe as A,Gt as P,Ht as S,Qe as _};
//# sourceMappingURL=StepTabs-DXCEt84I.js.map
