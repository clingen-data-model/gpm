import{_ as x,aO as le,aP as ue,c as p,h as c,d as s,i as h,j as y,F as U,m as E,e as _,w as a,a as u,b as n,n as N,f as i,an as de,aQ as pe,aR as ce,G as W,a0 as me,aS as z,a2 as T,C as G,Z as V,D as L,p as Y,$ as ge,a9 as fe,a1 as J,ah as B,k as _e,r as he,q as I,v as be,x as ve,o as ye}from"./app-eoV-TaIc.js";import{l as we,f as De}from"./log_entry_repository-FlNEmHb9.js";import{A as ke}from"./ActivityLog-Dipq_OGX.js";import{V as j,S as Se,M as Ce,G as q,A as xe,a as Ae,b as Fe}from"./VcepGeneList-BolAl4_H.js";import{S as Ue}from"./SpecificationsSection-Dqhe-9nl.js";import{E as Ee}from"./EvidenceSummaryList-DeWJk5cO.js";import{M as Ge,G as O}from"./MemberList-B9nWJp_C.js";import{G as Ie}from"./GroupForm-CKNWR_Rw.js";import{V as H}from"./VcepOngoingPlansForm-D7G6zl2-.js";import{S as Me,A as Pe}from"./SustainedCurationReviewAlert-BWBRwKHY.js";import{P as Te,S as Ve}from"./StepTabs--7V67bYs.js";import"./router_aware_sort_and_filter-BLPS2QB7.js";import"./CoiDetail-CIjZbu5e.js";import"./ExpertisesView-DrWE2qEw.js";import"./LogEntryForm-BfRrEY1g.js";import"./judgement_utils-CQeBr_sj.js";import"./SustainedCurationReview-BHIGe09r.js";const Le={name:"ApplicationSummary",components:{RequirementsBadge:le},props:{group:{required:!0,type:Object}},data(){return{}},computed:{applicationStarted(){return!0},application(){return ue(this.group)},currentStep(){return this.group.expert_panel.current_step},applicationRoute(){return{name:"GroupApplication",params:{uuid:this.group.uuid},hash:`#${this.currentMenuItem.id}`}},currentMenuItem(){return this.application.getStep(this.group.expert_panel.current_step)},menu(){return this.application.steps.length>1?this.application.steps:this.application.steps[0].sections}},methods:{isStep(t){return!!t.sections},isCurrentStep(t){return!!(this.isStep(t)&&this.application.getStep(this.group.expert_panel.current_step)===t)}}},Re={key:0,class:"p-4 my-4 mb-8 border rounded-xl bg-white"},Ne={class:"mb-2"},Be={key:0},je={class:"px-8"},qe={key:2},Oe={key:0,class:"flex-1"},He={key:0,class:"mt-4"};function We(t,e,d,o,l,r){const D=u("RequirementsBadge"),k=u("icon-lock"),w=u("badge"),b=u("router-link");return d.group.is_ep?(n(),p("div",Re,[s("h2",Ne,[e[0]||(e[0]=h(" Application Summary ")),r.applicationStarted&&d.group.is_vcep_or_scvcep?(n(),p("span",Be," - "+y(r.currentMenuItem.title),1)):c("",!0)]),s("ul",je,[(n(!0),p(U,null,E(r.menu,(f,C)=>(n(),p("li",{key:C,class:"py-1 flex justify-between border-b border-gray-300 my-2"},[s("div",{class:N(["flex justify-between",{"w-full":!r.isStep(f)}])},[s("div",{class:N(["w-56 text-lg",{"text-gray-400":r.isStep(f)&&f.isDisabled(d.group)}])},y(f.title),3),s("div",null,[r.isStep(f)?c("",!0):(n(),_(D,{key:0,section:f},null,8,["section"])),r.isStep(f)&&f.isDisabled(d.group)?(n(),_(k,{key:1,class:"inline text-gray-400",height:14,width:14})):c("",!0),r.isStep(f)&&f.isComplete(d.group)?(n(),p("div",qe,[i(w,{color:"green"},{default:a(()=>e[1]||(e[1]=[h(" Approved ")])),_:1})])):c("",!0)])],2),r.isCurrentStep(f)?(n(),p("div",Oe,[s("ul",null,[(n(!0),p(U,null,E(f.sections,(S,v)=>(n(),p("li",{key:v,class:"pb-2 flex justify-between my-2"},[s("div",null,y(S.title),1),i(D,{section:S},null,8,["section"])]))),128))])])):c("",!0)]))),128))]),t.hasAnyPermission(["ep-applications-manage",["application-edit",d.group]])?(n(),p("div",He,[d.group.uuid?(n(),_(b,{key:0,to:r.applicationRoute},{default:a(()=>e[2]||(e[2]=[s("button",{class:"btn blue btn-lg"}," Go to application ",-1)])),_:1},8,["to"])):c("",!0)])):c("",!0)])):c("",!0)}const ze=x(Le,[["render",We]]),Ye={name:"GroupDescriptionForm",components:{EditIconButton:pe,RichTextEditor:de},props:{editing:{type:Boolean,required:!1,default:!0},errors:{type:Object,required:!1,default:()=>({})}},emits:["update:editing","update:group","update"],computed:{group:{get(){return this.$store.getters["groups/currentItem"]||new W},set(t){this.$store.commit("groups/addItem",t)}},sanitizedDescription(){return ce.sanitize(this.group.description)}}},Je={class:"flex justify-between items-center"},Qe={class:"mt-2"},Ze={key:0,class:"mt-2"},Ke={key:1,class:"border-2 mt-8 p-2"},Xe=["innerHTML"];function $e(t,e,d,o,l,r){const D=u("EditIconButton"),k=u("RichTextEditor");return n(),p("div",null,[s("header",Je,[e[4]||(e[4]=s("h4",null,"Website Summary Description of Group",-1)),t.hasAnyPermission(["groups-manage",["application-edit",r.group]])&&!d.editing?(n(),_(D,{key:0,onClick:e[0]||(e[0]=w=>t.$emit("update:editing",!0))})):c("",!0)]),s("div",Qe,[e[5]||(e[5]=s("p",{class:"text-sm"}," This is a description of the group's purpose, goals, and objectives as intended for public display (e.g., at the clinicalgenome.org site). This may be more concise than the full scope of work. ",-1)),i(me,{name:"fade",mode:"out-in"},{default:a(()=>[d.editing?(n(),p("div",Ze,[i(k,{modelValue:r.group.description,"onUpdate:modelValue":[e[1]||(e[1]=w=>r.group.description=w),e[2]||(e[2]=w=>t.$emit("update"))]},null,8,["modelValue"])])):(n(),p("div",Ke,[r.group.description?(n(),p("div",{key:0,innerHTML:r.sanitizedDescription},null,8,Xe)):(n(),p("p",{key:1,class:"well cursor-pointer",onClick:e[3]||(e[3]=(...w)=>t.showForm&&t.showForm(...w))}," A website summary description has not yet been provided. "))]))]),_:1})])])}const et=x(Ye,[["render",$e]]),tt={name:"GroupDetailHeader",props:{group:{type:W,required:!0}},emits:["showEdit"],computed:{showShortName(){return this.group.expert_panel.short_base_name!==this.group.expert_panel.long_base_name}}},ot={class:"flex justify-between items-start"},nt={class:"text-sm text-gray-800 mt-1 font-normal"},rt={key:0},st={key:1},it={key:2},at={key:0},lt={key:0},ut={key:1,class:"text-gray-500"},dt={key:0},pt={key:1,class:"text-gray-500"};function ct(t,e,d,o,l,r){const D=u("group-breadcrumbs"),k=u("badge"),w=u("router-link"),b=u("note"),f=u("dictionary-row");return n(),p("header",null,[i(D),s("h1",ot,[s("div",null,[h(y(d.group.displayName)+" ",1),i(k,{color:d.group.statusColor,class:"text-xs"},{default:a(()=>[h(y(d.group.status?d.group.status.name:"loading..."),1)]),_:1},8,["color"]),s("div",nt,[d.group.isEp()&&r.showShortName?(n(),p("span",rt,[e[1]||(e[1]=h("Short Name: ")),s("strong",null,y(d.group.expert_panel.full_short_base_name||"--"),1),e[2]||(e[2]=h(" | "))])):c("",!0),d.group.isEp()?(n(),p("span",st,[e[3]||(e[3]=h(" Affiliation ID: ")),s("strong",null,y(d.group.expert_panel.affiliation_id||"--"),1)])):c("",!0),d.group.parent_id?(n(),p("span",it,[e[4]||(e[4]=h(" | Part of the ")),i(w,{to:{name:"GroupDetail",params:{uuid:d.group.parent.uuid}}},{default:a(()=>[h(y(d.group.parent.name),1)]),_:1},8,["to"])])):c("",!0)]),t.hasRole("super-user")?(n(),_(b,{key:0,class:"font-normal mt-2"},{default:a(()=>[h(" group.id: "+y(d.group.id)+" ",1),d.group.is_ep?(n(),p("span",at," | expertPanel.id: "+y(d.group.expert_panel.id),1)):c("",!0)]),_:1})):c("",!0)]),t.hasAnyPermission(["groups-manage",["info-edit",d.group]])?(n(),p("button",{key:0,class:"btn btn-xs",onClick:e[0]||(e[0]=C=>t.$emit("showEdit"))}," Edit Group Info ")):c("",!0)]),i(f,{label:"Chairs:"},{label:a(()=>e[5]||(e[5]=[s("strong",null,"Chairs:",-1)])),default:a(()=>[d.group.chairs.length>0?(n(),p("div",lt,y(d.group.chairs.map(C=>C.person.name).join(", ")),1)):(n(),p("div",ut," None assigned "))]),_:1}),i(f,{label:"Coordinators:"},{label:a(()=>e[6]||(e[6]=[s("strong",null,"Coordinators:",-1)])),default:a(()=>[d.group.coordinators.length>0?(n(),p("div",dt,y(d.group.coordinators.map(C=>C.person.name).join(", ")),1)):(n(),p("div",pt," None assigned "))]),_:1})])}const mt=x(tt,[["render",ct]]),gt={props:{saveFunction:{type:Function,required:!0}},emits:["saved","canceled"],data(){return{newDocument:{file:null,document_type_id:this.documentTypeId,notes:null},errors:{}}},computed:{...z({documentTypes:t=>t.doctypes.items}),group(){return this.$store.getters["groups/currentItemOrNew"]},application(){return this.group.expert_panel},isReviewed(){return!!this.newDocument.date_reviewed},documentType(){return this.documentTypes.length===0?{}:this.$store.getters["doctypes/getItemById"](this.documentTypeId)}},mounted(){this.$store.dispatch("doctypes/getItems")},methods:{async save(){try{const t=new FormData;Object.keys(this.newDocument).forEach(e=>{const d=this.newDocument[e];d!=null&&t.append(e,d)}),t.append("file",this.$refs.fileInput.files[0]),await this.saveFunction(t),this.clearForm(),this.$emit("saved")}catch(t){T(t)&&(this.errors=t.response.data.errors)}},cancel(){this.clearForm(),this.$emit("canceled")},clearForm(){this.initNewDocument(),this.clearErrors()},initNewDocument(){this.$refs.fileInput.value=null,this.newDocument={file:null,document_type_id:this.documentTypeId,notes:null}},clearErrors(){this.errors={}}}},ft={ref:"fileInput",type:"file"},_t=["value"];function ht(t,e,d,o,l,r){const D=u("input-row"),k=u("button-row"),w=u("form-container");return n(),_(w,null,{default:a(()=>[i(D,{label:"Document",errors:l.errors.file},{default:a(()=>[s("input",ft,null,512)]),_:1},8,["errors"]),i(D,{label:"Type",errors:l.errors.document_type_id},{default:a(()=>[G(s("select",{"onUpdate:modelValue":e[0]||(e[0]=b=>l.newDocument.document_type_id=b)},[e[4]||(e[4]=s("option",{value:null}," Select... ",-1)),(n(!0),p(U,null,E(t.documentTypes,b=>(n(),p("option",{key:b.id,value:b.id},y(b.long_name),9,_t))),128))],512),[[V,l.newDocument.document_type_id]])]),_:1},8,["errors"]),i(D,{errors:l.errors.notes,label:"Notes"},{default:a(()=>[G(s("textarea",{"onUpdate:modelValue":e[1]||(e[1]=b=>l.newDocument.notes=b),name:"notes",cols:"30",rows:"10"},null,512),[[L,l.newDocument.notes]])]),_:1},8,["errors"]),i(k,null,{default:a(()=>[s("button",{class:"btn white",onClick:e[2]||(e[2]=(...b)=>r.cancel&&r.cancel(...b))}," Cancel "),s("button",{class:"btn blue",onClick:e[3]||(e[3]=(...b)=>r.save&&r.save(...b))}," Save ")]),_:1})]),_:1})}const bt=x(gt,[["render",ht]]),vt={name:"DocumentEditForm",props:{document:{required:!0,type:Object},saveFunction:{required:!0,type:Function}},emits:["saved","canceled"],data(){return{docProxy:{},errors:{}}},computed:{...z({documentTypes:t=>t.doctypes.items})},watch:{document:{immediate:!0,handler(){this.docProxy=JSON.parse(JSON.stringify(this.document))}}},mounted(){this.$store.dispatch("doctypes/getItems")},methods:{cancel(){this.docProxy={},this.$emit("canceled")},async save(){try{this.saveFunction(this.docProxy),this.$emit("saved")}catch(t){throw T(t)&&(this.errors=t.response.data.errors),t}}}},yt=["value"];function wt(t,e,d,o,l,r){const D=u("dictionary-row"),k=u("input-row"),w=u("button-row"),b=u("form-container");return n(),_(b,null,{default:a(()=>[i(D,{label:"File"},{default:a(()=>[h(y(d.document.filename),1)]),_:1}),i(k,{label:"Type",errors:l.errors.document_type_id},{default:a(()=>[G(s("select",{"onUpdate:modelValue":e[0]||(e[0]=f=>l.docProxy.document_type_id=f)},[(n(!0),p(U,null,E(t.documentTypes,f=>(n(),p("option",{key:f.id,value:f.id},y(f.long_name),9,yt))),128))],512),[[V,l.docProxy.document_type_id]])]),_:1},8,["errors"]),i(k,{errors:l.errors.notes,label:"Notes"},{default:a(()=>[G(s("textarea",{"onUpdate:modelValue":e[1]||(e[1]=f=>l.docProxy.notes=f),name:"notes",cols:"30",rows:"10"},null,512),[[L,l.docProxy.notes]])]),_:1},8,["errors"]),i(w,null,{default:a(()=>[s("button",{class:"btn",onClick:e[2]||(e[2]=(...f)=>r.cancel&&r.cancel(...f))}," Cancel "),s("button",{class:"btn blue",onClick:e[3]||(e[3]=(...f)=>r.save&&r.save(...f))}," Save ")]),_:1})]),_:1})}const Dt=x(vt,[["render",wt]]),kt={name:"DocumentList",components:{DocumentUploadForm:bt,DocumentEditForm:Dt},props:{documents:{type:Array,required:!0},documentCreator:{type:Function,required:!1},documentUpdater:{type:Function,required:!1},documentDeleter:{type:Function,required:!1},canManage:{type:Boolean,default:!1}},emits:["updated"],data(){return{fields:[{name:"cheveron",label:"",sortable:!1},{name:"filename",label:"File",type:String,sortable:!0},{name:"type.long_name",label:"Type",type:String,sortable:!0},{name:"notes",type:String,sortable:!0},{name:"actions",label:"",type:String,sortable:!1}],sort:{field:"filename",desc:!1},keyword:null,filterType:null,documentTypes:[],activeDocument:{type:{}},showDeleteConfirmation:!1,showEditForm:!1,showUploadForm:!1}},computed:{filteredDocuments(){let t=[...this.documents];if(this.keyword){const e=new RegExp(`.*${this.keyword}.*`,"i");t=t.filter(d=>d.filename.match(e)||d.notes&&d.notes.match(e)||d.type.name.match(e))}return this.filterType&&(t=t.filter(e=>e.document_type_id===this.filterType)),t}},mounted(){Y.get("/api/document-types").then(t=>this.documentTypes=t.data)},methods:{toggleItemDetails(t){t.showDetails=!t.showDetails},initDownload(t){window.location=t.download_url},initUpdate(t){this.showEditForm=!0,this.activeDocument=t},commitUpdate(t){this.documentUpdater?this.documentUpdater(t):alert("we need a default document upload function"),this.$emit("updated"),this.showUploadForm=!1},initDelete(t){this.activeDocument=t,this.showDeleteConfirmation=!0},cancelDelete(){this.showDeleteConfirmation=!1,this.resetActiveDocument()},async commitDelete(){this.documentDeleter?this.documentDeleter(this.activeDocument):alert("we need to add a default document deleter."),this.showDeleteConfirmation=!1,this.resetActiveDocument(),this.$emit("updated")},initUpload(){this.showUploadForm=!0},commitCreate(t){this.documentCreator?this.documentCreator(t):alert("we need a default document upload function"),this.$emit("updated"),this.showUploadForm=!1},resetActiveDocument(){this.activeDocument={type:{}}}}},St={class:"flex justify-between py-2"},Ct={class:"flex space-x-2"},xt=["value"],At=["onClick"],Ft={class:"note"},Ut={key:0},Et={key:1},Gt={class:"px-4 pb-4 border"},It={key:0,class:"flex space-x-2 pt-2 border-t"},Mt=["onClick"],Pt=["onClick"],Tt=["onClick"],Vt={key:0},Lt={key:0,class:"mb-3"};function Rt(t,e,d,o,l,r){const D=u("icon-cheveron-right"),k=u("icon-cheveron-down"),w=u("dropdown-item"),b=u("dropdown-menu"),f=u("object-dictionary"),C=u("data-table"),S=u("DocumentEditForm"),v=u("modal-dialog"),F=u("DocumentUploadForm"),M=u("button-row");return n(),p("div",null,[ge(t.$slots,"heading",{},()=>[s("div",St,[s("div",Ct,[s("label",null,[e[9]||(e[9]=h(" Search: ")),G(s("input",{"onUpdate:modelValue":e[0]||(e[0]=m=>l.keyword=m),type:"text",placeholder:"Filter",class:"sm"},null,512),[[L,l.keyword]])]),s("label",null,[e[11]||(e[11]=h(" Type:   ")),G(s("select",{"onUpdate:modelValue":e[1]||(e[1]=m=>l.filterType=m)},[e[10]||(e[10]=s("option",{value:null},"Any",-1)),(n(!0),p(U,null,E(l.documentTypes,m=>(n(),p("option",{key:m.id,value:m.id},y(m.long_name),9,xt))),128))],512),[[V,l.filterType]])])]),d.canManage?(n(),p("button",{key:0,class:"btn btn-xs",onClick:e[2]||(e[2]=(...m)=>r.initUpload&&r.initUpload(...m))}," Upload ")):c("",!0)])]),i(C,{sort:l.sort,"onUpdate:sort":e[3]||(e[3]=m=>l.sort=m),fields:l.fields,data:r.filteredDocuments,"detail-rows":!0},{"cell-cheveron":a(({item:m})=>[m.metadata?(n(),p("button",{key:0,class:"w-9 align-center block -mx-3",onClick:fe(A=>r.toggleItemDetails(m),["stop"])},[m.showDetails?c("",!0):(n(),_(D,{key:0,class:"m-auto cursor-pointer"})),m.showDetails?(n(),_(k,{key:1,class:"m-auto cursor-pointer"})):c("",!0)],8,At)):c("",!0)]),"cell-filename":a(({item:m})=>[h(y(m.filename)+" ",1),s("span",Ft,[m.type.is_versioned&&m.version?(n(),p("em",Ut,"(version "+y(m.version)+")",1)):c("",!0),m.is_final?(n(),p("em",Et," FINAL")):c("",!0)])]),"cell-actions":a(({item:m})=>[i(b,{"hide-cheveron":""},{label:a(()=>e[12]||(e[12]=[s("button",{class:"btn btn-xs"}," … ",-1)])),default:a(()=>[i(w,{onClick:A=>r.initDownload(m)},{default:a(()=>e[13]||(e[13]=[h(" Download ")])),_:2},1032,["onClick"]),d.canManage?(n(),_(w,{key:0,onClick:A=>r.initUpdate(m)},{default:a(()=>e[14]||(e[14]=[h(" Update ")])),_:2},1032,["onClick"])):c("",!0),d.canManage?(n(),_(w,{key:1,onClick:A=>r.initDelete(m)},{default:a(()=>e[15]||(e[15]=[h(" Delete ")])),_:2},1032,["onClick"])):c("",!0)]),_:2},1024)]),detail:a(({item:m})=>[s("div",Gt,[i(f,{obj:m.metadata},null,8,["obj"]),d.canManage?(n(),p("div",It,[s("button",{class:"btn btn-xs",onClick:A=>r.initDownload(m)}," Download ",8,Mt),s("button",{class:"btn btn-xs",onClick:A=>r.initUpdate(m)}," Update ",8,Pt),s("button",{class:"btn btn-xs red",onClick:A=>r.initDelete(m)}," Delete ",8,Tt)])):c("",!0)])]),_:1},8,["sort","fields","data"]),(n(),_(J,{to:"body"},[i(v,{modelValue:l.showEditForm,"onUpdate:modelValue":e[5]||(e[5]=m=>l.showEditForm=m),title:`Update ${l.activeDocument.filename}`},{default:a(()=>[i(S,{document:l.activeDocument,"save-function":r.commitUpdate,onSaved:e[4]||(e[4]=m=>t.$emit("updated"))},null,8,["document","save-function"])]),_:1},8,["modelValue","title"]),i(v,{modelValue:l.showUploadForm,"onUpdate:modelValue":e[7]||(e[7]=m=>l.showUploadForm=m),title:"Upload a new document"},{default:a(()=>[i(F,{"save-function":r.commitCreate,onSaved:e[6]||(e[6]=m=>t.$emit("updated"))},null,8,["save-function"])]),_:1},8,["modelValue"]),i(v,{modelValue:l.showDeleteConfirmation,"onUpdate:modelValue":e[8]||(e[8]=m=>l.showDeleteConfirmation=m),title:`You are about to delete ${l.activeDocument.filename}`},{default:a(()=>[l.activeDocument?(n(),p("div",Vt,[l.activeDocument.is_final?(n(),p("p",Lt," This version has been tagged as the final version of the document. ")):c("",!0),e[16]||(e[16]=s("p",null,"Are you sure you want to continue?",-1)),i(M,{"submit-text":"Delete Document",onCanceled:r.cancelDelete,onSubmitted:r.commitDelete},null,8,["onCanceled","onSubmitted"])])):c("",!0)]),_:1},8,["modelValue","title"])]))])}const Nt=x(kt,[["render",Rt]]),Bt={name:"GroupDocuments",components:{DocumentList:Nt},props:{},data(){return{}},computed:{group:{get(){return this.$store.getters["groups/currentItemOrNew"]}},displayDocuments(){return this.group.documents},canManageDocuments(){return this.hasAnyPermission(["groups-manage","ep-applications-manage",["info-edit",this.group]])}},methods:{async updateDocument(t){if(!this.canManageDocuments){this.$store.pushError("Permission denied");return}await this.$store.dispatch("groups/updateDocument",{group:this.group,document:t})},async createDocument(t){if(!this.canManageDocuments){this.$store.pushError("Permission denied");return}await this.$store.dispatch("groups/addDocument",{group:this.group,data:t})},async deleteDocument(t){if(!this.canManageDocuments){this.$store.pushError("Permission denied");return}await this.$store.dispatch("groups/deleteDocument",{group:this.group,document:t})}}};function jt(t,e,d,o,l,r){const D=u("DocumentList");return n(),p("div",null,[i(D,{documents:r.displayDocuments,"document-updater":r.updateDocument,"document-creator":r.createDocument,"document-deleter":r.deleteDocument,"can-manage":r.canManageDocuments},null,8,["documents","document-updater","document-creator","document-deleter","can-manage"])])}const qt=x(Bt,[["render",jt]]),Ot={name:"SubgroupList",props:{},data(){return{}},computed:{group(){return this.$store.getters["groups/currentItemOrNew"]},showMemberReportButton(){return this.hasAnyPermission([["members-invite",this.group],"groups-manage","ep-applications-manage","annual-updates-manage"])},exportUrl(){return`/api/report/groups/${this.group.uuid}/subgroup-member-export`}}},Ht={class:"flex justify-between"},Wt={class:"btn btn-icon"},zt=["href"],Yt={class:"text-xs"};function Jt(t,e,d,o,l,r){const D=u("icon-download"),k=u("dropdown-item"),w=u("note"),b=u("dropdown-menu"),f=u("dictionary-row"),C=u("router-link"),S=u("popover");return n(),p("div",null,[s("div",Ht,[e[2]||(e[2]=s("h2",{class:"mb-4"}," Subgroups ",-1)),i(b,{"hide-cheveron":"",orientation:"right"},{label:a(()=>[s("button",Wt,[i(D,{width:"16",height:"16"})])]),default:a(()=>[i(k,{class:"text-right font-bold"},{default:a(()=>e[0]||(e[0]=[h(" Downloads: ")])),_:1}),r.showMemberReportButton?(n(),_(k,{key:0,class:"text-right"},{default:a(()=>[s("a",{href:r.exportUrl},"Member Export",8,zt),i(w,{class:"inline"},{default:a(()=>e[1]||(e[1]=[h(" (CSV) ")])),_:1})]),_:1})):c("",!0)]),_:1})]),s("ul",null,[(n(!0),p(U,null,E(r.group.children,v=>(n(),p("li",{key:v.id,class:"child-group"},[i(S,{hover:"",arrow:"",placement:"left",class:"block w-full"},{content:a(()=>[s("div",Yt,[i(f,{label:"Status","label-class":"font-bold","label-width":"8em"},{default:a(()=>[h(y(v.status.name),1)]),_:2},1024),v.chairs.length>0?(n(),_(f,{key:0,label:"Chairs","label-class":"font-bold","label-width":"8em",class:"my-1"},{default:a(()=>[h(y(v.chairs.map(F=>F.person.name).join(", ")),1)]),_:2},1024)):c("",!0),v.coordinators.length>0?(n(),_(f,{key:1,label:"Coordinators","label-class":"font-bold","label-width":"8em"},{default:a(()=>[h(y(v.coordinators.map(F=>F.person.name).join(", ")),1)]),_:2},1024)):c("",!0),i(f,{label:"# Members","label-width":"8em","label-class":"font-bold"},{default:a(()=>[h(y(v.members_count),1)]),_:2},1024)])]),default:a(()=>[i(C,{to:{name:"GroupDetail",params:{uuid:v.uuid}},class:"block w-full"},{default:a(()=>[h(y(v.name),1)]),_:2},1032,["to"])]),_:2},1024)]))),128))])])}const Qt=x(Ot,[["render",Jt],["__scopeId","data-v-04effe7e"]]),Zt={name:"GroupDetail",components:{ActivityLog:ke,ApplicationSummary:ze,AttestationGcep:Fe,AttestationNhgri:Ae,AttestationReanalysis:xe,GroupDescriptionForm:et,SpecificationsSection:Ue,GroupDocuments:qt,GroupForm:Ie,GroupDetailHeader:mt,EvidenceSummaries:Ee,GcepGeneList:q,GcepOngoingPlansForm:O,MemberList:Ge,MembershipDescriptionForm:Ce,ScopeDescriptionForm:Se,VcepGeneList:j,VcepOngoingPlansForm:H,AnnualUpdateAlert:Pe,StepTabs:Ve,ProgressChart:Te,SustainedCurationReviewAlert:Me,SubgroupList:Qt},props:{uuid:{type:String,required:!0}},setup(t){const e=be(),d=he(!1),o=I({get(){return e.getters["groups/currentItemOrNew"]},set(b){e.commit("groups/addItem",b)}}),l=I(()=>o.value.is_ep?o.value.is_vcep_or_scvcep?j:q:null),r=I(()=>o.value.is_vcep_or_scvcep?H:O),D=async()=>{await De(`/api/groups/${t.uuid}/activity-logs`)},k=()=>{e.dispatch("groups/find",t.uuid).then(()=>{e.commit("groups/setCurrentItemIndexByUuid",t.uuid),e.dispatch("groups/getChildren",o.value),o.value.is_ep&&(e.dispatch("groups/getGenes",o.value),e.dispatch("groups/getDocuments",o.value),o.value.is_vcep_or_scvcep&&e.dispatch("groups/getEvidenceSummaries",o.value),e.dispatch("groups/getPendingTasks",o.value),e.dispatch("groups/getAnnualUpdate",o.value))})},w=I(()=>o.value.pendingTasks&&o.value.pendingTasks.filter(b=>Number.parseInt(b.task_type_id)===1).length>0);return ve(()=>t.uuid,()=>k(),{immediate:!0}),ye(async()=>{}),{group:o,groupGeneList:l,showModal:d,ongoingPlansFormComponent:r,logEntries:we,needsToReviewSustainedCuration:w,getLogEntries:D,getGroup:k}},data(){return{showInfoEdit:!1,editingExpertise:!1,editingDescription:!1,editingScopeDescription:!1,editingGenes:!1,showConfirmDelete:!1,ongoingPlansErrors:{},errors:{}}},computed:{showCreateAnnualUpdateButton(){return this.hasPermission("annual-updates-manage")&&this.group.expert_panel&&!this.group.expert_panel.annualUpdate}},watch:{$route(){this.showModal=this.$route.meta.showModal?!!this.$route.meta.showModal:!1}},mounted(){this.showModal=!!this.$route.meta.showModal,this.showConfirmDelete=!1},beforeUnmount(){this.$store.commit("groups/clearCurrentItem")},methods:{hideModal(){this.$router.replace({name:"GroupDetail",params:{uuid:this.uuid}})},handleModalClosed(t){this.clearModalForm(t),this.$router.push({name:"GroupDetail",params:{uuid:this.uuid}})},clearModalForm(){typeof this.$refs.modalView.clearForm=="function"&&this.$refs.modalView.clearForm()},showEdit(){this.showInfoEdit=!0},cancelForm(t){this[t]=!1,this.errors={},this.revertGroupChanges()},async submitForm(t,e){try{await this[t].apply(this.group),this[e]=!1}catch(d){if(T(d)){this.errors=d.response.data.errors;return}throw d}},saveDescription(){return this.$store.dispatch("groups/descriptionUpdate",{uuid:this.group.uuid,description:this.group.description}).then(()=>{this.$store.commit("pushSuccess","Description updated.")})},saveMembershipDescription(){return this.$store.dispatch("groups/membershipDescriptionUpdate",{uuid:this.group.uuid,membershipDescription:this.group.expert_panel.membership_description}).then(()=>{this.$store.commit("pushSuccess","Description of expertise updated.")})},saveScopeDescription(){return this.$store.dispatch("groups/scopeDescriptionUpdate",{uuid:this.group.uuid,scopeDescription:this.group.expert_panel.scope_description}).then(t=>(this.$store.commit("pushSuccess","Description of scope updated."),t))},saveOngoingPlansForm(){const{uuid:t,expert_panel:e}=this.group;return this.$store.dispatch("groups/curationReviewProtocolUpdate",{uuid:t,expertPanel:e}).then(()=>{this.$store.commit("pushSuccess","Curation review protocol updated.")})},revertGroupChanges(){return this.errors={},this.$store.dispatch("groups/find",this.group.uuid).then(()=>{this.$store.commit("pushInfo","Update canceled.")})},handleTabChange(t){t==="Log"&&_e("groups-manage")&&this.getLogEntries()},initDelete(){this.showConfirmDelete=!0},deleteGroup(){this.$store.dispatch("groups/delete",this.group.uuid),this.$store.commit("pushSuccess","Group deleted."),this.$router.push({name:"GroupList"})},async fakeCspecPilotApproved(){try{await Y.post(`/api/groups/${this.uuid}/dev/fake-pilot-approved`),this.$store.dispatch("groups/getPendingTasks",this.group)}catch(t){t.response.status===418&&this.$store.commit("pushError",t.response.data)}},createAnnualUpdateForLatestWindow(){this.$store.dispatch("groups/createAnnualUpdateForLatestWindow",this.group)}}},Kt={class:"flex space-x-4"},Xt={class:"flex-grow mt-4"},$t={key:0,class:"bg-white/50 absolute top-0 left-0 right-0 bottom-0"},eo={key:2},to={class:"relative"},oo={key:0,class:"bg-white/50 absolute top-0 left-0 right-0 bottom-0"},no={key:0},ro={key:1,class:"border my-4 p-4 rounded"},so=["href"],io={class:"border my-4 p-4 bg-red-100 border-red-200 rounded"},ao={key:2,class:"border my-4 p-4 rounded"},lo={key:0,class:"md:w-1/5 lg:w-1/4"},uo={class:"text-lg"};function po(t,e,d,o,l,r){const D=u("AnnualUpdateAlert"),k=u("SustainedCurationReviewAlert"),w=u("GroupDetailHeader"),b=u("ApplicationSummary"),f=u("MemberList"),C=u("MembershipDescriptionForm"),S=u("submission-wrapper"),v=u("tab-item"),F=u("GroupDescriptionForm"),M=u("ScopeDescriptionForm"),m=u("static-alert"),A=u("EvidenceSummaries"),Q=u("SpecificationsSection"),Z=u("GroupDocuments"),R=u("note"),K=u("AttestationGcep"),X=u("AttestationReanalysis"),$=u("AttestationNhgri"),ee=u("ActivityLog"),te=u("ProgressChart"),oe=u("StepTabs"),ne=u("tabs-container"),re=u("SubgroupList"),se=u("router-view"),P=u("modal-dialog"),ie=u("GroupForm"),ae=u("button-row");return n(),p("div",null,[t.hasAnyPermission(["annual-updates-mange",["annual-update-manage",o.group]])?(n(),_(D,{key:0,group:o.group,class:"mb-2"},null,8,["group"])):c("",!0),o.needsToReviewSustainedCuration&&t.hasAnyPermission(["ep-applications-manage",["application-edit",o.group]])?(n(),_(k,{key:1,group:o.group,class:"mb-2"},null,8,["group"])):c("",!0),i(w,{group:o.group,onShowEdit:r.showEdit},null,8,["group","onShowEdit"]),s("div",Kt,[s("div",Xt,[o.group.isApplying?(n(),_(b,{key:0,group:o.group},null,8,["group"])):c("",!0),i(ne,{onTabChanged:r.handleTabChange},{default:a(()=>[i(v,{label:"Members"},{default:a(()=>[i(f,{group:o.group},null,8,["group"]),o.group.is_vcep_or_scvcep?(n(),_(S,{key:0,"show-controls":l.editingExpertise,onSubmitted:e[1]||(e[1]=g=>r.submitForm("saveMembershipDescription","editingExpertise")),onCanceled:e[2]||(e[2]=g=>r.cancelForm("editingExpertise"))},{default:a(()=>[i(C,{editing:l.editingExpertise,"onUpdate:editing":e[0]||(e[0]=g=>l.editingExpertise=g),class:"mt-8",errors:l.errors},null,8,["editing","errors"])]),_:1},8,["show-controls"])):c("",!0)]),_:1}),i(v,{label:"Website Description"},{default:a(()=>[i(S,{visible:o.group.is_ep,"show-controls":l.editingDescription,onSubmitted:e[4]||(e[4]=g=>r.submitForm("saveDescription","editingDescription")),onCanceled:e[5]||(e[5]=g=>r.cancelForm("editingDescription"))},{default:a(()=>[i(F,{editing:l.editingDescription,"onUpdate:editing":e[3]||(e[3]=g=>l.editingDescription=g),errors:l.errors},null,8,["editing","errors"])]),_:1},8,["visible","show-controls"])]),_:1}),i(v,{label:"Scope",visible:o.group.is_ep},{default:a(()=>[e[27]||(e[27]=s("h3",null," Plans for Ongoing Gene Review and Reanalysis and Discrepancy Resolution ",-1)),o.group.is_ep?(n(),_(S,{key:0,"show-controls":l.editingGenes,onSubmitted:e[7]||(e[7]=g=>t.$refs.groupGeneListRef.save()),onCanceled:e[8]||(e[8]=g=>t.$refs.groupGeneListRef.cancel())},{default:a(()=>[(n(),_(B(o.groupGeneList),{ref:"groupGeneListRef",editing:l.editingGenes,"onUpdate:editing":e[6]||(e[6]=g=>l.editingGenes=g)},null,40,["editing"]))]),_:1},8,["show-controls"])):c("",!0),e[28]||(e[28]=s("br",null,null,-1)),i(S,{visible:o.group.is_ep,"show-controls":l.editingScopeDescription,onSubmitted:e[10]||(e[10]=g=>r.submitForm("saveScopeDescription","editingScopeDescription")),onCanceled:e[11]||(e[11]=g=>r.cancelForm("editingScopeDescription"))},{default:a(()=>[i(M,{editing:l.editingScopeDescription,"onUpdate:editing":e[9]||(e[9]=g=>l.editingScopeDescription=g),errors:l.errors},null,8,["editing","errors"])]),_:1},8,["visible","show-controls"])]),_:1},8,["visible"]),i(v,{label:"Sustained Curation",visible:o.group.is_ep,class:"relative"},{default:a(()=>[!o.group.expert_panel.pilotSpecificationsIsApproved&&o.group.is_vcep_or_scvcep?(n(),p("div",$t)):c("",!0),!o.group.expert_panel.pilotSpecificationsIsApproved&&o.group.is_vcep_or_scvcep?(n(),_(m,{key:1,variant:"info"},{default:a(()=>e[29]||(e[29]=[h(" You can complete these sections after your first Specifications Pilot has been approved. ")])),_:1})):c("",!0),i(S,{class:"pb-4","show-controls":t.hasAnyPermission(["ep-applications-manage",["application-edit",o.group]])&&o.group.expert_panel.pilotSpecificationsIsApproved,onSubmitted:e[12]||(e[12]=g=>r.submitForm("saveOngoingPlansForm")),onCanceled:e[13]||(e[13]=g=>r.cancelForm())},{default:a(()=>[(n(),_(B(o.ongoingPlansFormComponent),{errors:l.errors,readonly:!o.group.expert_panel.pilotSpecificationsIsApproved},null,8,["errors","readonly"]))]),_:1},8,["show-controls"]),o.group.is_vcep_or_scvcep?(n(),p("section",eo,[e[30]||(e[30]=s("header",null,[s("h3",null,"Example Evidence Summaries")],-1)),i(A,{group:o.group,readonly:!o.group.expert_panel.pilotSpecificationsIsApproved,class:"pb-2 mb-4 border-b"},null,8,["group","readonly"])])):c("",!0)]),_:1},8,["visible"]),i(v,{label:"Specifications",visible:o.group.is_vcep_or_scvcep},{default:a(()=>[s("div",to,[!o.group.expert_panel.defIsApproved&&o.group.is_vcep_or_scvcep?(n(),p("div",oo)):c("",!0),!o.group.expert_panel.defIsApproved&&o.group.is_vcep_or_scvcep?(n(),_(m,{key:1,variant:"info"},{default:a(()=>e[31]||(e[31]=[h(" You can complete these sections after your Group Definition has been approved. ")])),_:1})):c("",!0),s("div",null,[i(Q,{"doc-type-id":o.group.expert_panel.draftSpecApproved?[2,3,4,7]:2,step:o.group.expert_panel.draftSpecApproved?3:2},null,8,["doc-type-id","step"])])])]),_:1},8,["visible"]),t.userInGroup(o.group)||t.hasPermission("groups-manage")?(n(),_(v,{key:0,label:"Documents"},{default:a(()=>[i(Z),i(R,null,{default:a(()=>e[32]||(e[32]=[h("Documents are only available to members of this group.")])),_:1})]),_:1})):c("",!0),i(v,{label:"Attestations",visible:o.group.is_ep},{default:a(()=>[i(R,null,{default:a(()=>e[33]||(e[33]=[h(" The attestations below are read only. Attestations can only be completed during the application process. ")])),_:1}),o.group.is_gcep?(n(),_(K,{key:0,class:"pb-2 mb-4 border-b",disabled:!0})):c("",!0),e[34]||(e[34]=s("h3",null,"Reanalysis & Discrepancy Resolution",-1)),o.group.is_vcep_or_scvcep?(n(),_(X,{key:1,class:"pb-2 mb-4 border-b",disabled:!0})):c("",!0),e[35]||(e[35]=s("h3",null,"NHGRI Data Availability",-1)),i($,{class:"pb-2 mb-4 border-b",disabled:!0})]),_:1},8,["visible"]),i(v,{label:"Log",visible:t.hasPermission("groups-manage")||t.userInGroup(o.group)},{default:a(()=>[i(ee,{"log-entries":o.logEntries,"api-url":`/api/groups/${o.group.uuid}/activity-logs`,"log-updated":o.getLogEntries},null,8,["log-entries","api-url","log-updated"]),s("button",{class:"btn btn-xs mt-1",onClick:e[14]||(e[14]=(...g)=>o.getLogEntries&&o.getLogEntries(...g))}," Refresh ")]),_:1},8,["visible"]),i(v,{label:"Admin",visible:t.hasPermission("groups-manage")},{default:a(()=>[o.group.isApplying&&o.group.is_ep?(n(),p("div",no,[e[36]||(e[36]=s("h2",{class:"pb-2 border-b mb-4"}," Application ",-1)),i(te,{application:o.group.expert_panel,class:"pb-4 border-b border-gray-300 mb-6"},null,8,["application"]),o.group.is_ep?(n(),_(oe,{key:0,application:o.group.expert_panel,onStepApproved:o.getGroup},null,8,["application","onStepApproved"])):c("",!0),e[37]||(e[37]=s("hr",null,null,-1))])):c("",!0),o.group.is_ep?(n(),p("section",ro,[e[38]||(e[38]=s("h2",{class:"mb-4"}," Annual Update ",-1)),r.showCreateAnnualUpdateButton?(n(),p("button",{key:0,class:"btn",onClick:e[15]||(e[15]=(...g)=>r.createAnnualUpdateForLatestWindow&&r.createAnnualUpdateForLatestWindow(...g))}," Create Annual Update for latest window. ")):o.group.expert_panel.annualUpdate?(n(),p("a",{key:1,href:`/annual-updates/${o.group.expert_panel.annualUpdate.id}`,target:"annual update"}," View Annual Update for "+y(o.group.expert_panel.annualUpdate.window.for_year),9,so)):c("",!0)])):c("",!0),s("section",io,[e[39]||(e[39]=s("h2",{class:"mb-4 text-red-800"}," Here be dragons. Proceed with caution. ",-1)),s("button",{class:"btn btn red",onClick:e[16]||(e[16]=(...g)=>r.initDelete&&r.initDelete(...g))}," Delete Group ")]),t.$store.state.systemInfo.env!=="production"?(n(),p("section",ao,[e[40]||(e[40]=s("h2",{class:"mb-4"},[h(" Dev tools "),s("span",{class:"text-gray-500"}," - don't use if you don't know.")],-1)),o.group.is_vcep_or_scvcep&&o.group.expert_panel.has_approved_pilot?(n(),p("button",{key:0,class:"btn",onClick:e[17]||(e[17]=(...g)=>r.fakeCspecPilotApproved&&r.fakeCspecPilotApproved(...g))}," Fake a Pilot Approved Message ")):c("",!0)])):c("",!0)]),_:1},8,["visible"])]),_:1},8,["onTabChanged"])]),o.group.hasChildren?(n(),p("div",lo,[i(re)])):c("",!0)]),(n(),_(J,{to:"body"},[i(P,{modelValue:o.showModal,"onUpdate:modelValue":e[18]||(e[18]=g=>o.showModal=g),title:t.$route.meta.title,onClosed:r.handleModalClosed},{default:a(()=>[i(se,{ref:"modalView",onSaved:r.hideModal,onCanceled:r.hideModal},null,8,["onSaved","onCanceled"])]),_:1},8,["modelValue","title","onClosed"]),i(P,{modelValue:l.showInfoEdit,"onUpdate:modelValue":e[23]||(e[23]=g=>l.showInfoEdit=g),title:"Edit Group Info",size:"sm",onClosed:e[24]||(e[24]=g=>l.showInfoEdit=!1)},{default:a(()=>[i(S,{onSubmitted:e[21]||(e[21]=g=>t.$refs.infoForm.save()),onCanceled:e[22]||(e[22]=g=>t.$refs.infoForm.cancel())},{default:a(()=>[i(ie,{ref:"infoForm",onCanceled:e[19]||(e[19]=g=>l.showInfoEdit=!1),onSaved:e[20]||(e[20]=g=>l.showInfoEdit=!1)},null,512)]),_:1})]),_:1},8,["modelValue"]),i(P,{modelValue:l.showConfirmDelete,"onUpdate:modelValue":e[26]||(e[26]=g=>l.showConfirmDelete=g),title:"Delete This Group?"},{default:a(()=>[s("div",uo,[s("p",null," You are about to delete "+y(o.group.displayName)+" and all associated data. ",1),e[41]||(e[41]=s("p",null,"This cannot be undone.",-1))]),i(ae,{"submit-text":"Delete this group.",onSubmitted:r.deleteGroup,onCanceled:e[25]||(e[25]=g=>l.showConfirmDelete=!1)},null,8,["onSubmitted"])]),_:1},8,["modelValue"])]))])}const Uo=x(Zt,[["render",po]]);export{Uo as default};
//# sourceMappingURL=GroupDetail-DidhZ0P-.js.map
