import{r as p,_ as c,B as m,a as f,c as g,b as h,d as l,f as b,w as S,i as w,C as P,D as x,p as _,a4 as v}from"./app-CfiFud4u.js";import{s as I}from"./router_aware_sort_and_filter-Ckd6VGZC.js";const d=20,u=p(0),T=e=>{const t=u.value*d,s=t+d-1;return e.slice(t,s)},k=[{name:"name",sortable:!0,type:String},{name:"email",sortable:!0,type:String},{name:"institution.name",label:"Institution",sortable:!0,type:String,resolveSort(e){return e.institution?e.institution.name:""}}],y={data(){return{fields:k}},computed:{...m({currentUser:"currentUser"})},watch:{filter:{immediate:!0,handler(){this.triggerSearch&&this.triggerSearch()}},sort:{immediate:!0,handler(){this.triggerSearch&&this.triggerSearch()}}},created(){this.triggerSearch&&this.triggerSearch(),this.triggerSearch=v(()=>this.$refs.dataTable.getItems(),500)},methods:{goToPerson(e){this.$router.push(`/people/${e.uuid}`)},goToEditPerson(e){this.$router.push(`/people/${e.uuid}/edit`)},canEdit(e){return!!(this.hasPermission("people-manage")||Number.parseInt(this.currentUser.id)===Number.parseInt(e.user_id))},async itemProvider(e,t,s,r){const i={page:e,page_size:t,"sort[field]":s.field.name,"sort[dir]":s.desc?"DESC":"ASC","where[filterString]":this.filter},a=await _.get("/api/people",{params:i}).then(o=>o.data);return r(a.meta.total),a.data}},setup(){const{sort:e,filter:t}=I();return{sort:e,filter:t,pageSize:d,currentPage:u,getPageItems:T}}},C={class:"block mb-2",for:"filter-input"};function N(e,t,s,r,i,a){const o=f("data-table");return h(),g("div",null,[t[3]||(t[3]=l("h1",null,"People",-1)),b(o,{ref:"dataTable",sort:r.sort,"onUpdate:sort":t[1]||(t[1]=n=>r.sort=n),data:a.itemProvider,fields:i.fields,class:"width-full","row-click-handler":a.goToPerson,"row-class":"cursor-pointer","page-size":20,paginated:""},{header:S(()=>[l("label",C,[t[2]||(t[2]=w("Filter:Â ")),P(l("input",{"onUpdate:modelValue":t[0]||(t[0]=n=>r.filter=n),type:"text",placeholder:"filter"},null,512),[[x,r.filter]])])]),_:1},8,["sort","data","fields","row-click-handler"])])}const E=c(y,[["render",N]]);export{E as default};
//# sourceMappingURL=PeopleList-BRnmLzzo.js.map
