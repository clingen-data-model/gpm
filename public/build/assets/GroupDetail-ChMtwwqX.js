import{_ as x,aS as ae,aT as ue,c as p,h as c,d as s,i as _,j as v,F as U,m as G,e as h,w as l,a as u,b as n,n as N,f as i,a7 as de,aU as pe,aV as ce,G as z,T as me,aW as W,L as P,C as E,I as V,D as L,p as Y,J as ge,U as fe,K as J,a1 as B,k as he,r as _e,q as I,v as be,x as ve,o as ye}from"./app-CIOUoV39.js";import{l as we,f as De}from"./log_entry_repository-DVuBMgeS.js";import{A as ke}from"./ActivityLog-B34pxZcJ.js";import{V as j,S as Se,M as Ce,G as q,A as xe,a as Ae,b as Fe}from"./VcepGeneList-BHjA5d28.js";import{S as Ue}from"./SpecificationsSection-CqburhJW.js";import{E as Ge}from"./EvidenceSummaryList-DBzGAVIj.js";import{M as Ee,G as O}from"./MemberList-CRjcZMV4.js";import{G as Ie}from"./GroupForm-D9Qn0zbU.js";import{V as H}from"./VcepOngoingPlansForm-BGuuH3bD.js";import{S as Te,A as Me}from"./SustainedCurationReviewAlert-rAJcQvoD.js";import{P as Pe,S as Ve}from"./StepTabs-flSqP1mD.js";import"./router_aware_sort_and_filter-Cf6ZIYFB.js";import"./CoiDetail-DeeE59rr.js";import"./ExpertisesView-CO59Nvnb.js";import"./_baseOrderBy-e1kHEGkR.js";import"./LogEntryForm-LQnIYhPo.js";import"./judgement_utils-CQeBr_sj.js";import"./SustainedCurationReview-CxvAtxQj.js";const Le={name:"ApplicationSummary",components:{RequirementsBadge:ae},props:{group:{required:!0,type:Object}},data(){return{}},computed:{applicationStarted(){return!0},application(){return ue(this.group)},currentStep(){return this.group.expert_panel.current_step},applicationRoute(){return{name:"GroupApplication",params:{uuid:this.group.uuid},hash:`#${this.currentMenuItem.id}`}},currentMenuItem(){return this.application.getStep(this.group.expert_panel.current_step)},menu(){return this.application.steps.length>1?this.application.steps:this.application.steps[0].sections}},methods:{isStep(t){return!!t.sections},isCurrentStep(t){return!!(this.isStep(t)&&this.application.getStep(this.group.expert_panel.current_step)===t)}}},Re={key:0,class:"p-4 my-4 mb-8 border rounded-xl bg-white"},Ne={class:"mb-2"},Be={key:0},je={class:"px-8"},qe={key:2},Oe={key:0,class:"flex-1"},He={key:0,class:"mt-4"};function ze(t,e,d,o,a,r){const w=u("RequirementsBadge"),D=u("icon-lock"),y=u("badge"),b=u("router-link");return d.group.is_ep?(n(),p("div",Re,[s("h2",Ne,[e[0]||(e[0]=_(" Application Summary ")),r.applicationStarted&&d.group.is_vcep_or_scvcep?(n(),p("span",Be," - "+v(r.currentMenuItem.title),1)):c("",!0)]),s("ul",je,[(n(!0),p(U,null,G(r.menu,(f,k)=>(n(),p("li",{key:k,class:"py-1 flex justify-between border-b border-gray-300 my-2"},[s("div",{class:N(["flex justify-between",{"w-full":!r.isStep(f)}])},[s("div",{class:N(["w-56 text-lg",{"text-gray-400":r.isStep(f)&&f.isDisabled(d.group)}])},v(f.title),3),s("div",null,[r.isStep(f)?c("",!0):(n(),h(w,{key:0,section:f},null,8,["section"])),r.isStep(f)&&f.isDisabled(d.group)?(n(),h(D,{key:1,class:"inline text-gray-400",height:14,width:14})):c("",!0),r.isStep(f)&&f.isComplete(d.group)?(n(),p("div",qe,[i(y,{color:"green"},{default:l(()=>e[1]||(e[1]=[_(" Approved ")])),_:1})])):c("",!0)])],2),r.isCurrentStep(f)?(n(),p("div",Oe,[s("ul",null,[(n(!0),p(U,null,G(f.sections,(C,S)=>(n(),p("li",{key:S,class:"pb-2 flex justify-between my-2"},[s("div",null,v(C.title),1),i(w,{section:C},null,8,["section"])]))),128))])])):c("",!0)]))),128))]),t.hasAnyPermission(["ep-applications-manage",["application-edit",d.group]])?(n(),p("div",He,[d.group.uuid?(n(),h(b,{key:0,to:r.applicationRoute},{default:l(()=>e[2]||(e[2]=[s("button",{class:"btn blue btn-lg"}," Go to application ",-1)])),_:1},8,["to"])):c("",!0)])):c("",!0)])):c("",!0)}const We=x(Le,[["render",ze]]),Ye={name:"GroupDescriptionForm",components:{EditIconButton:pe,RichTextEditor:de},props:{editing:{type:Boolean,required:!1,default:!0},errors:{type:Object,required:!1,default:()=>({})}},emits:["update:editing","update:group","update"],computed:{group:{get(){return this.$store.getters["groups/currentItem"]||new z},set(t){this.$store.commit("groups/addItem",t)}},sanitizedDescription(){return ce.sanitize(this.group.description)}}},Je={class:"flex justify-between items-center"},Ke={class:"mt-2"},Qe={key:0,class:"mt-2"},Xe={key:1,class:"border-2 mt-8 p-2"},Ze=["innerHTML"];function $e(t,e,d,o,a,r){const w=u("EditIconButton"),D=u("RichTextEditor");return n(),p("div",null,[s("header",Je,[e[4]||(e[4]=s("h4",null,"Summary Description of Group",-1)),t.hasAnyPermission(["groups-manage",["application-edit",r.group]])&&!d.editing?(n(),h(w,{key:0,onClick:e[0]||(e[0]=y=>t.$emit("update:editing",!0))})):c("",!0)]),s("div",Ke,[e[5]||(e[5]=s("p",{class:"text-sm"}," This is a description of the group's purpose, goals, and objectives as intended for public display (e.g., at the clinicalgenome.org site). This may be more concise than the full scope of work. ",-1)),i(me,{name:"fade",mode:"out-in"},{default:l(()=>[d.editing?(n(),p("div",Qe,[i(D,{modelValue:r.group.description,"onUpdate:modelValue":[e[1]||(e[1]=y=>r.group.description=y),e[2]||(e[2]=y=>t.$emit("update"))]},null,8,["modelValue"])])):(n(),p("div",Xe,[r.group.description?(n(),p("div",{key:0,innerHTML:r.sanitizedDescription},null,8,Ze)):(n(),p("p",{key:1,class:"well cursor-pointer",onClick:e[3]||(e[3]=(...y)=>t.showForm&&t.showForm(...y))}," A summary description has not yet been provided. "))]))]),_:1})])])}const et=x(Ye,[["render",$e]]),tt={name:"GroupDetailHeader",props:{group:{type:z,required:!0}},emits:["showEdit"],computed:{showShortName(){return this.group.expert_panel.short_base_name!==this.group.expert_panel.long_base_name}}},ot={class:"flex justify-between items-start"},nt={class:"text-sm text-gray-800 mt-1 font-normal"},rt={key:0},st={key:1},it={key:2},lt={key:0},at={key:0},ut={key:1,class:"text-gray-500"},dt={key:0},pt={key:1,class:"text-gray-500"};function ct(t,e,d,o,a,r){const w=u("group-breadcrumbs"),D=u("badge"),y=u("router-link"),b=u("note"),f=u("dictionary-row");return n(),p("header",null,[i(w),s("h1",ot,[s("div",null,[_(v(d.group.displayName)+" ",1),i(D,{color:d.group.statusColor,class:"text-xs"},{default:l(()=>[_(v(d.group.status?d.group.status.name:"loading..."),1)]),_:1},8,["color"]),s("div",nt,[d.group.isEp()&&r.showShortName?(n(),p("span",rt,[e[1]||(e[1]=_("Short Name: ")),s("strong",null,v(d.group.expert_panel.full_short_base_name||"--"),1),e[2]||(e[2]=_(" | "))])):c("",!0),d.group.isEp()?(n(),p("span",st,[e[3]||(e[3]=_(" Affiliation ID: ")),s("strong",null,v(d.group.expert_panel.affiliation_id||"--"),1)])):c("",!0),d.group.parent_id?(n(),p("span",it,[e[4]||(e[4]=_(" | Part of the ")),i(y,{to:{name:"GroupDetail",params:{uuid:d.group.parent.uuid}}},{default:l(()=>[_(v(d.group.parent.name),1)]),_:1},8,["to"])])):c("",!0)]),t.hasRole("super-user")?(n(),h(b,{key:0,class:"font-normal mt-2"},{default:l(()=>[_(" group.id: "+v(d.group.id)+" ",1),d.group.is_ep?(n(),p("span",lt," | expertPanel.id: "+v(d.group.expert_panel.id),1)):c("",!0)]),_:1})):c("",!0)]),t.hasAnyPermission(["groups-manage",["info-edit",d.group]])?(n(),p("button",{key:0,class:"btn btn-xs",onClick:e[0]||(e[0]=k=>t.$emit("showEdit"))}," Edit Group Info ")):c("",!0)]),i(f,{label:"Chairs:"},{label:l(()=>e[5]||(e[5]=[s("strong",null,"Chairs:",-1)])),default:l(()=>[d.group.chairs.length>0?(n(),p("div",at,v(d.group.chairs.map(k=>k.person.name).join(", ")),1)):(n(),p("div",ut," None assigned "))]),_:1}),i(f,{label:"Coordinators:"},{label:l(()=>e[6]||(e[6]=[s("strong",null,"Coordinators:",-1)])),default:l(()=>[d.group.coordinators.length>0?(n(),p("div",dt,v(d.group.coordinators.map(k=>k.person.name).join(", ")),1)):(n(),p("div",pt," None assigned "))]),_:1})])}const mt=x(tt,[["render",ct]]),gt={props:{saveFunction:{type:Function,required:!0}},emits:["saved","canceled"],data(){return{newDocument:{file:null,document_type_id:this.documentTypeId,notes:null},errors:{}}},computed:{...W({documentTypes:t=>t.doctypes.items}),group(){return this.$store.getters["groups/currentItemOrNew"]},application(){return this.group.expert_panel},isReviewed(){return!!this.newDocument.date_reviewed},documentType(){return this.documentTypes.length===0?{}:this.$store.getters["doctypes/getItemById"](this.documentTypeId)}},mounted(){this.$store.dispatch("doctypes/getItems")},methods:{async save(){try{const t=new FormData;Object.keys(this.newDocument).forEach(e=>{const d=this.newDocument[e];d!=null&&t.append(e,d)}),t.append("file",this.$refs.fileInput.files[0]),await this.saveFunction(t),this.clearForm(),this.$emit("saved")}catch(t){P(t)&&(this.errors=t.response.data.errors)}},cancel(){this.clearForm(),this.$emit("canceled")},clearForm(){this.initNewDocument(),this.clearErrors()},initNewDocument(){this.$refs.fileInput.value=null,this.newDocument={file:null,document_type_id:this.documentTypeId,notes:null}},clearErrors(){this.errors={}}}},ft={ref:"fileInput",type:"file"},ht=["value"];function _t(t,e,d,o,a,r){const w=u("input-row"),D=u("button-row"),y=u("form-container");return n(),h(y,null,{default:l(()=>[i(w,{label:"Document",errors:a.errors.file},{default:l(()=>[s("input",ft,null,512)]),_:1},8,["errors"]),i(w,{label:"Type",errors:a.errors.document_type_id},{default:l(()=>[E(s("select",{"onUpdate:modelValue":e[0]||(e[0]=b=>a.newDocument.document_type_id=b)},[e[4]||(e[4]=s("option",{value:null}," Select... ",-1)),(n(!0),p(U,null,G(t.documentTypes,b=>(n(),p("option",{key:b.id,value:b.id},v(b.long_name),9,ht))),128))],512),[[V,a.newDocument.document_type_id]])]),_:1},8,["errors"]),i(w,{errors:a.errors.notes,label:"Notes"},{default:l(()=>[E(s("textarea",{"onUpdate:modelValue":e[1]||(e[1]=b=>a.newDocument.notes=b),name:"notes",cols:"30",rows:"10"},null,512),[[L,a.newDocument.notes]])]),_:1},8,["errors"]),i(D,null,{default:l(()=>[s("button",{class:"btn white",onClick:e[2]||(e[2]=(...b)=>r.cancel&&r.cancel(...b))}," Cancel "),s("button",{class:"btn blue",onClick:e[3]||(e[3]=(...b)=>r.save&&r.save(...b))}," Save ")]),_:1})]),_:1})}const bt=x(gt,[["render",_t]]),vt={name:"DocumentEditForm",props:{document:{required:!0,type:Object},saveFunction:{required:!0,type:Function}},emits:["saved","canceled"],data(){return{docProxy:{},errors:{}}},computed:{...W({documentTypes:t=>t.doctypes.items})},watch:{document:{immediate:!0,handler(){this.docProxy=JSON.parse(JSON.stringify(this.document))}}},mounted(){this.$store.dispatch("doctypes/getItems")},methods:{cancel(){this.docProxy={},this.$emit("canceled")},async save(){try{this.saveFunction(this.docProxy),this.$emit("saved")}catch(t){throw P(t)&&(this.errors=t.response.data.errors),t}}}},yt=["value"];function wt(t,e,d,o,a,r){const w=u("dictionary-row"),D=u("input-row"),y=u("button-row"),b=u("form-container");return n(),h(b,null,{default:l(()=>[i(w,{label:"File"},{default:l(()=>[_(v(d.document.filename),1)]),_:1}),i(D,{label:"Type",errors:a.errors.document_type_id},{default:l(()=>[E(s("select",{"onUpdate:modelValue":e[0]||(e[0]=f=>a.docProxy.document_type_id=f)},[(n(!0),p(U,null,G(t.documentTypes,f=>(n(),p("option",{key:f.id,value:f.id},v(f.long_name),9,yt))),128))],512),[[V,a.docProxy.document_type_id]])]),_:1},8,["errors"]),i(D,{errors:a.errors.notes,label:"Notes"},{default:l(()=>[E(s("textarea",{"onUpdate:modelValue":e[1]||(e[1]=f=>a.docProxy.notes=f),name:"notes",cols:"30",rows:"10"},null,512),[[L,a.docProxy.notes]])]),_:1},8,["errors"]),i(y,null,{default:l(()=>[s("button",{class:"btn",onClick:e[2]||(e[2]=(...f)=>r.cancel&&r.cancel(...f))}," Cancel "),s("button",{class:"btn blue",onClick:e[3]||(e[3]=(...f)=>r.save&&r.save(...f))}," Save ")]),_:1})]),_:1})}const Dt=x(vt,[["render",wt]]),kt={name:"DocumentList",components:{DocumentUploadForm:bt,DocumentEditForm:Dt},props:{documents:{type:Array,required:!0},documentCreator:{type:Function,required:!1},documentUpdater:{type:Function,required:!1},documentDeleter:{type:Function,required:!1},canManage:{type:Boolean,default:!1}},emits:["updated"],data(){return{fields:[{name:"cheveron",label:"",sortable:!1},{name:"filename",label:"File",type:String,sortable:!0},{name:"type.long_name",label:"Type",type:String,sortable:!0},{name:"notes",type:String,sortable:!0},{name:"actions",label:"",type:String,sortable:!1}],sort:{field:"filename",desc:!1},keyword:null,filterType:null,documentTypes:[],activeDocument:{type:{}},showDeleteConfirmation:!1,showEditForm:!1,showUploadForm:!1}},computed:{filteredDocuments(){let t=[...this.documents];if(this.keyword){const e=new RegExp(`.*${this.keyword}.*`,"i");t=t.filter(d=>d.filename.match(e)||d.notes&&d.notes.match(e)||d.type.name.match(e))}return this.filterType&&(t=t.filter(e=>e.document_type_id===this.filterType)),t}},mounted(){Y.get("/api/document-types").then(t=>this.documentTypes=t.data)},methods:{toggleItemDetails(t){t.showDetails=!t.showDetails},initDownload(t){window.location=t.download_url},initUpdate(t){this.showEditForm=!0,this.activeDocument=t},commitUpdate(t){this.documentUpdater?this.documentUpdater(t):alert("we need a default document upload function"),this.$emit("updated"),this.showUploadForm=!1},initDelete(t){this.activeDocument=t,this.showDeleteConfirmation=!0},cancelDelete(){this.showDeleteConfirmation=!1,this.resetActiveDocument()},async commitDelete(){this.documentDeleter?this.documentDeleter(this.activeDocument):alert("we need to add a default document deleter."),this.showDeleteConfirmation=!1,this.resetActiveDocument(),this.$emit("updated")},initUpload(){this.showUploadForm=!0},commitCreate(t){this.documentCreator?this.documentCreator(t):alert("we need a default document upload function"),this.$emit("updated"),this.showUploadForm=!1},resetActiveDocument(){this.activeDocument={type:{}}}}},St={class:"flex justify-between py-2"},Ct={class:"flex space-x-2"},xt=["value"],At=["onClick"],Ft={class:"note"},Ut={key:0},Gt={key:1},Et={class:"px-4 pb-4 border"},It={key:0,class:"flex space-x-2 pt-2 border-t"},Tt=["onClick"],Mt=["onClick"],Pt=["onClick"],Vt={key:0},Lt={key:0,class:"mb-3"};function Rt(t,e,d,o,a,r){const w=u("icon-cheveron-right"),D=u("icon-cheveron-down"),y=u("dropdown-item"),b=u("dropdown-menu"),f=u("object-dictionary"),k=u("data-table"),C=u("DocumentEditForm"),S=u("modal-dialog"),F=u("DocumentUploadForm"),T=u("button-row");return n(),p("div",null,[ge(t.$slots,"heading",{},()=>[s("div",St,[s("div",Ct,[s("label",null,[e[9]||(e[9]=_(" Search: ")),E(s("input",{"onUpdate:modelValue":e[0]||(e[0]=m=>a.keyword=m),type:"text",placeholder:"Filter",class:"sm"},null,512),[[L,a.keyword]])]),s("label",null,[e[11]||(e[11]=_(" Type:   ")),E(s("select",{"onUpdate:modelValue":e[1]||(e[1]=m=>a.filterType=m)},[e[10]||(e[10]=s("option",{value:null},"Any",-1)),(n(!0),p(U,null,G(a.documentTypes,m=>(n(),p("option",{key:m.id,value:m.id},v(m.long_name),9,xt))),128))],512),[[V,a.filterType]])])]),d.canManage?(n(),p("button",{key:0,class:"btn btn-xs",onClick:e[2]||(e[2]=(...m)=>r.initUpload&&r.initUpload(...m))}," Upload ")):c("",!0)])]),i(k,{sort:a.sort,"onUpdate:sort":e[3]||(e[3]=m=>a.sort=m),fields:a.fields,data:r.filteredDocuments,"detail-rows":!0},{"cell-cheveron":l(({item:m})=>[m.metadata?(n(),p("button",{key:0,class:"w-9 align-center block -mx-3",onClick:fe(A=>r.toggleItemDetails(m),["stop"])},[m.showDetails?c("",!0):(n(),h(w,{key:0,class:"m-auto cursor-pointer"})),m.showDetails?(n(),h(D,{key:1,class:"m-auto cursor-pointer"})):c("",!0)],8,At)):c("",!0)]),"cell-filename":l(({item:m})=>[_(v(m.filename)+" ",1),s("span",Ft,[m.type.is_versioned&&m.version?(n(),p("em",Ut,"(version "+v(m.version)+")",1)):c("",!0),m.is_final?(n(),p("em",Gt," FINAL")):c("",!0)])]),"cell-actions":l(({item:m})=>[i(b,{"hide-cheveron":""},{label:l(()=>e[12]||(e[12]=[s("button",{class:"btn btn-xs"}," … ",-1)])),default:l(()=>[i(y,{onClick:A=>r.initDownload(m)},{default:l(()=>e[13]||(e[13]=[_(" Download ")])),_:2},1032,["onClick"]),d.canManage?(n(),h(y,{key:0,onClick:A=>r.initUpdate(m)},{default:l(()=>e[14]||(e[14]=[_(" Update ")])),_:2},1032,["onClick"])):c("",!0),d.canManage?(n(),h(y,{key:1,onClick:A=>r.initDelete(m)},{default:l(()=>e[15]||(e[15]=[_(" Delete ")])),_:2},1032,["onClick"])):c("",!0)]),_:2},1024)]),detail:l(({item:m})=>[s("div",Et,[i(f,{obj:m.metadata},null,8,["obj"]),d.canManage?(n(),p("div",It,[s("button",{class:"btn btn-xs",onClick:A=>r.initDownload(m)}," Download ",8,Tt),s("button",{class:"btn btn-xs",onClick:A=>r.initUpdate(m)}," Update ",8,Mt),s("button",{class:"btn btn-xs red",onClick:A=>r.initDelete(m)}," Delete ",8,Pt)])):c("",!0)])]),_:1},8,["sort","fields","data"]),(n(),h(J,{to:"body"},[i(S,{modelValue:a.showEditForm,"onUpdate:modelValue":e[5]||(e[5]=m=>a.showEditForm=m),title:`Update ${a.activeDocument.filename}`},{default:l(()=>[i(C,{document:a.activeDocument,"save-function":r.commitUpdate,onSaved:e[4]||(e[4]=m=>t.$emit("updated"))},null,8,["document","save-function"])]),_:1},8,["modelValue","title"]),i(S,{modelValue:a.showUploadForm,"onUpdate:modelValue":e[7]||(e[7]=m=>a.showUploadForm=m),title:"Upload a new document"},{default:l(()=>[i(F,{"save-function":r.commitCreate,onSaved:e[6]||(e[6]=m=>t.$emit("updated"))},null,8,["save-function"])]),_:1},8,["modelValue"]),i(S,{modelValue:a.showDeleteConfirmation,"onUpdate:modelValue":e[8]||(e[8]=m=>a.showDeleteConfirmation=m),title:`You are about to delete ${a.activeDocument.filename}`},{default:l(()=>[a.activeDocument?(n(),p("div",Vt,[a.activeDocument.is_final?(n(),p("p",Lt," This version has been tagged as the final version of the document. ")):c("",!0),e[16]||(e[16]=s("p",null,"Are you sure you want to continue?",-1)),i(T,{"submit-text":"Delete Document",onCanceled:r.cancelDelete,onSubmitted:r.commitDelete},null,8,["onCanceled","onSubmitted"])])):c("",!0)]),_:1},8,["modelValue","title"])]))])}const Nt=x(kt,[["render",Rt]]),Bt={name:"GroupDocuments",components:{DocumentList:Nt},props:{},data(){return{}},computed:{group:{get(){return this.$store.getters["groups/currentItemOrNew"]}},displayDocuments(){return this.group.documents},canManageDocuments(){return this.hasAnyPermission(["groups-manage","ep-applications-manage",["info-edit",this.group]])}},methods:{async updateDocument(t){if(!this.canManageDocuments){this.$store.pushError("Permission denied");return}await this.$store.dispatch("groups/updateDocument",{group:this.group,document:t})},async createDocument(t){if(!this.canManageDocuments){this.$store.pushError("Permission denied");return}await this.$store.dispatch("groups/addDocument",{group:this.group,data:t})},async deleteDocument(t){if(!this.canManageDocuments){this.$store.pushError("Permission denied");return}await this.$store.dispatch("groups/deleteDocument",{group:this.group,document:t})}}};function jt(t,e,d,o,a,r){const w=u("DocumentList");return n(),p("div",null,[i(w,{documents:r.displayDocuments,"document-updater":r.updateDocument,"document-creator":r.createDocument,"document-deleter":r.deleteDocument,"can-manage":r.canManageDocuments},null,8,["documents","document-updater","document-creator","document-deleter","can-manage"])])}const qt=x(Bt,[["render",jt]]),Ot={name:"SubgroupList",props:{},data(){return{}},computed:{group(){return this.$store.getters["groups/currentItemOrNew"]},showMemberReportButton(){return this.hasAnyPermission([["members-invite",this.group],"groups-manage","ep-applications-manage","annual-updates-manage"])},exportUrl(){return`/api/report/groups/${this.group.uuid}/subgroup-member-export`}}},Ht={class:"flex justify-between"},zt={class:"btn btn-icon"},Wt=["href"],Yt={class:"text-xs"};function Jt(t,e,d,o,a,r){const w=u("icon-download"),D=u("dropdown-item"),y=u("note"),b=u("dropdown-menu"),f=u("dictionary-row"),k=u("router-link"),C=u("popover");return n(),p("div",null,[s("div",Ht,[e[2]||(e[2]=s("h2",{class:"mb-4"}," Subgroups ",-1)),i(b,{"hide-cheveron":"",orientation:"right"},{label:l(()=>[s("button",zt,[i(w,{width:"16",height:"16"})])]),default:l(()=>[i(D,{class:"text-right font-bold"},{default:l(()=>e[0]||(e[0]=[_(" Downloads: ")])),_:1}),r.showMemberReportButton?(n(),h(D,{key:0,class:"text-right"},{default:l(()=>[s("a",{href:r.exportUrl},"Member Export",8,Wt),i(y,{class:"inline"},{default:l(()=>e[1]||(e[1]=[_(" (CSV) ")])),_:1})]),_:1})):c("",!0)]),_:1})]),s("ul",null,[(n(!0),p(U,null,G(r.group.children,S=>(n(),p("li",{key:S.id,class:"child-group"},[i(C,{hover:"",arrow:"",placement:"left",class:"block w-full"},{content:l(()=>[s("div",Yt,[i(f,{label:"Status","label-class":"font-bold","label-width":"8em"},{default:l(()=>[_(v(S.status.name),1)]),_:2},1024),S.chairs.length>0?(n(),h(f,{key:0,label:"Chairs","label-class":"font-bold","label-width":"8em",class:"my-1"},{default:l(()=>[_(v(S.chairs.map(F=>F.person.name).join(", ")),1)]),_:2},1024)):c("",!0),S.coordinators.length>0?(n(),h(f,{key:1,label:"Coordinators","label-class":"font-bold","label-width":"8em"},{default:l(()=>[_(v(S.coordinators.map(F=>F.person.name).join(", ")),1)]),_:2},1024)):c("",!0),i(f,{label:"# Members","label-width":"8em","label-class":"font-bold"},{default:l(()=>[_(v(S.members_count),1)]),_:2},1024)])]),default:l(()=>[i(k,{to:{name:"GroupDetail",params:{uuid:S.uuid}},class:"block w-full"},{default:l(()=>[_(v(S.name),1)]),_:2},1032,["to"])]),_:2},1024)]))),128))])])}const Kt=x(Ot,[["render",Jt],["__scopeId","data-v-9d24f305"]]),Qt={name:"GroupDetail",components:{ActivityLog:ke,ApplicationSummary:We,AttestationGcep:Fe,AttestationNhgri:Ae,AttestationReanalysis:xe,GroupDescriptionForm:et,SpecificationsSection:Ue,GroupDocuments:qt,GroupForm:Ie,GroupDetailHeader:mt,EvidenceSummaries:Ge,GcepGeneList:q,GcepOngoingPlansForm:O,MemberList:Ee,MembershipDescriptionForm:Ce,ScopeDescriptionForm:Se,VcepGeneList:j,VcepOngoingPlansForm:H,AnnualUpdateAlert:Me,StepTabs:Ve,ProgressChart:Pe,SustainedCurationReviewAlert:Te,SubgroupList:Kt},props:{uuid:{type:String,required:!0}},setup(t){const e=be(),d=_e(!1),o=I({get(){return e.getters["groups/currentItemOrNew"]},set(b){e.commit("groups/addItem",b)}}),a=I(()=>o.value.is_ep?o.value.is_vcep_or_scvcep?j:q:null),r=I(()=>o.value.is_vcep_or_scvcep?H:O),w=async()=>{await De(`/api/groups/${t.uuid}/activity-logs`)},D=()=>{e.dispatch("groups/find",t.uuid).then(()=>{e.commit("groups/setCurrentItemIndexByUuid",t.uuid),e.dispatch("groups/getChildren",o.value),o.value.is_ep&&(e.dispatch("groups/getGenes",o.value),e.dispatch("groups/getDocuments",o.value),o.value.is_vcep_or_scvcep&&e.dispatch("groups/getEvidenceSummaries",o.value),e.dispatch("groups/getPendingTasks",o.value),e.dispatch("groups/getAnnualUpdate",o.value))})},y=I(()=>o.value.pendingTasks&&o.value.pendingTasks.filter(b=>b.task_type_id===1).length>0);return ve(()=>t.uuid,()=>D(),{immediate:!0}),ye(async()=>{}),{group:o,groupGeneList:a,showModal:d,ongoingPlansFormComponent:r,logEntries:we,needsToReviewSustainedCuration:y,getLogEntries:w,getGroup:D}},data(){return{showInfoEdit:!1,editingExpertise:!1,editingDescription:!1,editingScopeDescription:!1,editingGenes:!1,showConfirmDelete:!1,ongoingPlansErrors:{},errors:{}}},computed:{showCreateAnnualUpdateButton(){return this.hasPermission("annual-updates-manage")&&this.group.expert_panel&&!this.group.expert_panel.annualUpdate}},watch:{$route(){this.showModal=this.$route.meta.showModal?!!this.$route.meta.showModal:!1}},mounted(){this.showModal=!!this.$route.meta.showModal,this.showConfirmDelete=!1},beforeUnmount(){this.$store.commit("groups/clearCurrentItem")},methods:{hideModal(){this.$router.replace({name:"GroupDetail",params:{uuid:this.uuid}})},handleModalClosed(t){this.clearModalForm(t),this.$router.push({name:"GroupDetail",params:{uuid:this.uuid}})},clearModalForm(){typeof this.$refs.modalView.clearForm=="function"&&this.$refs.modalView.clearForm()},showEdit(){this.showInfoEdit=!0},cancelForm(t){this[t]=!1,this.errors={},this.revertGroupChanges()},async submitForm(t,e){try{await this[t].apply(this.group),this[e]=!1}catch(d){if(P(d)){this.errors=d.response.data.errors;return}throw d}},saveDescription(){return this.$store.dispatch("groups/descriptionUpdate",{uuid:this.group.uuid,description:this.group.description}).then(()=>{this.$store.commit("pushSuccess","Description updated.")})},saveMembershipDescription(){return this.$store.dispatch("groups/membershipDescriptionUpdate",{uuid:this.group.uuid,membershipDescription:this.group.expert_panel.membership_description}).then(()=>{this.$store.commit("pushSuccess","Description of expertise updated.")})},saveScopeDescription(){return this.$store.dispatch("groups/scopeDescriptionUpdate",{uuid:this.group.uuid,scopeDescription:this.group.expert_panel.scope_description}).then(t=>(this.$store.commit("pushSuccess","Description of scope updated."),t))},saveOngoingPlansForm(){const{uuid:t,expert_panel:e}=this.group;return this.$store.dispatch("groups/curationReviewProtocolUpdate",{uuid:t,expertPanel:e}).then(()=>{this.$store.commit("pushSuccess","Curation review protocol updated.")})},revertGroupChanges(){return this.errors={},this.$store.dispatch("groups/find",this.group.uuid).then(()=>{this.$store.commit("pushInfo","Update canceled.")})},handleTabChange(t){t==="Log"&&he("groups-manage")&&this.getLogEntries()},initDelete(){this.showConfirmDelete=!0},deleteGroup(){this.$store.dispatch("groups/delete",this.group.uuid),this.$store.commit("pushSuccess","Group deleted."),this.$router.push({name:"GroupList"})},async fakeCspecPilotApproved(){try{await Y.post(`/api/groups/${this.uuid}/dev/fake-pilot-approved`),this.$store.dispatch("groups/getPendingTasks",this.group)}catch(t){t.response.status===418&&this.$store.commit("pushError",t.response.data)}},createAnnualUpdateForLatestWindow(){this.$store.dispatch("groups/createAnnualUpdateForLatestWindow",this.group)}}},Xt={class:"flex space-x-4"},Zt={class:"flex-grow mt-4"},$t={key:0,class:"bg-white/50 absolute top-0 left-0 right-0 bottom-0"},eo={key:2},to={class:"relative"},oo={key:0,class:"bg-white/50 absolute top-0 left-0 right-0 bottom-0"},no={key:0},ro={key:1,class:"border my-4 p-4 rounded"},so=["href"],io={class:"border my-4 p-4 bg-red-100 border-red-200 rounded"},lo={key:2,class:"border my-4 p-4 rounded"},ao={key:0,class:"md:w-1/5 lg:w-1/4"},uo={class:"text-lg"};function po(t,e,d,o,a,r){const w=u("AnnualUpdateAlert"),D=u("SustainedCurationReviewAlert"),y=u("GroupDetailHeader"),b=u("ApplicationSummary"),f=u("GroupDescriptionForm"),k=u("submission-wrapper"),C=u("tab-item"),S=u("MemberList"),F=u("MembershipDescriptionForm"),T=u("ScopeDescriptionForm"),m=u("static-alert"),A=u("EvidenceSummaries"),K=u("SpecificationsSection"),Q=u("GroupDocuments"),R=u("note"),X=u("AttestationGcep"),Z=u("AttestationReanalysis"),$=u("AttestationNhgri"),ee=u("ActivityLog"),te=u("ProgressChart"),oe=u("StepTabs"),ne=u("tabs-container"),re=u("SubgroupList"),se=u("router-view"),M=u("modal-dialog"),ie=u("GroupForm"),le=u("button-row");return n(),p("div",null,[t.hasAnyPermission(["annual-updates-mange",["annual-update-manage",o.group]])?(n(),h(w,{key:0,group:o.group,class:"mb-2"},null,8,["group"])):c("",!0),o.needsToReviewSustainedCuration&&t.hasAnyPermission(["ep-applications-manage",["application-edit",o.group]])?(n(),h(D,{key:1,group:o.group,class:"mb-2"},null,8,["group"])):c("",!0),i(y,{group:o.group,onShowEdit:r.showEdit},null,8,["group","onShowEdit"]),s("div",Xt,[s("div",Zt,[o.group.isApplying?(n(),h(b,{key:0,group:o.group},null,8,["group"])):c("",!0),i(ne,{onTabChanged:r.handleTabChange},{default:l(()=>[i(C,{label:"Summary Description"},{default:l(()=>[i(k,{visible:o.group.is_ep,"show-controls":a.editingDescription,onSubmitted:e[1]||(e[1]=g=>r.submitForm("saveDescription","editingDescription")),onCanceled:e[2]||(e[2]=g=>r.cancelForm("editingDescription"))},{default:l(()=>[i(f,{editing:a.editingDescription,"onUpdate:editing":e[0]||(e[0]=g=>a.editingDescription=g),errors:a.errors},null,8,["editing","errors"])]),_:1},8,["visible","show-controls"])]),_:1}),i(C,{label:"Members"},{default:l(()=>[i(S,{group:o.group},null,8,["group"]),o.group.is_vcep_or_scvcep?(n(),h(k,{key:0,"show-controls":a.editingExpertise,onSubmitted:e[4]||(e[4]=g=>r.submitForm("saveMembershipDescription","editingExpertise")),onCanceled:e[5]||(e[5]=g=>r.cancelForm("editingExpertise"))},{default:l(()=>[i(F,{editing:a.editingExpertise,"onUpdate:editing":e[3]||(e[3]=g=>a.editingExpertise=g),class:"mt-8",errors:a.errors},null,8,["editing","errors"])]),_:1},8,["show-controls"])):c("",!0)]),_:1}),i(C,{label:"Scope",visible:o.group.is_ep},{default:l(()=>[e[27]||(e[27]=s("h3",null," Plans for Ongoing Gene Review and Reanalysis and Discrepancy Resolution ",-1)),o.group.is_ep?(n(),h(k,{key:0,"show-controls":a.editingGenes,onSubmitted:e[7]||(e[7]=g=>t.$refs.groupGeneListRef.save()),onCanceled:e[8]||(e[8]=g=>t.$refs.groupGeneListRef.cancel())},{default:l(()=>[(n(),h(B(o.groupGeneList),{ref:"groupGeneListRef",editing:a.editingGenes,"onUpdate:editing":e[6]||(e[6]=g=>a.editingGenes=g)},null,40,["editing"]))]),_:1},8,["show-controls"])):c("",!0),e[28]||(e[28]=s("br",null,null,-1)),i(k,{visible:o.group.is_ep,"show-controls":a.editingScopeDescription,onSubmitted:e[10]||(e[10]=g=>r.submitForm("saveScopeDescription","editingScopeDescription")),onCanceled:e[11]||(e[11]=g=>r.cancelForm("editingScopeDescription"))},{default:l(()=>[i(T,{editing:a.editingScopeDescription,"onUpdate:editing":e[9]||(e[9]=g=>a.editingScopeDescription=g),errors:a.errors},null,8,["editing","errors"])]),_:1},8,["visible","show-controls"])]),_:1},8,["visible"]),i(C,{label:"Sustained Curation",visible:o.group.is_ep,class:"relative"},{default:l(()=>[!o.group.expert_panel.pilotSpecificationsIsApproved&&o.group.is_vcep_or_scvcep?(n(),p("div",$t)):c("",!0),!o.group.expert_panel.pilotSpecificationsIsApproved&&o.group.is_vcep_or_scvcep?(n(),h(m,{key:1,variant:"info"},{default:l(()=>e[29]||(e[29]=[_(" You can complete these sections after your first Specifications Pilot has been approved. ")])),_:1})):c("",!0),i(k,{class:"pb-4","show-controls":t.hasAnyPermission(["ep-applications-manage",["application-edit",o.group]])&&o.group.expert_panel.pilotSpecificationsIsApproved,onSubmitted:e[12]||(e[12]=g=>r.submitForm("saveOngoingPlansForm")),onCanceled:e[13]||(e[13]=g=>r.cancelForm())},{default:l(()=>[(n(),h(B(o.ongoingPlansFormComponent),{errors:a.errors,readonly:!o.group.expert_panel.pilotSpecificationsIsApproved},null,8,["errors","readonly"]))]),_:1},8,["show-controls"]),o.group.is_vcep_or_scvcep?(n(),p("section",eo,[e[30]||(e[30]=s("header",null,[s("h3",null,"Example Evidence Summaries")],-1)),i(A,{group:o.group,readonly:!o.group.expert_panel.pilotSpecificationsIsApproved,class:"pb-2 mb-4 border-b"},null,8,["group","readonly"])])):c("",!0)]),_:1},8,["visible"]),i(C,{label:"Specifications",visible:o.group.is_vcep_or_scvcep},{default:l(()=>[s("div",to,[!o.group.expert_panel.defIsApproved&&o.group.is_vcep_or_scvcep?(n(),p("div",oo)):c("",!0),!o.group.expert_panel.defIsApproved&&o.group.is_vcep_or_scvcep?(n(),h(m,{key:1,variant:"info"},{default:l(()=>e[31]||(e[31]=[_(" You can complete these sections after your Group Definition has been approved. ")])),_:1})):c("",!0),s("div",null,[i(K,{"doc-type-id":o.group.expert_panel.draftSpecApproved?[2,3,4,7]:2,step:o.group.expert_panel.draftSpecApproved?3:2},null,8,["doc-type-id","step"])])])]),_:1},8,["visible"]),t.userInGroup(o.group)||t.hasPermission("groups-manage")?(n(),h(C,{key:0,label:"Documents"},{default:l(()=>[i(Q),i(R,null,{default:l(()=>e[32]||(e[32]=[_("Documents are only available to members of this group.")])),_:1})]),_:1})):c("",!0),i(C,{label:"Attestations",visible:o.group.is_ep},{default:l(()=>[i(R,null,{default:l(()=>e[33]||(e[33]=[_(" The attestations below are read only. Attestations can only be completed during the application process. ")])),_:1}),o.group.is_gcep?(n(),h(X,{key:0,class:"pb-2 mb-4 border-b",disabled:!0})):c("",!0),e[34]||(e[34]=s("h3",null,"Reanalysis & Discrepancy Resolution",-1)),o.group.is_vcep_or_scvcep?(n(),h(Z,{key:1,class:"pb-2 mb-4 border-b",disabled:!0})):c("",!0),e[35]||(e[35]=s("h3",null,"NHGRI Data Availability",-1)),i($,{class:"pb-2 mb-4 border-b",disabled:!0})]),_:1},8,["visible"]),i(C,{label:"Log",visible:t.hasPermission("groups-manage")||t.userInGroup(o.group)},{default:l(()=>[i(ee,{"log-entries":o.logEntries,"api-url":`/api/groups/${o.group.uuid}/activity-logs`,"log-updated":o.getLogEntries},null,8,["log-entries","api-url","log-updated"]),s("button",{class:"btn btn-xs mt-1",onClick:e[14]||(e[14]=(...g)=>o.getLogEntries&&o.getLogEntries(...g))}," Refresh ")]),_:1},8,["visible"]),i(C,{label:"Admin",visible:t.hasPermission("groups-manage")},{default:l(()=>[o.group.isApplying&&o.group.is_ep?(n(),p("div",no,[e[36]||(e[36]=s("h2",{class:"pb-2 border-b mb-4"}," Application ",-1)),i(te,{application:o.group.expert_panel,class:"pb-4 border-b border-gray-300 mb-6"},null,8,["application"]),o.group.is_ep?(n(),h(oe,{key:0,application:o.group.expert_panel,onStepApproved:o.getGroup},null,8,["application","onStepApproved"])):c("",!0),e[37]||(e[37]=s("hr",null,null,-1))])):c("",!0),o.group.is_ep?(n(),p("section",ro,[e[38]||(e[38]=s("h2",{class:"mb-4"}," Annual Update ",-1)),r.showCreateAnnualUpdateButton?(n(),p("button",{key:0,class:"btn",onClick:e[15]||(e[15]=(...g)=>r.createAnnualUpdateForLatestWindow&&r.createAnnualUpdateForLatestWindow(...g))}," Create Annual Update for latest window. ")):o.group.expert_panel.annualUpdate?(n(),p("a",{key:1,href:`/annual-updates/${o.group.expert_panel.annualUpdate.id}`,target:"annual update"}," View Annual Update for "+v(o.group.expert_panel.annualUpdate.window.for_year),9,so)):c("",!0)])):c("",!0),s("section",io,[e[39]||(e[39]=s("h2",{class:"mb-4 text-red-800"}," Here be dragons. Proceed with caution. ",-1)),s("button",{class:"btn btn red",onClick:e[16]||(e[16]=(...g)=>r.initDelete&&r.initDelete(...g))}," Delete Group ")]),t.$store.state.systemInfo.env!=="production"?(n(),p("section",lo,[e[40]||(e[40]=s("h2",{class:"mb-4"},[_(" Dev tools "),s("span",{class:"text-gray-500"}," - don't use if you don't know.")],-1)),o.group.is_vcep_or_scvcep&&o.group.expert_panel.has_approved_pilot?(n(),p("button",{key:0,class:"btn",onClick:e[17]||(e[17]=(...g)=>r.fakeCspecPilotApproved&&r.fakeCspecPilotApproved(...g))}," Fake a Pilot Approved Message ")):c("",!0)])):c("",!0)]),_:1},8,["visible"])]),_:1},8,["onTabChanged"])]),o.group.hasChildren?(n(),p("div",ao,[i(re)])):c("",!0)]),(n(),h(J,{to:"body"},[i(M,{modelValue:o.showModal,"onUpdate:modelValue":e[18]||(e[18]=g=>o.showModal=g),title:t.$route.meta.title,onClosed:r.handleModalClosed},{default:l(()=>[i(se,{ref:"modalView",onSaved:r.hideModal,onCanceled:r.hideModal},null,8,["onSaved","onCanceled"])]),_:1},8,["modelValue","title","onClosed"]),i(M,{modelValue:a.showInfoEdit,"onUpdate:modelValue":e[23]||(e[23]=g=>a.showInfoEdit=g),title:"Edit Group Info",size:"sm",onClosed:e[24]||(e[24]=g=>a.showInfoEdit=!1)},{default:l(()=>[i(k,{onSubmitted:e[21]||(e[21]=g=>t.$refs.infoForm.save()),onCanceled:e[22]||(e[22]=g=>t.$refs.infoForm.cancel())},{default:l(()=>[i(ie,{ref:"infoForm",onCanceled:e[19]||(e[19]=g=>a.showInfoEdit=!1),onSaved:e[20]||(e[20]=g=>a.showInfoEdit=!1)},null,512)]),_:1})]),_:1},8,["modelValue"]),i(M,{modelValue:a.showConfirmDelete,"onUpdate:modelValue":e[26]||(e[26]=g=>a.showConfirmDelete=g),title:"Delete This Group?"},{default:l(()=>[s("div",uo,[s("p",null," You are about to delete "+v(o.group.displayName)+" and all associated data. ",1),e[41]||(e[41]=s("p",null,"This cannot be undone.",-1))]),i(le,{"submit-text":"Delete this group.",onSubmitted:r.deleteGroup,onCanceled:e[25]||(e[25]=g=>a.showConfirmDelete=!1)},null,8,["onSubmitted"])]),_:1},8,["modelValue"])]))])}const Go=x(Qt,[["render",po]]);export{Go as default};
//# sourceMappingURL=GroupDetail-ChMtwwqX.js.map
