{"version":3,"file":"ConfirmDeleteLogEntry-BCRHdVTZ.js","sources":["../../../resources/js/components/log_entries/ConfirmDeleteLogEntry.vue"],"sourcesContent":["<script>\nimport {mapGetters} from 'vuex'\nimport {isValidationError} from '@/http'\nimport {logEntries, deleteEntry} from '@/adapters/log_entry_repository'\n\nexport default {\n    name: 'ConfirmDeleteLogEntry',\n    props: {\n        id: {\n            required: true,\n            type: String,\n        }\n    },\n    data() {\n        return {\n            errors: {}\n        }\n    },\n    computed: {\n        ...mapGetters({\n            group: 'groups/currentItemOrNew'\n        }),\n        application () {\n            return this.group.expert_panel;\n        },\n        logEntry () {\n            const logEntry = this.logEntries.find(entry => entry.id === this.id);\n            return logEntry || {};\n        },\n        logDate () {\n            return this.formatDate(this.logEntry.created_at)\n        },\n        flattenedErrors () {\n            return Object.values(this.errors).flat();\n        }\n    },\n    watch: {\n        logEntry: {\n            immediate: true,\n            handler () {\n                if (!this.logEntry.id) {\n                    this.$router.go(-1);\n                }\n            }\n        }\n    },\n    methods: {\n        async deleteEntry()\n        {\n            try {\n                // await this.$store.dispatch('applications/deleteLogEntry', {application: this.application, logEntry:  this.logEntry});\n                await deleteEntry(`/api/groups/${this.group.uuid}/activity-logs`, this.id)\n                this.$router.go(-1);\n            } catch ( error ) {\n                if (isValidationError(error)) {\n                    this.errors = error.response.data.errors;\n                }\n                this.errors = {a: error.message};\n                \n            }\n        }\n    },\n    setup () {\n        return {\n            logEntries\n        }\n    }\n}\n</script>\n<template>\n  <div>\n    <h2>You are about to delete the following log entry:</h2>\n    <div class=\"border-y py-2\">\n      <blockquote>\n        <div v-html=\"logEntry.description\" />\n      </blockquote>\n      <div v-if=\"logEntry.causer\" class=\"ml-4 mt-2 mb-4 text-gray-700 text-sm\">\n        Logged by {{ logEntry.causer.name }}, {{ logDate }}\n      </div>\n    </div>\n\n    <div>This can not be undone. Are you sure you want to continue?</div>\n\n    <div v-if=\"flattenedErrors.length > 0\" class=\"bg-red-200 text-red-900 rounded p-2 my-2\">\n      <ul>\n        <li v-for=\"(err,idx) in flattenedErrors\" :key=\"idx\">\n          {{ err }}\n        </li>\n      </ul> \n    </div>\n        \n    <button-row submit-text=\"Delete Log Entry\" @canceled=\"$router.go(-1)\" @submitted=\"deleteEntry\" />\n  </div>\n</template>\n<style lang=\"postcss\" scope>\n    blockquote {\n        @apply mt-4 ml-4 border-l-4 pl-2 text-gray-700;\n        font-size: 1.1rem;\n    }\n</style>"],"names":["_sfc_main","mapGetters","entry","deleteEntry","error","isValidationError","logEntries","_hoisted_1","_hoisted_2","_createElementBlock","_cache","_createElementVNode","$options","_openBlock","_hoisted_3","_toDisplayString","_createCommentVNode","_hoisted_4","_Fragment","_renderList","err","idx","_createVNode","_component_button_row","$event","_ctx"],"mappings":"kLAKA,MAAKA,EAAU,CACX,KAAM,wBACN,MAAO,CACH,GAAI,CACA,SAAU,GACV,KAAM,MACV,CACH,EACD,MAAO,CACH,MAAO,CACH,OAAQ,CAAA,CACZ,CACH,EACD,SAAU,CACN,GAAGC,EAAW,CACV,MAAO,yBACX,CAAC,EACD,aAAe,CACX,OAAO,KAAK,MAAM,YACrB,EACD,UAAY,CAER,OADiB,KAAK,WAAW,KAAKC,GAASA,EAAM,KAAO,KAAK,EAAE,GAChD,CAAE,CACxB,EACD,SAAW,CACP,OAAO,KAAK,WAAW,KAAK,SAAS,UAAU,CAClD,EACD,iBAAmB,CACf,OAAO,OAAO,OAAO,KAAK,MAAM,EAAE,KAAM,CAC5C,CACH,EACD,MAAO,CACH,SAAU,CACN,UAAW,GACX,SAAW,CACF,KAAK,SAAS,IACf,KAAK,QAAQ,GAAG,EAAE,CAE1B,CACJ,CACH,EACD,QAAS,CACL,MAAM,aACN,CACI,GAAI,CAEA,MAAMC,EAAY,eAAe,KAAK,MAAM,IAAI,iBAAkB,KAAK,EAAE,EACzE,KAAK,QAAQ,GAAG,EAAE,CACpB,OAAQC,EAAQ,CACVC,EAAkBD,CAAK,IACvB,KAAK,OAASA,EAAM,SAAS,KAAK,QAEtC,KAAK,OAAS,CAAC,EAAGA,EAAM,OAAO,CAEnC,CACJ,CACH,EACD,OAAS,CACL,MAAO,CACH,WAAAE,CACJ,CACJ,CACJ,EAKSC,EAAA,CAAA,MAAM,eAAe,EAxE9BC,EAAA,CAAA,WAAA,KAAA,IAAA,EA4EkC,MAAM,2CA5ExC,IAAA,EAmF2C,MAAM,uGAb/CC,EAsBM,MAAA,KAAA,CArBJC,EAAA,CAAA,IAAAA,EAAA,CAAA,EAAAC,EAAyD,UAArD,mDAAgD,EAAA,GACpDA,EAOM,MAPNJ,EAOM,CANJI,EAEa,aAAA,KAAA,CADXA,EAAqC,MAAA,CAAhC,UAAQC,EAAQ,SAAC,WA1E9B,EAAA,KAAA,EAAAJ,CAAA,IA4EiBI,EAAA,SAAS,QAApBC,EAAA,EAAAJ,EAEM,MAFNK,EAAyE,cAC1DC,EAAAH,EAAA,SAAS,OAAO,IAAI,EAAG,OAAKA,EAAO,OAAA,EAAA,CAAA,GA7ExDI,EAAA,GAAA,EAAA,IAiFIN,EAAA,CAAA,IAAAA,EAAA,CAAA,EAAAC,EAAqE,WAAhE,6DAA0D,EAAA,GAEpDC,EAAA,gBAAgB,OAAM,GAAjCC,IAAAJ,EAMM,MANNQ,EAMM,CALJN,EAIK,KAAA,KAAA,EAHHE,EAAA,EAAA,EAAAJ,EAEKS,OAvFbC,EAqFgCP,EAAA,gBArFhC,CAqFoBQ,EAAIC,KAAhBR,EAAA,EAAAJ,EAEK,KAFqC,CAAA,IAAKY,CAAG,IAC7CD,CAAG,EAAA,CAAA,eAtFhBJ,EAAA,GAAA,EAAA,EA2FIM,EAAiGC,EAAA,CAArF,cAAY,mBAAoB,WAAQb,EAAA,CAAA,IAAAA,EAAA,CAAA,EAAAc,GAAEC,EAAO,QAAC,GAAE,EAAA,GAAO,YAAWb,EAAW"}