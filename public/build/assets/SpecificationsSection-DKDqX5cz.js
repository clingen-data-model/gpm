import{_ as ve,an as Ae,aL as Ve,aM as Ee,aN as Pe,r as x,q as I,v as _e,y as Ie,o as Ue,c as i,d as e,f as M,h as v,C as q,D as ge,Z as Q,F,m as Y,w as B,j as d,e as te,a as U,i as y,a0 as Le,a5 as me,p as J,a2 as he,b as a,E as Ne,n as be,am as Me,A as Oe,a1 as Fe}from"./app-CyWjTue0.js";const Be={name:"VcepGeneList",components:{GeneSearchSelect:Pe,DiseaseSearchSelect:Ee,CuratedGeneSearchSelect:Ve,RichTextEditor:Ae},props:{readonly:{type:Boolean,required:!1,default:!1},editing:{type:Boolean,required:!1,default:!0}},emits:["saved"],setup(m,{emit:t}){const b=_e(),o=x([]),c=x(null),g=x(!1),D=x(!1),G=x(0),_=x({}),L=x([]),C=x([]),k=x(""),E=x(null),l=x(""),V=x(""),j=x(""),R=x("gene_symbol"),N=x("asc"),h=x(1),K=x(20),A=I(()=>b.getters["groups/currentItemOrNew"]),oe=I(()=>Ie(["ep-applications-manage",["application-edit",A.value]])&&!m.readonly),W=x(!1),z=x(null),le=s=>{z.value=s,W.value=!0},se=()=>{z.value=null,W.value=!1},$=async()=>{if(z.value)try{await J.delete(`/api/groups/${A.value.uuid}/expert-panel/genes/${z.value.id}`),W.value=!1,z.value=null,await n()}catch(s){b.commit("pushError",s.response.data)}},p=async()=>{try{const s=await J.get("/api/mois");L.value=s.data}catch(s){b.commit("pushError",s.response.data)}},n=async()=>{var s;if(A.value.uuid)try{await b.dispatch("groups/getGenes",A.value),o.value=A.value.expert_panel.genes}catch(f){b.commit("pushError",((s=f.response)==null?void 0:s.data)||f)}},r=s=>{R.value===s?N.value=N.value==="asc"?"desc":"asc":(R.value=s,N.value="asc")},T=()=>{D.value=!0,g.value=!1,c.value=null,G.value++},w=s=>{var f,u,S;D.value=!0,g.value=s.id,(f=s.plan)!=null&&f.is_other?c.value={id:s.id,is_other:!0,custom_gene:{hgnc_id:s.hgnc_id,gene_symbol:s.gene_symbol},custom_disease:{mondo_id:s.mondo_id,name:s.disease_name},custom_moi:L.value.find(P=>P.abbreviation===s.moi)||null,custom_plan:s.plan.the_plan||""}:c.value={id:s.id,hgnc_id:s.hgnc_id,gene_symbol:s.gene_symbol,disease_name:s.disease_name,mondo_id:s.mondo_id,moi:s.moi,date_approved:s.date_approved,requires_plan:["Moderate","Limited"].includes((u=s.plan)==null?void 0:u.classification),plan:s.plan,curated_plan_text:((S=s.plan)==null?void 0:S.the_plan)||"",is_other:!1},G.value++},X=()=>{D.value=!1,g.value=!1,c.value=null,_.value={}},Z=I(()=>{var s,f,u,S;return(s=c.value)!=null&&s.is_other?!!((f=c.value.custom_gene)!=null&&f.hgnc_id)&&!!((u=c.value.custom_disease)!=null&&u.mondo_id)&&((S=c.value.custom_plan)==null?void 0:S.trim().length)>=20:!1}),ie=()=>{var f;const s=((f=c.value)==null?void 0:f.id)||null;c.value={id:s,is_other:!0,custom_gene:null,custom_disease:null,custom_moi:null,custom_plan:""}},re=s=>{s&&!s.is_other&&(c.value={...s,is_other:!1,requires_plan:["Moderate","Limited"].includes(s.classification),curated_plan_text:""})},de=I(()=>{var f;return(f=c.value)!=null&&f.requires_plan?(c.value.curated_plan_text||"").replace(/<[^>]+>/g,"").trim().length>=20:!0}),ue=async()=>{var s,f,u,S,P,O,ae;try{let ee;if(c.value.is_other){const pe={is_other:!0,the_plan:c.value.custom_plan,moi_name:((s=c.value.custom_moi)==null?void 0:s.name)||"",hp_id:((f=c.value.custom_moi)==null?void 0:f.hp_id)||""};ee={is_other:!0,hgnc_id:((u=c.value.custom_gene)==null?void 0:u.hgnc_id)||null,gene_symbol:((S=c.value.custom_gene)==null?void 0:S.gene_symbol)||"",disease_name:((P=c.value.custom_disease)==null?void 0:P.name)||"",mondo_id:((O=c.value.custom_disease)==null?void 0:O.mondo_id)||"",moi:((ae=c.value.custom_moi)==null?void 0:ae.abbreviation)||"",plan:pe,date_approved:null}}else{const pe={...c.value};pe.requires_plan=!!c.value.requires_plan,c.value.requires_plan&&(pe.the_plan=c.value.curated_plan_text||""),ee={hgnc_id:c.value.hgnc_id,gene_symbol:c.value.gene_symbol,disease_name:c.value.disease_name,mondo_id:c.value.mondo_id,moi:c.value.moi,date_approved:c.value.date_approved,plan:c.value,is_other:!1}}g.value?await J.put(`/api/groups/${A.value.uuid}/expert-panel/genes/${g.value}`,ee):await J.post(`/api/groups/${A.value.uuid}/expert-panel/genes`,{genes:[ee]}),await n(),X(),t("saved")}catch(ee){he(ee)?_.value=ee.response.data.errors:b.commit("pushError",ee.response.data)}},ce=async s=>{try{await J.delete(`/api/groups/${A.value.uuid}/expert-panel/genes/${s.id}`),await n()}catch(f){b.commit("pushError",f.response.data)}},H=async s=>{E.value=s.id;const f=s.tier;try{await J.put(`/api/groups/${A.value.uuid}/expert-panel/genes/update-tier`,{ids:[s.id],tier:s.tier||null}),b.commit("pushSuccess",`Tier updated for ${s.gene_symbol}`)}catch{s.tier=f,b.commit("pushError","Failed to update tier")}finally{E.value=null}},xe=async()=>{if(!(!k.value||C.value.length===0))try{await J.put(`/api/groups/${A.value.uuid}/expert-panel/genes/update-tier`,{ids:C.value,tier:k.value}),b.commit("pushSuccess",`Tier updated for ${C.value.length} genes`),C.value=[],await n(),k.value=""}catch{b.commit("pushError","Failed to update tiers in bulk")}},ke=s=>{C.value.includes(s)?C.value=C.value.filter(f=>f!==s):C.value.push(s)},we=()=>{const s=fe.value.map(u=>u.id);s.every(u=>C.value.includes(u))?C.value=C.value.filter(u=>!s.includes(u)):C.value=[...new Set([...C.value,...s])]},ye=I(()=>{let s=[...o.value];const f=l.value.toLowerCase();return f&&(s=s.filter(u=>{var S,P,O,ae;return u.gene_symbol&&u.gene_symbol.toLowerCase().includes(f)||u.mondo_id&&u.mondo_id.toLowerCase().includes(f)||u.disease_name&&u.disease_name.toLowerCase().includes(f)||u.moi&&u.moi.toLowerCase().includes(f)||((S=u.plan)==null?void 0:S.the_plan)&&u.plan.the_plan.toLowerCase().includes(f)||((P=u.plan)==null?void 0:P.expert_panel)&&u.plan.expert_panel.toLowerCase().includes(f)||((O=u.plan)==null?void 0:O.classification)&&u.plan.classification.toLowerCase().includes(f)||((ae=u.plan)==null?void 0:ae.phenotypes)&&u.plan.phenotypes.toLowerCase().includes(f)})),V.value&&(s=s.filter(u=>u.moi===V.value)),j.value&&(s=s.filter(u=>{var S;return((S=u.plan)==null?void 0:S.classification)===j.value})),s.sort((u,S)=>{let P,O;switch(R.value){case"disease":P=`${u.mondo_id||""} ${u.disease_name||""}`.toLowerCase(),O=`${S.mondo_id||""} ${S.disease_name||""}`.toLowerCase();break;case"moi":P=u.moi||"",O=S.moi||"";break;case"tier":return P=u.tier?Number(u.tier):0,O=S.tier?Number(S.tier):0,N.value==="asc"?P-O:O-P;default:P=u.gene_symbol||"",O=S.gene_symbol||""}return N.value==="asc"?P.localeCompare(O):O.localeCompare(P)}),s}),Ce=async s=>{var f;try{const u=s.gt_data;if(!u)return;const S={is_other:!1,hgnc_id:u.hgnc_id,gene_symbol:u.gene_symbol,disease_name:u.disease_name,mondo_id:u.mondo_id,moi:u.moi,date_approved:u.date_approved,requires_plan:["Moderate","Limited"].includes((f=u.plan)==null?void 0:f.classification),plan:{...u,checkKey:u.checkKey}};await J.put(`/api/groups/${A.value.uuid}/expert-panel/genes/${s.id}`,S),b.commit("pushSuccess",`Updated ${s.gene_symbol} from GeneTracker`),await n()}catch{b.commit("pushError","Failed to apply update from GeneTracker")}},Se=I(()=>[...new Set(o.value.map(s=>s.moi).filter(Boolean))]),Te=I(()=>[...new Set(o.value.map(s=>{var f;return(f=s.plan)==null?void 0:f.classification}).filter(Boolean))]),De=I(()=>Math.ceil(ye.value.length/K.value)),fe=I(()=>{const s=(h.value-1)*K.value;return ye.value.slice(s,s+K.value)}),Ge=I(()=>fe.value.every(s=>C.value.includes(s.id)));Ue(()=>{n(),p()});const ne=x([]);return{group:A,genes:o,formGene:c,curatedGeneKey:G,isEditing:g,isFormVisible:D,mois:L,errors:_,search:l,filterMoi:V,filterClassification:j,sortKey:R,sortOrder:N,pageSize:K,currentPage:h,totalPages:De,paginatedGenes:fe,filteredAndSortedGenes:ye,moiOptions:Se,classificationOptions:Te,selectedGenes:C,bulkTier:k,savingTierFor:E,isAllSelected:Ge,canEdit:oe,isOtherFormValid:Z,isCuratedPlanValid:de,toggleExpanded:s=>{ne.value.includes(s)?ne.value=ne.value.filter(f=>f!==s):ne.value.push(s)},expanded:ne,showConfirmRemove:W,selectedGene:z,confirmRemove:le,cancelRemove:se,removeGene:$,setSort:r,startAdd:T,startEdit:w,cancelForm:X,selectOther:ie,handleCuratedSelection:re,saveForm:ue,remove:ce,updateTier:H,applyBulkTier:xe,toggleSelect:ke,toggleSelectAll:we,applyGtUpdate:Ce}}},Re={class:"flex justify-between items-center mb-4"},qe={key:0,class:"flex items-center gap-2"},je=["disabled"],Ke={class:"flex items-center gap-4"},ze=["value"],He=["value"],Ye={class:"flex items-center gap-2"},Ze=["value"],Je={key:0,class:"border rounded bg-gray-50 p-4 mb-4"},Qe={class:"text-lg font-semibold mb-3"},We={key:0,class:"space-y-2"},Xe={key:0,class:"mt-3 border rounded bg-amber-50 p-3"},$e={class:"flex items-start gap-2 mb-2"},et={class:"text-sm text-gray-800"},tt={key:0,class:"text-xs text-red-500 mt-1"},ot={key:1,class:"border rounded bg-white p-3 mt-3"},lt={class:"grid grid-cols-2 gap-2"},st={key:0,class:"text-red-500 text-xs mt-1"},nt=["value"],at={key:0,class:"text-red-500 text-xs mt-1"},it={class:"col-span-2"},rt={class:"col-span-2 mb-3"},dt={key:0,class:"text-red-500 text-xs mt-1"},ut={class:"mt-4 flex justify-end gap-2"},ct=["disabled"],pt={key:0,class:"flex items-center gap-2 bg-gray-50 p-3 border rounded mb-3"},mt=["disabled"],vt={key:1,class:"border-none w-full"},yt={key:0},ft=["checked"],bt={key:0},_t={key:0},gt={key:0},ht={key:0},xt={key:0},kt={key:0},wt=["checked","onChange"],Ct={class:"text-xs"},St={key:0,class:"grid grid-cols-2 gap-x-4 text-gray-600"},Tt={key:0,class:"font-bold text-orange-500"},Dt={class:"col-span-2"},Gt={key:0,class:"col-span-2"},At=["innerHTML"],Vt=["innerHTML"],Et={key:0,class:"flex flex-col gap-1"},Pt=["onUpdate:modelValue","onChange","disabled"],It=["onClick"],Ut={key:1},Lt={key:0},Nt=["colspan"],Mt={role:"status","aria-live":"polite",class:"rounded-md border border-amber-300 bg-amber-50 px-3 py-2 text-xs text-amber-900 col-span-2"},Ot={class:"flex items-start gap-2"},Ft={class:"text-amber-900/80"},Bt=["onClick"],Rt={key:1},qt=["onClick"],jt=["colspan"],Kt={class:"grid grid-cols-2 gap-x-4 text-gray-600"},zt={key:0,class:"font-bold text-orange-500"},Ht={class:"col-span-2"},Yt=["onClick"],Zt={class:"mt-4 flex justify-between items-center"},Jt=["disabled"],Qt=["disabled"],Wt={key:2,class:"fixed inset-0 flex items-center justify-center bg-black bg-opacity-50 z-50"},Xt={class:"bg-white rounded-lg shadow-lg w-96 p-6"},$t={class:"mb-6"},eo={class:"flex justify-end gap-2"};function to(m,t,b,o,c,g){var E;const D=U("CuratedGeneSearchSelect"),G=U("RichTextEditor"),_=U("GeneSearchSelect"),L=U("DiseaseSearchSelect"),C=U("dropdown-item"),k=U("dropdown-menu");return a(),i("div",null,[e("div",Re,[b.editing?(a(),i("div",qe,[e("button",{class:"btn blue",onClick:t[0]||(t[0]=(...l)=>o.startAdd&&o.startAdd(...l)),disabled:o.isFormVisible}," + Add Gene ",8,je)])):v("",!0),e("div",Ke,[q(e("input",{"onUpdate:modelValue":t[1]||(t[1]=l=>o.search=l),type:"text",placeholder:"Search genes, diseases, MOI, notes...",class:"border rounded px-2 py-1 text-sm"},null,512),[[ge,o.search]]),q(e("select",{"onUpdate:modelValue":t[2]||(t[2]=l=>o.filterMoi=l),class:"border p-1 rounded text-sm"},[t[25]||(t[25]=e("option",{value:""},"All MOIs",-1)),(a(!0),i(F,null,Y(o.moiOptions,l=>(a(),i("option",{key:l,value:l},d(l),9,ze))),128))],512),[[Q,o.filterMoi]]),q(e("select",{"onUpdate:modelValue":t[3]||(t[3]=l=>o.filterClassification=l),class:"border p-1 rounded text-sm"},[t[26]||(t[26]=e("option",{value:""},"All Classifications",-1)),(a(!0),i(F,null,Y(o.classificationOptions,l=>(a(),i("option",{key:l,value:l},d(l),9,He))),128))],512),[[Q,o.filterClassification]]),e("div",Ye,[t[27]||(t[27]=e("label",{class:"text-sm"},"Page size:",-1)),q(e("select",{"onUpdate:modelValue":t[4]||(t[4]=l=>o.pageSize=l),class:"border px-2 py-1 rounded text-sm"},[(a(),i(F,null,Y([20,50,100],l=>e("option",{key:l,value:l},d(l),9,Ze)),64))],512),[[Q,o.pageSize]])])])]),M(Le,{name:"fade"},{default:B(()=>{var l,V,j,R,N;return[o.isFormVisible?(a(),i("div",Je,[e("h3",Qe,d(o.isEditing?"Edit Gene":"Add Gene"),1),(l=o.formGene)!=null&&l.is_other?v("",!0):(a(),i("div",We,[t[33]||(t[33]=e("label",{class:"block font-semibold"},"Select Gene-Disease-MOI:",-1)),(a(),te(D,{modelValue:o.formGene,"onUpdate:modelValue":[t[5]||(t[5]=h=>o.formGene=h),o.handleCuratedSelection],placeholder:"Search curated Gene-Disease-MOI",class:"w-full",key:o.curatedGeneKey},null,8,["modelValue","onUpdate:modelValue"])),e("button",{type:"button",class:"text-blue-600 underline text-sm hover:text-blue-800",onClick:t[6]||(t[6]=(...h)=>o.selectOther&&o.selectOther(...h))},t[28]||(t[28]=[y(" Click here for "),e("strong",null,"Other (Not Curated)",-1)])),(V=o.formGene)!=null&&V.requires_plan?(a(),i("div",Xe,[e("div",$e,[t[31]||(t[31]=e("span",{class:"text-orange-500 font-bold"},"⚠",-1)),e("div",et,[t[29]||(t[29]=y(" This gene’s classification is ")),e("strong",null,d((j=o.formGene.plan)==null?void 0:j.classification),1),t[30]||(t[30]=y(". Please describe your plan for curation. "))])]),t[32]||(t[32]=e("label",{class:"block text-sm font-medium mb-1"},"Plan for Curation *",-1)),M(G,{modelValue:o.formGene.curated_plan_text,"onUpdate:modelValue":t[7]||(t[7]=h=>o.formGene.curated_plan_text=h),placeholder:"Describe your plan (min 20 characters)",class:"w-full"},null,8,["modelValue"]),o.isCuratedPlanValid?v("",!0):(a(),i("p",tt," Plan must be at least 20 characters. "))])):v("",!0)])),o.formGene&&o.formGene.is_other?(a(),i("div",ot,[t[39]||(t[39]=e("h5",{class:"text-lg font-semibold mb-2"},"Provide details for non-curated gene",-1)),e("div",lt,[e("div",null,[t[34]||(t[34]=e("label",{class:"block text-sm font-medium mb-1"},"Gene *",-1)),M(_,{modelValue:o.formGene.custom_gene,"onUpdate:modelValue":t[8]||(t[8]=h=>o.formGene.custom_gene=h),placeholder:"Search gene..."},null,8,["modelValue"]),o.errors.custom_gene?(a(),i("p",st,d(o.errors.custom_gene[0]),1)):v("",!0)]),e("div",null,[t[36]||(t[36]=e("label",{class:"block text-sm font-medium mb-1"},"MOI",-1)),q(e("select",{"onUpdate:modelValue":t[9]||(t[9]=h=>o.formGene.custom_moi=h),class:"form-select w-full"},[t[35]||(t[35]=e("option",{value:""},"----Select MOI-----",-1)),(a(!0),i(F,null,Y(o.mois,h=>(a(),i("option",{key:h.id,value:h},d(h.name)+" ("+d(h.abbreviation)+")",9,nt))),128))],512),[[Q,o.formGene.custom_moi]]),o.errors.custom_moi?(a(),i("p",at,d(o.errors.custom_moi[0]),1)):v("",!0)]),e("div",it,[t[37]||(t[37]=e("label",{class:"block text-sm font-medium mb-1"},"Disease *",-1)),M(L,{modelValue:o.formGene.custom_disease,"onUpdate:modelValue":t[10]||(t[10]=h=>o.formGene.custom_disease=h),placeholder:"Search disease..."},null,8,["modelValue"])]),e("div",rt,[t[38]||(t[38]=e("label",{class:"block text-sm font-medium mb-1"},"Plan for Curation *",-1)),M(G,{modelValue:o.formGene.custom_plan,"onUpdate:modelValue":t[11]||(t[11]=h=>o.formGene.custom_plan=h),placeholder:"Describe your plan (min 20 characters)",class:"w-full"},null,8,["modelValue"]),o.errors.custom_plan?(a(),i("p",dt,d(o.errors.custom_plan[0]),1)):v("",!0)])])])):v("",!0),e("div",ut,[e("button",{class:"btn btn-gray",onClick:t[12]||(t[12]=(...h)=>o.cancelForm&&o.cancelForm(...h))},"Cancel"),e("button",{class:"btn blue",disabled:o.isEditing?!1:((R=o.formGene)==null?void 0:R.is_other)&&!o.isOtherFormValid||!((N=o.formGene)!=null&&N.is_other)&&!o.isCuratedPlanValid,onClick:t[13]||(t[13]=(...h)=>o.saveForm&&o.saveForm(...h))}," Save ",8,ct)])])):v("",!0)]}),_:1}),o.selectedGenes.length>0&&!b.readonly?(a(),i("div",pt,[t[41]||(t[41]=e("span",{class:"font-semibold"},"Bulk Tier Update:",-1)),q(e("select",{"onUpdate:modelValue":t[14]||(t[14]=l=>o.bulkTier=l),class:"border rounded px-2 py-1 text-sm"},t[40]||(t[40]=[me('<option value="" data-v-3b22743b>Select Tier</option><option value="1" data-v-3b22743b>Tier 1</option><option value="2" data-v-3b22743b>Tier 2</option><option value="3" data-v-3b22743b>Tier 3</option><option value="4" data-v-3b22743b>Tier 4</option>',5)]),512),[[Q,o.bulkTier]]),e("button",{class:"bg-blue-600 text-white px-3 py-1 rounded disabled:opacity-50",onClick:t[15]||(t[15]=(...l)=>o.applyBulkTier&&o.applyBulkTier(...l)),disabled:!o.bulkTier||o.selectedGenes.length===0}," Apply ",8,mt)])):v("",!0),o.genes?(a(),i("table",vt,[e("thead",null,[e("tr",null,[o.canEdit&&b.editing?(a(),i("th",yt,[e("input",{type:"checkbox",checked:o.isAllSelected,onChange:t[16]||(t[16]=(...l)=>o.toggleSelectAll&&o.toggleSelectAll(...l))},null,40,ft)])):v("",!0),e("th",{onClick:t[17]||(t[17]=l=>o.setSort("gene_symbol")),class:"cursor-pointer"},[t[42]||(t[42]=y(" HGNC Symbol ")),o.sortKey==="gene_symbol"?(a(),i("span",bt,d(o.sortOrder==="asc"?"▲":"▼"),1)):v("",!0)]),e("th",{onClick:t[18]||(t[18]=l=>o.setSort("disease")),class:"cursor-pointer"},[t[43]||(t[43]=y(" Disease ")),o.sortKey==="disease"?(a(),i("span",_t,d(o.sortOrder==="asc"?"▲":"▼"),1)):v("",!0)]),e("th",{onClick:t[19]||(t[19]=l=>o.setSort("moi")),class:"cursor-pointer"},[t[44]||(t[44]=y(" MOI ")),o.sortKey==="moi"?(a(),i("span",gt,d(o.sortOrder==="asc"?"▲":"▼"),1)):v("",!0)]),t[46]||(t[46]=e("th",null,"Plan",-1)),e("th",{onClick:t[20]||(t[20]=l=>o.setSort("tier")),class:"cursor-pointer"},[t[45]||(t[45]=y(" Tier ")),o.sortKey==="tier"?(a(),i("span",ht,d(o.sortOrder==="asc"?"▲":"▼"),1)):v("",!0)])])]),o.paginatedGenes.length===0?(a(),i("tbody",xt,t[47]||(t[47]=[e("tr",null,[e("td",{colspan:"6",class:"p-3 text-center"},"No genes found.")],-1)]))):v("",!0),e("tbody",null,[(a(!0),i(F,null,Y(o.paginatedGenes,(l,V)=>{var j,R,N,h,K,A,oe,W,z,le,se,$,p,n,r,T,w,X,Z,ie,re,de,ue,ce;return a(),i(F,{key:l.id},[e("tr",{style:Ne(((j=l.plan)==null?void 0:j.classification)==="Moderate"?"background-color: oklch(98.7% 0.026 102.212);":((R=l.plan)==null?void 0:R.classification)==="Limited"||l.is_outdated?"background-color: oklch(97.3% 0.071 103.193);":"")},[o.canEdit&b.editing?(a(),i("td",kt,[e("input",{type:"checkbox",checked:o.selectedGenes.includes(l.id),onChange:H=>o.toggleSelect(l.id)},null,40,wt)])):v("",!0),e("td",null,d(l.gene_symbol),1),e("td",null,[y(d(l.mondo_id),1),t[48]||(t[48]=e("br",null,null,-1)),y(d(l.disease_name),1)]),e("td",null,d(l.moi),1),e("td",Ct,[(N=l.plan)!=null&&N.is_other?(a(),i("div",{key:1,innerHTML:(p=l.plan)==null?void 0:p.the_plan},null,8,Vt)):(a(),i("div",St,[e("div",null,[t[49]||(t[49]=e("strong",null,"Expert Panel:",-1)),y(" "+d(((h=l.plan)==null?void 0:h.expert_panel)??"N/A"),1)]),e("div",null,[t[50]||(t[50]=e("strong",null,"Classification:",-1)),y(" "+d(((K=l.plan)==null?void 0:K.classification)??"N/A")+" ",1),["Moderate","Limited"].includes((A=l.plan)==null?void 0:A.classification)?(a(),i("span",Tt,"⚠")):v("",!0)]),e("div",null,[t[51]||(t[51]=e("strong",null,"Status:",-1)),y(" "+d(((oe=l.plan)==null?void 0:oe.curation_status)??"N/A"),1)]),e("div",null,[t[52]||(t[52]=e("strong",null,"Date Approved:",-1)),y(" "+d((W=l.plan)!=null&&W.date_approved?new Date((z=l.plan)==null?void 0:z.date_approved).toLocaleDateString():"N/A"),1)]),e("div",Dt,[t[53]||(t[53]=e("strong",null,"Phenotypes:",-1)),y(" "+d(((le=l.plan)==null?void 0:le.phenotypes)??"N/A"),1)]),(se=l.plan)!=null&&se.requires_plan?(a(),i("div",Gt,[t[54]||(t[54]=e("strong",null,"Plan:",-1)),t[55]||(t[55]=y()),e("span",{innerHTML:($=l.plan)==null?void 0:$.curated_plan_text},null,8,At)])):v("",!0)]))]),e("td",null,[b.editing?(a(),i("div",Et,[q(e("select",{"onUpdate:modelValue":H=>l.tier=H,class:"border rounded px-1 py-0.5 text-sm",onChange:H=>o.updateTier(l),disabled:o.savingTierFor===l.id||b.readonly},t[56]||(t[56]=[me('<option value="null" data-v-3b22743b>—</option><option value="1" data-v-3b22743b>Tier 1</option><option value="2" data-v-3b22743b>Tier 2</option><option value="3" data-v-3b22743b>Tier 3</option><option value="4" data-v-3b22743b>Tier 4</option>',5)]),40,Pt),[[Q,l.tier]]),l.is_outdated&&l.gt_data?(a(),i("button",{key:0,onClick:H=>o.applyGtUpdate(l),class:"btn btn-xs w-full text-center text-amber-800 font-semibold",title:"Snapshot differs from latest GeneTracker data"}," Refresh data from GT ⚠ ",8,It)):v("",!0),l.toDelete?v("",!0):(a(),te(k,{key:1,"hide-cheveron":!0,class:"relative"},{label:B(()=>t[57]||(t[57]=[e("button",{class:"btn btn-xs w-full text-center"},"⋯",-1)])),default:B(()=>[M(C,{onClick:H=>o.startEdit(l)},{default:B(()=>t[58]||(t[58]=[y("Edit")])),_:2},1032,["onClick"]),M(C,{onClick:H=>o.confirmRemove(l)},{default:B(()=>t[59]||(t[59]=[y("Remove")])),_:2},1032,["onClick"])]),_:2},1024))])):(a(),i("span",Ut,d(l.tier||"—"),1))])],4),l.is_outdated&&l.gt_data?(a(),i("tr",Lt,[e("td",{colspan:b.editing?6:5},[e("div",Mt,[e("div",Ot,[t[62]||(t[62]=y(" ⚠ ")),e("div",null,[t[61]||(t[61]=e("div",{class:"font-medium"},"Snapshot out of date",-1)),e("div",Ft,[t[60]||(t[60]=y("This record differs from the latest GeneTracker data. ")),e("span",{onClick:H=>l.is_outdated&&o.toggleExpanded(V),class:"underline cursor-pointer font-semibold"},d(o.expanded.includes(V)?"Hide":"View")+" GeneTracker data ",9,Bt)])])])])],8,Nt)])):v("",!0),l.is_outdated&&l.gt_data&&o.expanded.includes(V)?(a(),i("tr",Rt,[b.editing?(a(),i("td",{key:0,onClick:H=>o.toggleExpanded(V)},t[63]||(t[63]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",width:"18",height:"18",viewBox:"0 0 20 20","aria-labelledby":"box",role:"presentation",name:"cheveron-down",class:"m-auto cursor-pointer"},[e("title",{id:"box",lang:"en"},"box"),e("g",{fill:"currentColor"},[e("path",{d:"M9.293 12.95l.707.707L15.657 8l-1.414-1.414L10 10.828 5.757 6.586 4.343 8z"})])],-1)]),8,qt)):v("",!0),e("td",null,d((n=l.gt_data)==null?void 0:n.gene_symbol),1),e("td",null,[y(d((r=l.gt_data)==null?void 0:r.mondo_id),1),t[64]||(t[64]=e("br",null,null,-1)),y(d((T=l.gt_data)==null?void 0:T.disease_name),1)]),e("td",null,d((w=l.gt_data)==null?void 0:w.moi),1),e("td",{class:"text-xs",colspan:b.editing?2:1},[e("div",Kt,[e("div",null,[t[65]||(t[65]=e("strong",null,"Expert Panel:",-1)),y(" "+d(((X=l.gt_data)==null?void 0:X.expert_panel)??"N/A"),1)]),e("div",null,[t[66]||(t[66]=e("strong",null,"Classification:",-1)),y(" "+d(((Z=l.gt_data)==null?void 0:Z.classification)??"N/A")+" ",1),["Moderate","Limited"].includes((ie=l.gt_data)==null?void 0:ie.classification)?(a(),i("span",zt,"⚠")):v("",!0)]),e("div",null,[t[67]||(t[67]=e("strong",null,"Status:",-1)),y(" "+d(((re=l.gt_data)==null?void 0:re.curation_status)??"N/A"),1)]),e("div",null,[t[68]||(t[68]=e("strong",null,"Date Approved:",-1)),y(" "+d((de=l.gt_data)!=null&&de.date_approved?new Date((ue=l.gt_data)==null?void 0:ue.date_approved).toLocaleDateString():"N/A"),1)]),e("div",Ht,[t[69]||(t[69]=e("strong",null,"Phenotypes:",-1)),y(" "+d(((ce=l.gt_data)==null?void 0:ce.phenotypes)??"N/A"),1)])])],8,jt),b.editing?v("",!0):(a(),i("td",{key:1,onClick:H=>o.toggleExpanded(V)}," Hide ",8,Yt))])):v("",!0)],64)}),128))])])):v("",!0),e("div",Zt,[e("button",{class:"btn btn-gray",disabled:o.currentPage===1,onClick:t[21]||(t[21]=l=>o.currentPage--)},"Prev",8,Jt),e("span",null,"Page "+d(o.currentPage)+" of "+d(o.totalPages),1),e("button",{class:"btn btn-gray",disabled:o.currentPage===o.totalPages,onClick:t[22]||(t[22]=l=>o.currentPage++)},"Next",8,Qt)]),o.showConfirmRemove?(a(),i("div",Wt,[e("div",Xt,[t[72]||(t[72]=e("h3",{class:"text-lg font-semibold mb-4"},"Confirm Removal",-1)),e("p",$t,[t[70]||(t[70]=y("Are you sure you want to remove ")),e("strong",null,d((E=o.selectedGene)==null?void 0:E.gene_symbol),1),t[71]||(t[71]=y("?"))]),e("div",eo,[e("button",{class:"btn btn-gray",onClick:t[23]||(t[23]=(...l)=>o.cancelRemove&&o.cancelRemove(...l))},"Cancel"),e("button",{class:"btn btn-red",onClick:t[24]||(t[24]=(...l)=>o.removeGene&&o.removeGene(...l))},"Remove")])])])):v("",!0)])}const al=ve(Be,[["render",to],["__scopeId","data-v-3b22743b"]]),oo={class:"space-y-4"},lo={class:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-2"},so={class:"flex items-center gap-2"},no=["value"],ao={class:"flex items-center gap-2"},io=["value"],ro={key:0,class:"flex items-center gap-2 bg-gray-50 p-3 border rounded mb-3"},uo=["disabled"],co={class:"border"},po={class:"table-auto w-full border min-w-full"},mo={class:"bg-gray-100 sticky top-0 z-10"},vo={key:0,class:"px-2"},yo=["checked","disabled"],fo={key:0},bo={key:0},_o={key:0},go={class:"hover:bg-gray-50"},ho={key:0,class:"px-2"},xo=["checked","onChange","disabled"],ko=["onClick"],wo=["onClick"],Co={class:"px-4 py-2"},So=["onUpdate:modelValue","onChange","disabled"],To={key:0,class:"ml-2 text-gray-500"},Do={key:1},Go={key:0},Ao={colspan:"4",class:"bg-gray-100 px-6 py-3 text-sm"},Vo={class:"grid grid-cols-2 text-sm text-gray-700"},Eo={class:"flex justify-center items-center gap-2 mt-4"},Po=["disabled"],Io={class:"text-sm"},Uo=["disabled"],il={__name:"GeneCurationStatus",props:{genes:{type:Array,required:!0,default:()=>[]},groupID:{type:String,required:!0},editing:{type:Boolean,default:!0},readonly:{type:Boolean,default:!1}},setup(m){const t=m,b=_e(),o=x(""),c=x(1),g=x(20),D=x(null),G=x([]),_=x([]),L=x(""),C=x(!1),k=x("gene_symbol"),E=x("asc"),l=x(""),V={"Not Curated":0,Uploaded:1,Precuration:2,"Disease entity assigned":3,"Precuration Complete":4,"Curation Provisional":5,"Curation Approved":6,"Recuration assigned":7,"Retired Assignment":8,Published:9},j=I(()=>{const p=new Set;return t.genes.forEach(n=>n.statuses.forEach(r=>p.add(r))),Array.from(p).sort((n,r)=>V[n]-V[r])}),R=I(()=>{const p=o.value.toLowerCase();return t.genes.filter(n=>{const r=n.gene_symbol.toLowerCase().includes(p),T=n.statuses.some(Z=>Z.toLowerCase().includes(p)),w=!o.value||r||T,X=!l.value||n.statuses.includes(l.value);return w&&X})}),N=I(()=>[...R.value].sort((p,n)=>{let r,T;if(k.value==="statuses"){const w=Math.max(...p.statuses.map(Z=>V[Z]||0)),X=Math.max(...n.statuses.map(Z=>V[Z]||0));r=w,T=X}else k.value==="tier"?(r=p.tier||0,T=n.tier||0):(r=p.gene_symbol,T=n.gene_symbol);return E.value==="asc"?r>T?1:-1:r<T?1:-1})),h=I(()=>Math.ceil(N.value.length/g.value)),K=I(()=>{const p=(c.value-1)*g.value;return N.value.slice(p,p+g.value)}),A=p=>{G.value.includes(p)?G.value=G.value.filter(n=>n!==p):G.value.push(p)},oe=p=>{_.value.includes(p)?_.value=_.value.filter(n=>n!==p):_.value.push(p)},W=()=>{const p=K.value.map(r=>r.id);p.every(r=>_.value.includes(r))?_.value=_.value.filter(r=>!p.includes(r)):_.value=[...new Set([..._.value,...p])]},z=I(()=>K.value.every(p=>_.value.includes(p.id))),le=async p=>{var r;if(console.log(t.groupID),t.readonly||!t.editing)return;D.value=p.id;const n=p.tier;try{await J.put(`/api/groups/${t.groupID}/expert-panel/genes/update-tier`,{ids:[p.id],tier:p.tier||null}),b.commit("pushSuccess",`Tier updated for ${p.gene_symbol}`)}catch(T){p.tier=n,b.commit("pushError",`Failed to update tier for ${p.gene_symbol}`),console.error(((r=T.response)==null?void 0:r.data)||T.message)}finally{D.value=null}},se=async()=>{if(!(!L.value||_.value.length===0)){C.value=!0;try{await J.put(`/api/groups/${t.groupID}/expert-panel/genes/update-tier`,{ids:_.value,tier:L.value}),b.commit("pushSuccess",`Tier updated for ${_.value.length} genes`),t.genes.forEach(p=>{_.value.includes(p.id)&&(p.tier=L.value)}),_.value=[],L.value=""}catch{b.commit("pushError","Failed to update tiers in bulk")}finally{C.value=!1}}},$=p=>{k.value===p?E.value=E.value==="asc"?"desc":"asc":(k.value=p,E.value="asc")};return(p,n)=>(a(),i("div",oo,[e("div",lo,[q(e("input",{"onUpdate:modelValue":n[0]||(n[0]=r=>o.value=r),type:"text",placeholder:"Search gene or status...",class:"border px-3 py-1.5 rounded text-sm w-full sm:w-64"},null,512),[[ge,o.value]]),e("div",so,[n[10]||(n[10]=e("label",{class:"text-sm"},"Filter by Status:",-1)),q(e("select",{"onUpdate:modelValue":n[1]||(n[1]=r=>l.value=r),class:"border rounded px-2 py-1 text-sm"},[n[9]||(n[9]=e("option",{value:""},"All",-1)),(a(!0),i(F,null,Y(j.value,r=>(a(),i("option",{key:r,value:r},d(r),9,no))),128))],512),[[Q,l.value]])]),e("div",ao,[n[11]||(n[11]=e("label",{class:"text-sm"},"Page size:",-1)),q(e("select",{"onUpdate:modelValue":n[2]||(n[2]=r=>g.value=r),class:"border px-2 py-1 rounded text-sm"},[(a(),i(F,null,Y([20,50,100],r=>e("option",{key:r,value:r},d(r),9,io)),64))],512),[[Q,g.value]])])]),_.value.length>0&&m.editing&&!m.readonly?(a(),i("div",ro,[n[13]||(n[13]=e("span",{class:"font-semibold"},"Bulk Tier Update:",-1)),q(e("select",{"onUpdate:modelValue":n[3]||(n[3]=r=>L.value=r),class:"border rounded px-2 py-1 text-sm"},n[12]||(n[12]=[me('<option value="">Select Tier</option><option value="1">Tier 1</option><option value="2">Tier 2</option><option value="3">Tier 3</option><option value="4">Tier 4</option>',5)]),512),[[Q,L.value]]),e("button",{class:"bg-blue-600 text-white px-3 py-1 rounded disabled:opacity-50",onClick:se,disabled:!L.value||_.value.length===0}," Apply ",8,uo)])):v("",!0),e("div",co,[e("table",po,[e("thead",mo,[e("tr",null,[m.editing&&!m.readonly?(a(),i("th",vo,[e("input",{type:"checkbox",checked:z.value,onChange:W,disabled:m.readonly||!m.editing},null,40,yo)])):v("",!0),e("th",{class:"text-left px-4 py-2 cursor-pointer",onClick:n[4]||(n[4]=r=>$("gene_symbol"))},[n[14]||(n[14]=y(" Gene ")),k.value==="gene_symbol"?(a(),i("span",fo,d(E.value==="asc"?"▲":"▼"),1)):v("",!0)]),e("th",{class:"text-left px-4 py-2 cursor-pointer",onClick:n[5]||(n[5]=r=>$("statuses"))},[n[15]||(n[15]=y(" Statuses ")),k.value==="statuses"?(a(),i("span",bo,d(E.value==="asc"?"▲":"▼"),1)):v("",!0)]),e("th",{class:"text-left px-4 py-2 cursor-pointer",onClick:n[6]||(n[6]=r=>$("tier"))},[n[16]||(n[16]=y(" Tier ")),k.value==="tier"?(a(),i("span",_o,d(E.value==="asc"?"▲":"▼"),1)):v("",!0)])])]),e("tbody",null,[(a(!0),i(F,null,Y(K.value,(r,T)=>(a(),i(F,{key:r.id},[e("tr",go,[m.editing&&!m.readonly?(a(),i("td",ho,[e("input",{type:"checkbox",checked:_.value.includes(r.id),onChange:w=>oe(r.id),disabled:m.readonly||!m.editing},null,40,xo)])):v("",!0),e("td",{class:be(["font-mono text-blue-800 px-4 py-2",{"cursor-pointer":r.details.length>0,"cursor-default":r.details.length===0}]),onClick:w=>r.details.length>0&&A(T)},d(r.gene_symbol),11,ko),e("td",{class:be(["px-4 py-2",{"cursor-pointer":r.details.length>0,"cursor-default":r.details.length===0}]),onClick:w=>r.details.length>0&&A(T)},d(r.statuses.join(", "))+" ("+d(r.details.length)+") ",11,wo),e("td",Co,[!m.readonly&&m.editing?(a(),i(F,{key:0},[q(e("select",{"onUpdate:modelValue":w=>r.tier=w,class:"border rounded px-1 py-0.5",onChange:w=>le(r),disabled:D.value===r.id||m.readonly||!m.editing},n[17]||(n[17]=[me('<option value="">—</option><option value="1">Tier 1</option><option value="2">Tier 2</option><option value="3">Tier 3</option><option value="4">Tier 4</option>',5)]),40,So),[[Q,r.tier]]),D.value===r.id?(a(),i("span",To,"Saving...")):v("",!0)],64)):(a(),i("span",Do,d(r.tier||"—"),1))])]),G.value.includes(T)?(a(),i("tr",Go,[e("td",Ao,[(a(!0),i(F,null,Y(r.details,w=>(a(),i("div",{key:w.disease+w.current_status,class:"mb-2"},[e("div",Vo,[e("div",null,[n[18]||(n[18]=e("strong",null,"Status:",-1)),y(" "+d(w.current_status),1)]),e("div",null,[n[19]||(n[19]=e("strong",null,"Status Date:",-1)),y(" "+d(w.current_status_date),1)]),e("div",null,[n[20]||(n[20]=e("strong",null,"Disease:",-1)),y(" "+d(w.mondo_id)+" "+d(w.disease),1)]),e("div",null,[n[21]||(n[21]=e("strong",null,"Expert Panel:",-1)),y(" "+d(w.expert_panel),1)]),e("div",null,[n[22]||(n[22]=e("strong",null,"Classification:",-1)),y(" "+d(w.classification),1)]),e("div",null,[n[23]||(n[23]=e("strong",null,"MOI:",-1)),y(" "+d(w.moi),1)]),e("div",null,[n[24]||(n[24]=e("strong",null,"Type:",-1)),y(" "+d(w.curation_type),1)]),e("div",null,[n[25]||(n[25]=e("strong",null,"Phenotype:",-1)),y(" "+d(w.phenotype),1)])]),n[26]||(n[26]=e("hr",null,null,-1))]))),128))])])):v("",!0)],64))),128))])])]),e("div",Eo,[e("button",{onClick:n[7]||(n[7]=r=>c.value--),disabled:c.value===1,class:"btn"},"Prev",8,Po),e("span",Io,"Page "+d(c.value)+" / "+d(h.value),1),e("button",{onClick:n[8]||(n[8]=r=>c.value++),disabled:c.value===h.value,class:"btn"},"Next",8,Uo)])]))}},Lo={name:"CspecSummary",props:{readonly:{type:Boolean,default:!1}},data(){return{sort:{field:"id",desc:!1},specFields:[{name:"name",type:String,sortable:!0},{name:"status",label:"Status",type:String,sortable:!0},{name:"updated_at",label:"Last Updated",type:Date,sortable:!0}]}},computed:{group(){return this.$store.getters["groups/currentItemOrNew"]},hasSpecifications(){return this.group.expert_panel.specifications&&this.group.expert_panel.specifications.length>0},specifications(){return this.group.expert_panel.specifications}},watch:{group(m){this.$store.dispatch("groups/getSpecifications",m)}},mounted(){this.$store.dispatch("groups/getSpecifications",this.group)},methods:{goToCspec(){window.location="https://cspec.genome.network/"}}},No={key:0,class:"well mb-2"},Mo={key:1},Oo={class:"mb-2"},Fo=["href"],Bo=["disabled"];function Ro(m,t,b,o,c,g){const D=U("icon-arrow-right"),G=U("note");return a(),i("div",null,[g.hasSpecifications?(a(),i("div",Mo,[e("table",Oo,[t[0]||(t[0]=e("thead",null,[e("tr",null,[e("th",null,"Specification Name"),e("th",null,"Status"),e("th",null,"Last Updated"),e("th",null," ")])],-1)),e("tbody",null,[(a(!0),i(F,null,Y(g.specifications,_=>(a(),i("tr",{key:_.id},[e("td",null,d(_.name),1),e("td",null,d(_.status),1),e("td",null,d(m.formatDate(_.updated_at)),1),e("td",null,[e("ul",null,[e("li",null,[e("a",{target:"cspec_edit",href:`https://cspec.genome.network/cspec/ed/svi/doc/${_.cspec_id}`},"Edit",8,Fo)])])])]))),128))])])])):(a(),i("div",No," No specifications on record in the CSPEC Registry. ")),e("a",{class:"btn btn-lg blue",target:"cspec-editor",disabled:b.readonly,href:"https://cspec.genome.network/"},[t[1]||(t[1]=y(" Go to the CSpec Registry ")),M(D,{class:"inline"})],8,Bo),M(G,{class:"mt-2"},{default:B(()=>t[2]||(t[2]=[y(" It may take up to an hour for the latest updates in the CSPEC Registry to display here. ")])),_:1})])}const qo=ve(Lo,[["render",Ro]]),jo=Oe.documentsTypes,Ko={props:{documentTypeId:{type:[Number,Array],required:!0},step:{type:Number,required:!1,default:null},showNotes:{type:Boolean,default:!0},readonly:{type:Boolean,default:!1}},emits:["saved","canceled"],data(){return{newDocument:{file:null,date_received:new Date().toISOString(),step:this.step},errors:{},activeDocument:{},showDeleteConfirmation:!1}},computed:{group(){return this.$store.getters["groups/currentItemOrNew"]},documents(){return this.group.documents.filter(m=>this.docTypeIsArray?this.documentTypeId.includes(m.document_type_id):m.document_type_id===this.documentTypeId)},docTypeIsArray(){return Array.isArray(this.documentTypeId)},filteredTypes(){return this.docTypeIsArray?Object.values(jo).filter(m=>this.documentTypeId.includes(m.id)).map(m=>({label:m.long_name,value:m.id})):[]},document_type_id(){return this.docTypeIsArray?null:this.documentTypeId}},mounted(){this.$store.dispatch("groups/getDocuments",this.group)},methods:{async save(){try{const m=new FormData;Object.entries(this.newDocument).forEach(([t,b])=>{b!=null&&m.append(t,b)}),m.set("file",this.$refs.fileInput.files[0]),m.set("document_type_id",this.documentTypeId),await this.$store.dispatch("groups/addApplicationDocument",{group:this.group,data:m}),this.clearForm(),this.$emit("saved")}catch(m){he(m)&&(this.errors=m.response.data.errors)}},cancel(){this.clearForm(),this.$emit("canceled")},clearForm(){this.initNewDocument(),this.clearErrors()},initNewDocument(){this.$refs.fileInput.value=null,this.newDocument={file:null,date_received:Me(new Date),date_reviewed:null,step:this.step,document_type_id:this.documentTypeId,notes:null}},clearErrors(){this.errors={}},initDownload(m){window.location=m.download_url},initDelete(m){this.activeDocument=m,this.showDeleteConfirmation=!0},cancelDelete(){this.showDeleteConfirmation=!1,this.resetActiveDocument()},async commitDelete(){await this.$store.dispatch("groups/deleteDocument",{group:this.group,document:this.activeDocument}),this.showDeleteConfirmation=!1,this.resetActiveDocument()},resetActiveDocument(){this.activeDocument={type:{}}}}},zo={key:0,class:"table"},Ho={key:0},Yo=["href"],Zo={class:"note"},Jo={key:0},Qo={key:1},Wo={ref:"fileInput",type:"file"},Xo={key:0},$o={key:0,class:"mb-3"};function el(m,t,b,o,c,g){const D=U("dropdown-item"),G=U("dropdown-menu"),_=U("input-row"),L=U("button-row"),C=U("modal-dialog");return a(),i("div",null,[g.documents.length>0?(a(),i("table",zo,[e("thead",null,[e("tr",null,[t[3]||(t[3]=e("th",null,"File",-1)),g.docTypeIsArray?(a(),i("th",Ho," Type ")):v("",!0),t[4]||(t[4]=e("th",null,"uploaded",-1)),t[5]||(t[5]=e("th",null,null,-1))])]),e("tbody",null,[(a(!0),i(F,null,Y(g.documents,k=>(a(),i("tr",{key:k.id,class:"p-1 border"},[e("td",null,[e("a",{href:k.download_url},d(k.filename),9,Yo),e("span",Zo," (v. "+d(k.version)+")",1)]),g.docTypeIsArray?(a(),i("td",Jo,d(k.type.long_name),1)):v("",!0),e("td",null,d(m.formatDate(k.created_at)),1),e("td",null,[M(G,{"hide-cheveron":""},{label:B(()=>t[6]||(t[6]=[e("button",{class:"btn btn-xs"}," … ",-1)])),default:B(()=>[M(D,{onClick:E=>g.initDownload(k)},{default:B(()=>t[7]||(t[7]=[y(" Download ")])),_:2},1032,["onClick"]),m.hasAnyPermission(["ep-applications-manage",["application-edit",g.group]])?(a(),te(D,{key:0,onClick:E=>g.initDelete(k)},{default:B(()=>t[8]||(t[8]=[y(" Delete ")])),_:2},1032,["onClick"])):v("",!0)]),_:2},1024)])]))),128))])])):v("",!0),b.readonly?v("",!0):(a(),i("div",Qo,[g.docTypeIsArray?(a(),te(_,{key:0,modelValue:c.newDocument.document_type_id,"onUpdate:modelValue":t[0]||(t[0]=k=>c.newDocument.document_type_id=k),label:"Document type",type:"select",options:g.filteredTypes},null,8,["modelValue","options"])):v("",!0),M(_,{label:"Document",errors:c.errors.file},{default:B(()=>[e("input",Wo,null,512)]),_:1},8,["errors"]),e("button",{class:"btn blue",onClick:t[1]||(t[1]=(...k)=>g.save&&g.save(...k))}," Upload ")])),(a(),te(Fe,{to:"body"},[M(C,{modelValue:c.showDeleteConfirmation,"onUpdate:modelValue":t[2]||(t[2]=k=>c.showDeleteConfirmation=k),title:`You are about to delete ${c.activeDocument.filename}`},{default:B(()=>[c.activeDocument?(a(),i("div",Xo,[c.activeDocument.is_final?(a(),i("p",$o," This version has been tagged as the final version of the document. ")):v("",!0),t[9]||(t[9]=e("p",null,"Are you sure you want to continue?",-1)),M(L,{"submit-text":"Delete Document",onCanceled:g.cancelDelete,onSubmitted:g.commitDelete},null,8,["onCanceled","onSubmitted"])])):v("",!0)]),_:1},8,["modelValue","title"])]))])}const tl=ve(Ko,[["render",el]]),ol={name:"SpecificationsSection",components:{CspecSummary:qo,ApplicationUploadForm:tl},props:{docTypeId:{required:!0,type:[Number,Array]},readonly:{type:Boolean,default:!1}},data(){return{}},computed:{cspecSummaryEnabled(){return this.$store.state.systemInfo.app.features.cspec_summary},specificationUpload(){return this.$store.state.systemInfo.app.features.specification_upload}},methods:{}};function ll(m,t,b,o,c,g){const D=U("CspecSummary"),G=U("ApplicationUploadForm"),_=U("collapsible");return a(),i("div",null,[g.cspecSummaryEnabled?(a(),te(D,{key:0,readonly:b.readonly},null,8,["readonly"])):v("",!0),M(_,{class:"mt-4"},{title:B(()=>t[0]||(t[0]=[e("h3",null,"Legacy document-based specifications",-1)])),default:B(()=>[g.specificationUpload?(a(),te(G,{key:0,"document-type-id":b.docTypeId,"show-notes":!1,readonly:b.readonly},null,8,["document-type-id","readonly"])):v("",!0)]),_:1})])}const rl=ve(ol,[["render",ll]]);export{rl as S,al as V,il as _};
//# sourceMappingURL=SpecificationsSection-DKDqX5cz.js.map
