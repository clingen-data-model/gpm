import{_ as I,aR as E,c as d,d as y,f as m,i as b,h as g,w as u,F as w,m as F,a as p,q as v,r as P,v as B,u as U,W as R,b as r,e as k,C as x,D as j,U as M,j as G}from"./app-Dodz6L5-.js";import{G as q}from"./GroupForm-FlF0d3B3.js";import"./_baseOrderBy-Cp_BrSnl.js";const z={name:"ComponentName",components:{GroupForm:q,SubmissionWrapper:E},props:{},setup(){const a=B(),e=U(),f=v(()=>[{label:"VCEPs",typeId:4,filter:s=>s.is_vcep_or_scvcep},{label:"GCEPs",typeId:3,filter:s=>s.is_gcep},{label:"CDWGs",typeId:2,filter:s=>s.isCdwg()},{label:"WGs",typeId:1,filter:s=>s.isWg()}]),i=P(null),n=v(()=>a.getters["groups/all"]),c=v(()=>n.value.filter(t=>{if(!i.value)return!0;const s=new RegExp(`.*${i.value}.*`,"i");return t.name&&t.name.match(s)||t.displayName&&t.displayName.match(s)||t.expert_panel&&t.expert_panel.full_short_base_name&&t.expert_panel.full_short_base_name.match(s)||t.id===i.value||t.status.name.match(s)||t.expert_panel&&t.expert_panel.currentStepName&&t.expert_panel.currentStepName.match(s)||t.coordinators.filter(C=>C.person.name.match(s)).length>0})),_=t=>{e.push({name:"GroupDetail",params:{uuid:t.uuid}})};return{filterString:i,groups:n,filteredGroups:c,tabDefinitions:f,goToItem:_,goToGroup:_}},data(){return{loading:!1,showCreateForm:!1,loadedFor:{VCEPs:!1,GCEPs:!1,CDWGs:!1,WGs:!1},sort:{field:"id",desc:!1},fields:[{name:"id",label:"ID",sortable:!0},{name:"name",label:"Name",sortable:!0,resolveValue:a=>a.displayName},{name:"coordinators",sortable:!1},{name:"displayStatus",sortable:!0,label:"status"}]}},methods:{startCreateGroup(){this.showCreateForm=!0},async getGroupsForType(a){const e=this.tabDefinitions.find(f=>f.label===a);this.loadedFor[a]||(this.loading=!0,await this.$store.dispatch("groups/getItems",{where:{group_type_id:e.typeId}}),this.loadedFor[a]=!0,this.loading=!1)}}},A={class:"flex justify-between items-center"},L={key:0,class:"text-center w-full"},H={key:1},J={class:"mb-2"},K={key:0},O={key:0},Q={key:0};function X(a,e,f,i,n,c){const _=p("badge"),t=p("router-link"),s=p("data-table"),C=p("tab-item"),S=p("tabs-container"),D=p("GroupForm"),N=p("SubmissionWrapper"),V=p("modal-dialog"),T=R("remaining-height");return r(),d("div",null,[y("h1",A,[e[9]||(e[9]=b(" Groups ")),a.hasPermission("groups-manage")?(r(),d("button",{key:0,class:"btn btn-xs",onClick:e[0]||(e[0]=(...l)=>c.startCreateGroup&&c.startCreateGroup(...l))}," Create a group ")):g("",!0)]),m(S,{onTabChanged:c.getGroupsForType},{default:u(()=>[(r(!0),d(w,null,F(i.tabDefinitions,l=>(r(),k(C,{key:l.label,label:l.label},{default:u(()=>[n.loading?(r(),d("div",L," Loading... ")):(r(),d("div",H,[y("div",J,[e[10]||(e[10]=b(" Filter: ")),x(y("input",{"onUpdate:modelValue":e[1]||(e[1]=o=>i.filterString=o),type:"text",placeholder:"name,id,status,coordinator name"},null,512),[[j,i.filterString]])]),x((r(),k(s,{sort:n.sort,"onUpdate:sort":e[3]||(e[3]=o=>n.sort=o),data:i.filteredGroups.filter(l.filter),fields:n.fields,"row-click-handler":i.goToGroup,"row-class":"cursor-pointer active:bg-blue-100"},{"cell-displayStatus":u(({item:o})=>[m(_,{class:"text-xs",color:o.statusColor},{default:u(()=>[b(G(o.displayStatus),1),o.status.id==1&&o.is_ep?(r(),d("span",K," - "+G(o.expert_panel.currentStepAbbr),1)):g("",!0)]),_:2},1032,["color"])]),"cell-coordinators":u(({value:o})=>[o.length==0?(r(),d("div",O)):g("",!0),(r(!0),d(w,null,F(o,(h,W)=>(r(),d("span",{key:h.id},[W>0?(r(),d("span",Q,", ")):g("",!0),m(t,{to:{name:"PersonDetail",params:{uuid:h.person.uuid}},class:"link",onClick:e[2]||(e[2]=M(()=>{},["stop"]))},{default:u(()=>[b(G(h.person.name),1)]),_:2},1032,["to"])]))),128))]),_:2},1032,["sort","data","fields","row-click-handler"])),[[T]])]))]),_:2},1032,["label"]))),128))]),_:1},8,["onTabChanged"]),m(V,{modelValue:n.showCreateForm,"onUpdate:modelValue":e[8]||(e[8]=l=>n.showCreateForm=l),title:"Create a New Group",size:"sm"},{default:u(()=>[m(N,{onSubmitted:e[6]||(e[6]=l=>a.$refs.groupForm.save()),onCanceled:e[7]||(e[7]=l=>a.$refs.groupForm.cancel())},{default:u(()=>[m(D,{ref:"groupForm",onCanceled:e[4]||(e[4]=l=>n.showCreateForm=!1),onSaved:e[5]||(e[5]=l=>n.showCreateForm=!1)},null,512)]),_:1})]),_:1},8,["modelValue"])])}const ee=I(z,[["render",X]]);export{ee as default};
//# sourceMappingURL=GroupList-wYppv2Z5.js.map
