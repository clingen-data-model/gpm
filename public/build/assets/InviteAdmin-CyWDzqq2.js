import{_ as I,a as l,ab as S,c as f,b as m,f as u,d as a,C as v,e as b,w as d,i as C,h as x,D as T,j as c,a1 as V,p as g,a2 as k,a4 as D}from"./app-RwQUrOg2.js";const N={name:"InviteAdmin",props:{},data(){return{resettingInvite:{},tableSort:{field:"id",desc:!1},invites:[],showConfirmation:!1,searchTerm:null,fields:[{name:"id",sortable:!0,type:Number},{name:"person.name",label:"Name",sortable:!0,type:String},{name:"person.email",label:"Email",sortable:!0,type:String},{name:"redeemed_at",sortable:!0,type:Date},{name:"inviter",sortable:!0,type:String,resolveValue:n=>n.inviter?n.inviter.name:null},{name:"code",sortable:!1,type:String},{name:"reset",sortable:!1,type:String}]}},watch:{searchTerm(){this.triggerSearch()}},mounted(){this.triggerSearch=D(()=>this.$refs.dataTable.getItems(),500)},methods:{async itemProvider(n,e,s,o){const t={page:n,page_size:e,"sort[field]":s.field.name,"sort[dir]":s.desc?"DESC":"ASC","where[keyword]":this.searchTerm},i=await g.get("/api/people/invites",{params:t}).then(p=>p.data);return o(i.meta.total),i.data},async resetInvite(n){try{const e=await g.put(`/api/people/invites/${n.code}/reset`),s=this.invites.findIndex(o=>o.id===n.id);s===-1&&alert("what??"),this.invites[s]=e.data}catch(e){if(k(e)){alert("Problem resetting invite!");return}}this.showConfirmation=!1},confirmReset(n){this.resettingInvite=n,this.showConfirmation=!0}}},R=["onClick"];function A(n,e,s,o,t,i){const p=l("note"),h=l("data-table"),_=l("button-row"),w=l("modal-dialog"),y=S("remaining-height");return m(),f("div",null,[u(p,null,{default:d(()=>e[4]||(e[4]=[C("Admin")])),_:1}),e[7]||(e[7]=a("h1",null,"Invites",-1)),v((m(),b(h,{ref:"dataTable",sort:t.tableSort,"onUpdate:sort":e[1]||(e[1]=r=>t.tableSort=r),data:i.itemProvider,fields:t.fields,class:"text-sm",paginated:""},{header:d(()=>[v(a("input",{"onUpdate:modelValue":e[0]||(e[0]=r=>t.searchTerm=r),type:"text",placeholder:"filter by name or email",class:"mb-2"},null,512),[[T,t.searchTerm]])]),"cell-reset":d(({item:r})=>[r.redeemed_at?(m(),f("button",{key:0,class:"btn btn-xs",onClick:B=>i.confirmReset(r)}," Reset ",8,R)):x("",!0)]),_:1},8,["sort","data","fields"])),[[y]]),(m(),b(V,{to:"body"},[u(w,{modelValue:t.showConfirmation,"onUpdate:modelValue":e[3]||(e[3]=r=>t.showConfirmation=r),title:"Reset Invite"},{default:d(()=>[a("p",null,"You are about to reset the invite for "+c(t.resettingInvite.first_name)+" "+c(t.resettingInvite.last_name)+".",1),e[5]||(e[5]=a("p",null,"This cannot be undone.",-1)),e[6]||(e[6]=a("p",null,"Do you want to reset the invite?",-1)),u(_,{"submit-text":"Reset Invite",onSubmitted:e[2]||(e[2]=r=>i.resetInvite(t.resettingInvite))})]),_:1},8,["modelValue"])]))])}const P=I(N,[["render",A]]);export{P as default};
//# sourceMappingURL=InviteAdmin-CyWDzqq2.js.map
