{"version":3,"file":"PendingCoiList-BIavMluK.js","sources":["../../../resources/js/views/PendingCoiList.vue"],"sourcesContent":["<script setup>\nimport { computed } from 'vue'\nimport { useStore } from 'vuex'\nimport { api } from '@/http'\nimport { useRoute, useRouter } from 'vue-router'\n\nconst store = useStore()\nconst route = useRoute()\nconst router = useRouter()\n\nconst memberships = computed(() =>\n  store.getters.currentUser?.person?.membershipsWithPendingCois || []\n)\n\nconst env = computed(() => store.state.systemInfo?.env)\nconst isNonProd = computed(() => env.value && (env.value == 'demo' || env.value == 'local'))\n\nconst isSuper = computed(() => {\n  const roles = store.getters.currentUser?.roles || []\n  return roles.some(r => ['super-user', 'super-admin'].includes(r.name))\n})\n\nconst canAdminComplete = computed(() => isNonProd.value && isSuper.value)\n\nasync function adminCompleteCoi (membership) {\n  await api.post(`/api/coi/${membership.group.coi_code}`, {\n    group_member_id: membership.id,\n    work_fee_lab: 0,\n    contributions_to_gd_in_group: 2,\n    coi: 0,\n    coi_attestation: 1,\n    data_policy_attestation: 1,\n    admin_override: 1,\n  })\n  await store.dispatch('forceGetCurrentUser')\n  if (!store.getters.currentUser.hasPendingCois) {\n    const redirectTo = route.params.redirectTo\n\n    if (redirectTo && typeof redirectTo === 'object') {\n      router.replace(redirectTo)\n    } else {\n      router.replace({ name: 'Dashboard' })\n    }\n  }\n}\n</script>\n\n<template>\n  <card title=\"You have Conflict of Interest Disclosures to Complete\">\n    <h3>You must complete a Conflict of Interest Disclosure for the following memberships:</h3>\n    <div class=\"my-2\">\n      <div\n        v-for=\"membership in memberships\"\n        :key=\"membership.id\"\n        class=\"flex items-center justify-between my-0 p-2 border border-gray-300 first:rounded-t-lg last:rounded-b-lg hover:bg-blue-50\"\n      >\n        <router-link\n          class=\"font-bold link\"\n          :to=\"`/coi/${membership.group.coi_code}`\"\n        >\n          {{ membership.group.display_name }}\n        </router-link>\n\n        <div class=\"flex items-center space-x-2\">\n          <button v-if=\"canAdminComplete\" class=\"btn btn-xs\" @click.stop=\"adminCompleteCoi(membership)\">Complete COI</button>\n        </div>\n      </div>\n    </div>\n  </card>\n</template>\n"],"names":["store","useStore","route","useRoute","router","useRouter","memberships","computed","_b","_a","env","isNonProd","isSuper","r","canAdminComplete","adminCompleteCoi","membership","api","redirectTo"],"mappings":"gRAMA,MAAMA,EAAQC,EAAQ,EAChBC,EAAQC,EAAQ,EAChBC,EAASC,EAAS,EAElBC,EAAcC,EAAS,IAAA,SAC3B,QAAAC,GAAAC,EAAAT,EAAM,QAAQ,cAAd,YAAAS,EAA2B,SAA3B,YAAAD,EAAmC,6BAA8B,CAAA,EACnE,EAEME,EAAMH,EAAS,IAAA,OAAM,OAAAE,EAAAT,EAAM,MAAM,aAAZ,YAAAS,EAAwB,IAAG,EAChDE,EAAYJ,EAAS,IAAMG,EAAI,QAAUA,EAAI,OAAS,QAAUA,EAAI,OAAS,QAAQ,EAErFE,EAAUL,EAAS,IAAM,OAE7B,SADcE,EAAAT,EAAM,QAAQ,cAAd,YAAAS,EAA2B,QAAS,CAAA,GACrC,KAAKI,GAAK,CAAC,aAAc,aAAa,EAAE,SAASA,EAAE,IAAI,CAAC,CACvE,CAAC,EAEKC,EAAmBP,EAAS,IAAMI,EAAU,OAASC,EAAQ,KAAK,EAExE,eAAeG,EAAkBC,EAAY,CAW3C,GAVA,MAAMC,EAAI,KAAK,YAAYD,EAAW,MAAM,QAAQ,GAAI,CACtD,gBAAiBA,EAAW,GAC5B,aAAc,EACd,6BAA8B,EAC9B,IAAK,EACL,gBAAiB,EACjB,wBAAyB,EACzB,eAAgB,CACjB,CAAA,EACD,MAAMhB,EAAM,SAAS,qBAAqB,EACtC,CAACA,EAAM,QAAQ,YAAY,eAAgB,CAC7C,MAAMkB,EAAahB,EAAM,OAAO,WAE5BgB,GAAc,OAAOA,GAAe,SACtCd,EAAO,QAAQc,CAAU,EAEzBd,EAAO,QAAQ,CAAE,KAAM,WAAa,CAAA,CAE1C,CACA"}