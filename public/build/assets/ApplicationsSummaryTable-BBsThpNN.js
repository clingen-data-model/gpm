import{_ as h,B as y,a as c,c as n,b as p,d as l,f as d,i as b,C as f,D as w,w as i,F as g,m as v,j as x,E as A}from"./app-xtqLUWuO.js";import{s as S}from"./router_aware_sort_and_filter-9Sdst5yH.js";const D={name:"SummaryVceps",components:{},props:{expertPanelTypeId:{type:Number,default:null}},data(){return{fields:[{name:"name",label:"Name",type:String,sortable:!0},{name:"group.parent.name",label:"CDWG",type:String,sortable:!0,resolveValue(e){return e.group&&e.group.parent?e.group.parent.name:""}},{name:"current_step",label:"Step",type:Number,sortable:!0,resolveValue(e){return e.isCompleted?"Completed":e.current_step},resolveSort(e){return e.isCompleted?5:e.current_step}},{name:"contacts",label:"Contacts",type:Array,sortable:!1,class:["min-w-40"],step:1},{name:"step_1_received_date",label:Number.parseInt(this.expert_panel_type_id)===2?"Step 1 Received":"Application Received",type:Date,sortable:!0,class:["min-w-28"],step:1},{name:"step_1_approval_date",label:Number.parseInt(this.expert_panel_type_id)===2?"Step 1 Approved":"Application Approved",type:Date,sortable:!0,class:["min-w-28"],step:1},{name:"step_2_approval_date",label:"Step 2 Approved",type:Date,sortable:!0,class:["min-w-28"],step:2},{name:"step_3_approval_date",label:"Step 3 Approved",type:Date,sortable:!0,class:["min-w-28"],step:3},{name:"step_4_received_date",label:"Step 4 Received",type:Date,sortable:!0,class:["min-w-28"],step:4},{name:"step_4_approval_date",label:"Step 4 Approved",type:Date,sortable:!0,class:["min-w-28"],step:4}]}},computed:{...y({applications:"applications/all"}),filteredData(){return this.applications.filter(e=>!this.expert_panel_type_id||Number.parseInt(e.expert_panel_type_id)===Number.parseInt(this.expert_panel_type_id)).filter(e=>this.showCompleted?!0:e.date_completed==null)},showCompleted:{set(e){const t=this.$route.query,u=this.$route.path;let a={...t};e?a={...t,"show-completed":1}:delete a["show-completed"],this.$router.replace({path:u,query:a})},get(){return!!Number.parseInt(this.$route.query["show-completed"])},immediate:!0},selectedFields(){const e=Number.parseInt(this.expert_panel_type_id)===2?[1,2,3,4]:[1];return this.fields.filter(t=>!t.step||e.includes(t.step))},showAllInfo:{immediate:!0,get(){return Object.keys(this.$route.query).includes("showAllInfo")?this.$route.query.showAllInfo:0},set(e){const t={...this.$route.query};t.showAllInfo=e,this.$router.replace({path:this.$route.path,query:t})}},remainingHeight(){return{height:"calc(100vh - 220px)"}}},mounted(){this.getApplications()},methods:{getApplications(){const e={with:["group","group.parent","group.latestLogEntry","latestPendingNextAction","type","group.contacts","group.contacts.person"]},t={};Object.keys(t).length>0&&(e.where=t),this.$store.dispatch("applications/getApplications",e)},goToApplication(e){this.$router.push({name:"ApplicationDetail",params:{uuid:e.uuid}})}},setup(){const{sort:e,filter:t}=S();return{sort:e,filter:t}}},N={class:"flex justify-between"},C={class:"mb-1 flex space-x-2"},I=["href"],T=["innerHTML"],V=["innerHTML"];function k(e,t,u,a,q,s){const m=c("checkbox"),_=c("data-table");return p(),n("div",null,[l("div",N,[l("div",C,[l("label",null,[t[3]||(t[3]=b("Filter: ")),f(l("input",{"onUpdate:modelValue":t[0]||(t[0]=r=>a.filter=r),type:"text",class:"sm",placeholder:"filter"},null,512),[[w,a.filter]])]),d(m,{modelValue:s.showCompleted,"onUpdate:modelValue":t[1]||(t[1]=r=>s.showCompleted=r),label:"Show completed"},null,8,["modelValue"])])]),d(_,{sort:a.sort,"onUpdate:sort":t[2]||(t[2]=r=>a.sort=r),data:s.filteredData,fields:s.selectedFields,"filter-term":a.filter,"row-click-handler":s.goToApplication,"row-class":"cursor-pointer",style:A(s.remainingHeight),class:"overflow-auto text-xs"},{"cell-contacts":i(({item:r})=>[l("ul",null,[(p(!0),n(g,null,v(r.group.contacts,o=>(p(),n("li",{key:o.id},[l("small",null,[l("a",{href:`mailto:${o.person.email}`,class:"text-blue-500"},x(o.person.name),9,I)])]))),128))])]),"cell-latest_log_entry_description":i(({value:r})=>[l("div",{innerHTML:r},null,8,T)]),"cell-latest_pending_next_action_entry":i(({value:r})=>[l("div",{innerHTML:r},null,8,V)]),_:1},8,["sort","data","fields","filter-term","row-click-handler","style"])])}const L=h(D,[["render",k]]);export{L as A};
//# sourceMappingURL=ApplicationsSummaryTable-BBsThpNN.js.map
