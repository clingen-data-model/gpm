{"version":3,"file":"InviteAdmin-CvAH15Gu.js","sources":["../../../resources/js/views/InviteAdmin.vue"],"sourcesContent":["<script>\nimport {api, isValidationError} from '@/http'\nimport {debounce} from 'lodash-es'\n\nexport default {\n    name: 'InviteAdmin',\n    props: {\n        \n    },\n    data () {\n        return {\n\n            resettingInvite: {},\n            tableSort: {field: 'id', desc: false},\n            invites: [],\n            showConfirmation: false,\n            searchTerm: null,\n            fields: [\n                {\n                    name: 'id',\n                    sortable: true,\n                    type: Number\n                },\n                {\n                    name: 'person.name',\n                    label: 'Name',\n                    sortable: true,\n                    type: String\n                },\n                {\n                    name: 'person.email',\n                    label: 'Email',\n                    sortable: true,\n                    type: String\n                },\n                {\n                    name: 'redeemed_at',\n                    sortable: true,\n                    type: Date\n                },\n                {\n                    name: 'inviter',\n                    sortable: true,\n                    type: String,\n                    resolveValue: (invite) => {\n                        return invite.inviter ? invite.inviter.name : null\n                    }\n                },\n                {\n                    name: 'code',\n                    sortable: false,\n                    type: String\n                },\n                {\n                    name: 'reset',\n                    sortable: false,\n                    type: String\n                }\n            ],\n        }\n    },\n    watch: {\n        searchTerm () {\n            this.triggerSearch()\n        }\n    },\n    mounted () {\n        this.triggerSearch = debounce(() => this.$refs.dataTable.getItems(), 500)\n    },\n    methods: {\n\n        async itemProvider (currentPage, pageSize, sort, setTotalItems) {\n            const params = {\n                page: currentPage,\n                page_size: pageSize,\n                'sort[field]': sort.field.name,\n                'sort[dir]': sort.desc ? 'DESC' : 'ASC',\n                'where[keyword]': this.searchTerm\n            }\n            const pageResponse = await api.get(`/api/people/invites`, {params})\n                .then(rsp => rsp.data);\n            setTotalItems(pageResponse.meta.total);\n            return pageResponse.data;\n        }, \n        async resetInvite (invite) {\n            try {\n                const response = await api.put(`/api/people/invites/${invite.code}/reset`);\n                const idx = this.invites.findIndex(i => i.id === invite.id);\n                if (idx === -1) {\n                    // eslint-disable-next-line no-alert\n                    alert('what??')\n                }\n                this.invites[idx] = response.data;\n            } catch (error) {\n                if (isValidationError(error)) {\n                    // eslint-disable-next-line no-alert\n                    alert('Problem resetting invite!');\n                    return;\n                }\n            }\n            this.showConfirmation = false;\n        },\n        confirmReset(invite) {\n            this.resettingInvite = invite;\n            this.showConfirmation = true;\n        },\n    }\n}\n</script>\n<template>\n  <div>\n    <note>Admin</note>\n    <h1>Invites</h1>\n    <data-table\n      ref=\"dataTable\"\n      v-model:sort=\"tableSort\"\n      v-remaining-height\n      :data=\"itemProvider\"\n      :fields=\"fields\"\n      class=\"text-sm\"\n      paginated\n    >\n      <template #header>\n        <input v-model=\"searchTerm\" type=\"text\" placeholder=\"filter by name or email\" class=\"mb-2\">\n      </template>\n      <template #cell-reset=\"{item}\">\n        <button v-if=\"item.redeemed_at\" class=\"btn btn-xs\" @click=\"confirmReset(item)\">\n          Reset\n        </button>\n      </template>\n    </data-table>\n\n    <teleport to=\"body\">\n      <modal-dialog v-model=\"showConfirmation\" title=\"Reset Invite\">\n        <p>You are about to reset the invite for {{ resettingInvite.first_name }} {{ resettingInvite.last_name }}.</p>\n        <p>This cannot be undone.</p>\n        <p>Do you want to reset the invite?</p>\n        <button-row submit-text=\"Reset Invite\" @submitted=\"resetInvite(resettingInvite)\" />\n      </modal-dialog>\n    </teleport>\n  </div>\n</template>"],"names":["_sfc_main","invite","debounce","currentPage","pageSize","sort","setTotalItems","params","pageResponse","api","rsp","response","idx","i","error","isValidationError","_hoisted_1","_createElementBlock","_createVNode","_component_note","_withCtx","_cache","_createTextVNode","_createElementVNode","_createBlock","_component_data_table","$data","$event","$options","item","_createCommentVNode","_Teleport","_component_modal_dialog","_toDisplayString","_component_button_row"],"mappings":"iKAIA,MAAKA,EAAU,CACX,KAAM,cACN,MAAO,CAEN,EACD,MAAQ,CACJ,MAAO,CAEH,gBAAiB,CAAE,EACnB,UAAW,CAAC,MAAO,KAAM,KAAM,EAAK,EACpC,QAAS,CAAE,EACX,iBAAkB,GAClB,WAAY,KACZ,OAAQ,CACJ,CACI,KAAM,KACN,SAAU,GACV,KAAM,MACT,EACD,CACI,KAAM,cACN,MAAO,OACP,SAAU,GACV,KAAM,MACT,EACD,CACI,KAAM,eACN,MAAO,QACP,SAAU,GACV,KAAM,MACT,EACD,CACI,KAAM,cACN,SAAU,GACV,KAAM,IACT,EACD,CACI,KAAM,UACN,SAAU,GACV,KAAM,OACN,aAAeC,GACJA,EAAO,QAAUA,EAAO,QAAQ,KAAO,IAErD,EACD,CACI,KAAM,OACN,SAAU,GACV,KAAM,MACT,EACD,CACI,KAAM,QACN,SAAU,GACV,KAAM,MACV,CACH,CACL,CACH,EACD,MAAO,CACH,YAAc,CACV,KAAK,cAAa,CACtB,CACH,EACD,SAAW,CACP,KAAK,cAAgBC,EAAS,IAAM,KAAK,MAAM,UAAU,SAAQ,EAAI,GAAG,CAC3E,EACD,QAAS,CAEL,MAAM,aAAcC,EAAaC,EAAUC,EAAMC,EAAe,CAC5D,MAAMC,EAAS,CACX,KAAMJ,EACN,UAAWC,EACX,cAAeC,EAAK,MAAM,KAC1B,YAAaA,EAAK,KAAO,OAAS,MAClC,iBAAkB,KAAK,UAC3B,EACMG,EAAe,MAAMC,EAAI,IAAI,sBAAuB,CAAC,OAAAF,CAAM,CAAC,EAC7D,KAAKG,GAAOA,EAAI,IAAI,EACzB,OAAAJ,EAAcE,EAAa,KAAK,KAAK,EAC9BA,EAAa,IACvB,EACD,MAAM,YAAaP,EAAQ,CACvB,GAAI,CACA,MAAMU,EAAW,MAAMF,EAAI,IAAI,uBAAuBR,EAAO,IAAI,QAAQ,EACnEW,EAAM,KAAK,QAAQ,UAAUC,GAAKA,EAAE,KAAOZ,EAAO,EAAE,EACtDW,IAAQ,IAER,MAAM,QAAQ,EAElB,KAAK,QAAQA,CAAG,EAAID,EAAS,IAC/B,OAAOG,EAAO,CACZ,GAAIC,EAAkBD,CAAK,EAAG,CAE1B,MAAM,2BAA2B,EACjC,MACJ,CACJ,CACA,KAAK,iBAAmB,EAC3B,EACD,aAAab,EAAQ,CACjB,KAAK,gBAAkBA,EACvB,KAAK,iBAAmB,EAC3B,CACL,CACJ,EA3GAe,EAAA,CAAA,SAAA,uIA8GEC,EA8BM,MAAA,KAAA,CA7BJC,EAAkBC,EAAA,KAAA,CA/GtB,QAAAC,EA+GU,IAAKC,EAAA,CAAA,IAAAA,EAAA,CAAA,EAAA,CA/GfC,EA+GU,OAAK,KA/Gf,EAAA,IAgHID,EAAA,CAAA,IAAAA,EAAA,CAAA,EAAAE,EAAgB,UAAZ,UAAO,EAAA,UACXC,EAiBaC,EAAA,CAhBX,IAAI,YACI,KAAMC,EAAS,UAnH7B,gBAAAL,EAAA,CAAA,IAAAA,EAAA,CAAA,EAAAM,GAmHoBD,EAAS,UAAAC,GAEtB,KAAMC,EAAY,aAClB,OAAQF,EAAM,OACf,MAAM,UACN,UAAA,KAEW,SACT,IAA2F,GAA3FH,EAA2F,QAAA,CA3HnG,sBAAAF,EAAA,CAAA,IAAAA,EAAA,CAAA,EAAAM,GA2HwBD,EAAU,WAAAC,GAAE,KAAK,OAAO,YAAY,0BAA0B,MAAM,sBAApED,EAAU,UAAA,MAEjB,aAAUN,EACnB,CAES,CAHa,KAAAS,CAAI,IAAA,CACZA,EAAK,iBAAnBZ,EAES,SAAA,CAhIjB,IAAA,EA8HwC,MAAM,aAAc,QAAKU,GAAEC,EAAY,aAACC,CAAI,CAAG,EAAA,UA9HvF,EAAAb,CAAA,GAAAc,EAAA,GAAA,EAAA,IAAA,EAAA,4CAoIIN,EAOWO,EAAA,CAPD,GAAG,MAAM,EAAA,CACjBb,EAKec,EAAA,CA1IrB,WAqI6BN,EAAgB,iBArI7C,sBAAAL,EAAA,CAAA,IAAAA,EAAA,CAAA,EAAAM,GAqI6BD,EAAgB,iBAAAC,GAAE,MAAM,iBArIrD,QAAAP,EAsIQ,IAA8G,CAA9GG,EAA8G,IAA3G,KAAA,yCAAyCU,EAAAP,EAAA,gBAAgB,UAAU,EAAG,IAAIO,EAAAP,EAAA,gBAAgB,SAAS,EAAG,IAAC,CAAA,EAC1GL,EAAA,CAAA,IAAAA,EAAA,CAAA,EAAAE,EAA6B,SAA1B,yBAAsB,EAAA,GACzBF,EAAA,CAAA,IAAAA,EAAA,CAAA,EAAAE,EAAuC,SAApC,mCAAgC,EAAA,GACnCL,EAAmFgB,EAAA,CAAvE,cAAY,eAAgB,YAASb,EAAA,CAAA,IAAAA,EAAA,CAAA,EAAAM,GAAEC,EAAW,YAACF,EAAe,eAAA,OAzItF,EAAA"}