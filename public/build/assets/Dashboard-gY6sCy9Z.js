import{t as Z,_ as V,u as q,r as U,o as L,a as v,c as g,b as t,d as l,e as A,w as a,f as i,g as k,h as N,i as x,j as f,n as oe,k as j,l as W,F as E,m as $,p as F,q as I,G as Y,s as ie,v as le,P as de,x as pe,y as ce,z as me,A as fe}from"./app-BWr6YTwG.js";import{P as xe,C as be}from"./CoiList-BLbv-DXp.js";import{j as M}from"./judgement_utils-CQeBr_sj.js";import{S as ge,A as ve}from"./SustainedCurationReviewAlert-JaN5Gxpv.js";import _e from"./DemographicsForm-D787Yl-o.js";import"./ProfileForm-CnTvJaIn.js";import"./CoiDetail-DTjd99Tv.js";import"./ExpertisesView-DS4_6aJU.js";function ye(e,u,c,s){for(var _=-1,r=e==null?0:e.length;++_<r;)c=u(c,e[_],_,e);return c}function he(e){return function(u){return e==null?void 0:e[u]}}var Ae={À:"A",Á:"A",Â:"A",Ã:"A",Ä:"A",Å:"A",à:"a",á:"a",â:"a",ã:"a",ä:"a",å:"a",Ç:"C",ç:"c",Ð:"D",ð:"d",È:"E",É:"E",Ê:"E",Ë:"E",è:"e",é:"e",ê:"e",ë:"e",Ì:"I",Í:"I",Î:"I",Ï:"I",ì:"i",í:"i",î:"i",ï:"i",Ñ:"N",ñ:"n",Ò:"O",Ó:"O",Ô:"O",Õ:"O",Ö:"O",Ø:"O",ò:"o",ó:"o",ô:"o",õ:"o",ö:"o",ø:"o",Ù:"U",Ú:"U",Û:"U",Ü:"U",ù:"u",ú:"u",û:"u",ü:"u",Ý:"Y",ý:"y",ÿ:"y",Æ:"Ae",æ:"ae",Þ:"Th",þ:"th",ß:"ss",Ā:"A",Ă:"A",Ą:"A",ā:"a",ă:"a",ą:"a",Ć:"C",Ĉ:"C",Ċ:"C",Č:"C",ć:"c",ĉ:"c",ċ:"c",č:"c",Ď:"D",Đ:"D",ď:"d",đ:"d",Ē:"E",Ĕ:"E",Ė:"E",Ę:"E",Ě:"E",ē:"e",ĕ:"e",ė:"e",ę:"e",ě:"e",Ĝ:"G",Ğ:"G",Ġ:"G",Ģ:"G",ĝ:"g",ğ:"g",ġ:"g",ģ:"g",Ĥ:"H",Ħ:"H",ĥ:"h",ħ:"h",Ĩ:"I",Ī:"I",Ĭ:"I",Į:"I",İ:"I",ĩ:"i",ī:"i",ĭ:"i",į:"i",ı:"i",Ĵ:"J",ĵ:"j",Ķ:"K",ķ:"k",ĸ:"k",Ĺ:"L",Ļ:"L",Ľ:"L",Ŀ:"L",Ł:"L",ĺ:"l",ļ:"l",ľ:"l",ŀ:"l",ł:"l",Ń:"N",Ņ:"N",Ň:"N",Ŋ:"N",ń:"n",ņ:"n",ň:"n",ŋ:"n",Ō:"O",Ŏ:"O",Ő:"O",ō:"o",ŏ:"o",ő:"o",Ŕ:"R",Ŗ:"R",Ř:"R",ŕ:"r",ŗ:"r",ř:"r",Ś:"S",Ŝ:"S",Ş:"S",Š:"S",ś:"s",ŝ:"s",ş:"s",š:"s",Ţ:"T",Ť:"T",Ŧ:"T",ţ:"t",ť:"t",ŧ:"t",Ũ:"U",Ū:"U",Ŭ:"U",Ů:"U",Ű:"U",Ų:"U",ũ:"u",ū:"u",ŭ:"u",ů:"u",ű:"u",ų:"u",Ŵ:"W",ŵ:"w",Ŷ:"Y",ŷ:"y",Ÿ:"Y",Ź:"Z",Ż:"Z",Ž:"Z",ź:"z",ż:"z",ž:"z",Ĳ:"IJ",ĳ:"ij",Œ:"Oe",œ:"oe",ŉ:"'n",ſ:"s"},Ce=he(Ae),we=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,ke="\\u0300-\\u036f",Re="\\ufe20-\\ufe2f",Se="\\u20d0-\\u20ff",Ie=ke+Re+Se,Ue="["+Ie+"]",De=RegExp(Ue,"g");function Oe(e){return e=Z(e),e&&e.replace(we,Ce).replace(De,"")}var Ne=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g;function je(e){return e.match(Ne)||[]}var Ee=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/;function $e(e){return Ee.test(e)}var B="\\ud800-\\udfff",Le="\\u0300-\\u036f",Me="\\ufe20-\\ufe2f",Pe="\\u20d0-\\u20ff",ze=Le+Me+Pe,H="\\u2700-\\u27bf",J="a-z\\xdf-\\xf6\\xf8-\\xff",Ge="\\xac\\xb1\\xd7\\xf7",Te="\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf",Ze="\\u2000-\\u206f",Ve=" \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",K="A-Z\\xc0-\\xd6\\xd8-\\xde",qe="\\ufe0e\\ufe0f",Q=Ge+Te+Ze+Ve,X="['’]",P="["+Q+"]",We="["+ze+"]",ee="\\d+",Fe="["+H+"]",ue="["+J+"]",se="[^"+B+Q+ee+H+J+K+"]",Ye="\\ud83c[\\udffb-\\udfff]",Be="(?:"+We+"|"+Ye+")",He="[^"+B+"]",re="(?:\\ud83c[\\udde6-\\uddff]){2}",te="[\\ud800-\\udbff][\\udc00-\\udfff]",S="["+K+"]",Je="\\u200d",z="(?:"+ue+"|"+se+")",Ke="(?:"+S+"|"+se+")",G="(?:"+X+"(?:d|ll|m|re|s|t|ve))?",T="(?:"+X+"(?:D|LL|M|RE|S|T|VE))?",ae=Be+"?",ne="["+qe+"]?",Qe="(?:"+Je+"(?:"+[He,re,te].join("|")+")"+ne+ae+")*",Xe="\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",eu="\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])",uu=ne+ae+Qe,su="(?:"+[Fe,re,te].join("|")+")"+uu,ru=RegExp([S+"?"+ue+"+"+G+"(?="+[P,S,"$"].join("|")+")",Ke+"+"+T+"(?="+[P,S+z,"$"].join("|")+")",S+"?"+z+"+"+G,S+"+"+T,eu,Xe,ee,su].join("|"),"g");function tu(e){return e.match(ru)||[]}function au(e,u,c){return e=Z(e),u=u,u===void 0?$e(e)?tu(e):je(e):e.match(u)||[]}var nu="['’]",ou=RegExp(nu,"g");function iu(e){return function(u){return ye(au(Oe(u).replace(ou,"")),e,"")}}var lu=iu(function(e,u,c){return e+(c?" ":"")+u.toUpperCase()});const du={key:0,class:"alert bg-gray-100 p-2 text-gray-400"},pu={class:"flex space-x-2"},cu={key:0},mu={key:0,class:"mt-2",style:{"max-width":"300px"}},fu={style:{"max-width":"350px"},class:"text-sm"},xu={__name:"ApplicationActivity",props:{user:{type:Object,required:!0}},setup(e){const u=e,c=q(),s=[{name:"name",label:"Group",sortable:!0},{name:"submission.type.name",label:"Submitted Step",sortable:!0},{name:"submission.status.name",label:"Status",sortable:!0},{name:"last_submission_date",label:"Date",sortable:!0,type:Date},{name:"actions",label:"",sortable:!1}],_=U({field:"name",desc:!1}),r=U([]),w=async()=>{r.value=await F.get("/api/groups/applications").then(m=>m.data.data)},d=m=>{c.push({name:"ApplicationDetail",params:{uuid:m.uuid}})},y=m=>m.submission.judgements&&m.submission.judgements.some(n=>Number.parseInt(n.person_id)===Number.parseInt(u.user.person.id)),C=m=>m.submission.judgements?m.submission.judgements.find(n=>Number.parseInt(n.person_id)===Number.parseInt(u.user.person.id)):{};return L(()=>{w()}),(m,n)=>{const o=v("icon-checkmark"),h=v("badge"),D=v("router-link"),O=v("popper"),R=v("data-table");return t(),g("div",null,[n[6]||(n[6]=l("h2",null,"Application activity",-1)),r.value.length==0?(t(),g("div",du," No application activity. ")):(t(),A(R,{key:1,sort:_.value,"onUpdate:sort":n[0]||(n[0]=p=>_.value=p),data:r.value,fields:s,class:"text-sm","row-class":"cursor-pointer",onRowClick:d},{"cell-actions":a(({item:p})=>[l("div",pu,[y(p)?(t(),g("div",cu,[i(O,{hover:"",arrow:"",placement:"right"},{content:a(()=>[l("div",null,[n[1]||(n[1]=l("h3",{class:"mb-2"}," Your Decision ",-1)),i(h,{class:"inline-block",color:k(M)(C(p)),size:"xs"},{default:a(()=>[x(f(C(p).decision),1)]),_:2},1032,["color"])]),C(p).notes?(t(),g("div",mu,[n[2]||(n[2]=l("strong",null,"Notes:",-1)),x(" "+f(C(p).notes),1)])):N("",!0),n[4]||(n[4]=l("hr",null,null,-1)),i(D,{to:{name:"ApplicationDetail",params:{uuid:p.uuid}},class:oe({"btn btn-xs":k(j)("ep-applications-approve")})},{default:a(()=>n[3]||(n[3]=[x(f("Review"))])),_:2},1032,["to","class"])]),default:a(()=>[i(h,{color:k(M)(p)},{default:a(()=>[i(o,{class:"text-white inline-block",width:"12",height:"12"})]),_:2},1032,["color"])]),_:2},1024)])):(t(),A(D,{key:1,to:{name:"ApplicationDetail",params:{uuid:p.uuid}},class:"btn btn-xs"},{default:a(()=>[x(f(k(j)("ep-applications-manage")?"View":"Review"),1)]),_:2},1032,["to"])),l("div",null,[k(W)("chair-review")?(t(),A(O,{key:0,hover:"",arrow:""},{content:a(()=>[n[5]||(n[5]=l("h3",null,"Decisions:",-1)),l("table",fu,[(t(!0),g(E,null,$(p.submission.judgements,b=>(t(),g("tr",{key:b.id},[l("th",null,f(b.person.name)+":",1),l("td",null,[i(h,{class:"inline-block",color:k(M)(b)},{default:a(()=>[x(f(b.decision),1)]),_:2},1032,["color"])])]))),128))])]),default:a(()=>[k(j)("ep-applications-manage")&&p.submission.status.name=="Under Chair Review"?(t(),A(h,{key:0,color:p.submission.judgements.length==3?"green":"gray"},{default:a(()=>[x(f(p.submission.judgements.length)+"/3 ",1)]),_:2},1032,["color"])):N("",!0)]),_:2},1024)):N("",!0)])])]),_:1},8,["sort","data"]))])}}},bu=V(xu,[["__scopeId","data-v-f0c92e99"]]),gu={name:"CoiAlert",props:{membership:{type:Object,required:!0}},computed:{groupName(){return this.membership.group.display_name}}};function vu(e,u,c,s,_,r){const w=v("icon-coi"),d=v("router-link"),y=v("static-alert");return t(),A(y,{class:"pb-3 flex space-x-2 items-center",variant:"warning"},{default:a(()=>[i(w,{height:"30",width:"30"}),l("div",null,[l("p",null,[u[0]||(u[0]=x("You have a pending ")),u[1]||(u[1]=l("strong",null,"COI",-1)),u[2]||(u[2]=x(" disclosure for ")),l("strong",null,f(r.groupName),1),u[3]||(u[3]=x("."))]),i(d,{to:{name:"alt-coi",params:{name:r.groupName,code:c.membership.group.coi_code}},class:"btn font-bold"},{default:a(()=>u[4]||(u[4]=[x(" Complete this COI Disclosure ")])),_:1},8,["to"])])]),_:1})}const _u=V(gu,[["render",vu]]),yu={__name:"DashboardAlerts",props:{user:{type:Object,required:!0}},setup(e){const u=e,c=U([]),s=I(()=>u.user.memberships.filter(r=>r.hasPermission("annual-update-manage")).map(r=>r.group).filter(r=>r!==null).map(r=>new Y(r))),_=async()=>{if(s.value.length===0)return;const r={with:["assignee"],where:{task_type_id:1,assignee_type:"App\\Modules\\Group\\Models\\Group",assignee_id:[...new Set(s.value.map(y=>y.id))],pending:1}},d=`/api/tasks${ie(r)}`;c.value=await F.get(d).then(y=>{const C={};return y.data.forEach(m=>{C[m.assignee_id]=m}),C})};return L(()=>{_()}),(r,w)=>(t(),g("div",null,[(t(!0),g(E,null,$(c.value,d=>(t(),A(ge,{key:d.id,group:d.assignee,class:"mb-2"},null,8,["group"]))),128)),(t(!0),g(E,null,$(s.value,d=>(t(),A(ve,{key:d.id,group:d,"show-group-name":!0,class:"mb-2"},null,8,["group"]))),128)),(t(!0),g(E,null,$(e.user.person.membershipsWithPendingCois,d=>(t(),A(_u,{key:d.id,membership:d,class:"mb-2"},null,8,["membership"]))),128))]))}},hu={class:"note font-normal"},Au={key:0,class:"well"},Ou={__name:"Dashboard",setup(e){const u=le(),c=q(),s=I(()=>u.getters.currentUser),_=I(()=>u.getters["people/currentItem"]||new de),r=()=>{s.value.id&&s.value.person&&s.value.person.id&&(u.commit("people/addItem",s.value.person),u.commit("people/setCurrentItemIndex",s.value.person))};pe(()=>s,()=>{r()}),L(()=>{r()});const w=I(()=>s.value.memberships.map(o=>o.group).filter(o=>o!==null).map(o=>new Y(o))),d=U([{name:"displayName",sortable:!0,type:String},{name:"status.name",label:"Status",sortable:!0,resolveValue:o=>o.status.id===fe.groups.statuses.applying.id?`${o.status.name} - ${o.expert_panel.currentStepName}`:o.status.name,type:String},{name:"type.name",label:"Type",sortable:!0,resolveValue:o=>lu(o.type.name)}]),y=U({field:"displayName",desc:!1}),C=o=>({Active:"green",Applying:"blue",Retired:"yellow",Removed:"red"})[o]||"blue",m=I(()=>j("ep-applications-manage")||W("chair_review")&&ce(["ep-applications-comment","ep-applications-approve"]));L(async()=>{await u.dispatch("forceGetCurrentUser")});const n=o=>{c.push({name:"GroupDetail",params:{uuid:o.uuid}})};return(o,h)=>{const D=v("badge"),O=v("data-table"),R=v("tab-item"),p=v("tabs-container");return t(),g("div",null,[l("h1",null,[h[1]||(h[1]=x(" Dashboard ")),l("div",hu," User ID: "+f(s.value.id)+" | Person ID: "+f(s.value.person?s.value.person.id:"no person!!"),1)]),i(me,{user:s.value},null,8,["user"]),i(yu,{user:s.value},null,8,["user"]),m.value?(t(),A(bu,{key:0,user:s.value,class:"screen-block"},null,8,["user"])):N("",!0),i(p,{class:"mt-8"},{default:a(()=>[i(R,{label:"Your Groups"},{default:a(()=>[w.value.length?(t(),A(O,{key:1,sort:y.value,"onUpdate:sort":h[0]||(h[0]=b=>y.value=b),data:w.value,fields:d.value,"row-class":"cursor-pointer",onRowClick:n},{"cell-status_name":a(({value:b})=>[i(D,{color:C(b)},{default:a(()=>[x(f(b),1)]),_:2},1032,["color"])]),"cell-displayName":a(({item:b})=>[x(f(b.name)+" "+f(b.type.name.toUpperCase()),1)]),_:1},8,["sort","data","fields"])):(t(),g("div",Au," You are not assigned to any groups. "))]),_:1}),i(R,{label:"Your Info"},{default:a(()=>[i(xe,{person:_.value},null,8,["person"])]),_:1}),i(R,{label:"COIs"},{default:a(()=>[i(be,{person:s.value.person},null,8,["person"])]),_:1}),i(R,{label:"Demographics"},{default:a(()=>[i(_e,{uuid:s.value.person.uuid},null,8,["uuid"])]),_:1})]),_:1})])}}};export{Ou as default};
//# sourceMappingURL=Dashboard-gY6sCy9Z.js.map
