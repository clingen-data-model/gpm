import{_ as R,P as S,a as C,c as t,b as o,e as h,h as u,d as b,w as i,i as p,ah as U,F as v,m as I,f as d,j as m,a1 as O,q as V,k as q,aq as N,r as w,ar as W}from"./app-Cv_muMPT.js";import{P as F,_ as z}from"./ProfileForm-DjMqxOCU.js";import{P as E,C as B}from"./CoiDetail-DM-UAftg.js";import{_ as T,a as x}from"./ExpertisesView-CaGhv2A7.js";const G={name:"PersonProfile",components:{ProfileForm:z,ProfilePicture:E,ProfilePhotoForm:F,CredentialsView:x,ExpertisesView:T},props:{person:{type:S,required:!0}},data(){return{showEditForm:!1}},computed:{formDialogTitle(){return`Edit ${this.userIsPerson(this.person)?"your":`${this.person.name}'s`} information.`},profilePhotoComponent(){return this.hasPermission("people-manage")||this.userIsPerson(this.person)?F:E}},methods:{editPerson(){this.$store.commit("people/setCurrentItemIndex",this.person),this.showEditForm=!0},hideEditForm(){this.showEditForm=!1}}},L={class:"flex space-x-4"},A={class:"mt-4 border-t pt-4"},Y={class:"mt-4 border-t pt-4"},j={key:0},M={key:0},H={key:1},J={key:0},K={key:1},Q={key:2},X={key:0,class:"mt-4 border-t pt-4"},Z={key:0},$={key:1,class:"pt-4 border-t mt-4"};function ee(r,s,e,c,k,_){const g=C("edit-icon-button"),a=C("dictionary-row"),y=C("CredentialsView"),P=C("ExpertisesView"),n=C("ProfileForm"),l=C("modal-dialog");return o(),t("div",null,[r.userIsPerson(e.person)||r.hasPermission("people-manage")?(o(),h(g,{key:0,class:"btn btn-sm float-right",onClick:_.editPerson},{default:i(()=>s[2]||(s[2]=[p(" Edit Info ")])),_:1},8,["onClick"])):u("",!0),b("div",L,[b("div",null,[(o(),h(U(_.profilePhotoComponent),{person:e.person,style:{width:"120px"}},null,8,["person"]))]),b("div",null,[(o(),t(v,null,I(["name","email"],f=>d(a,{key:f,class:"pb-2","label-class":"w-40",label:r.titleCase(f)},{default:i(()=>[p(m(e.person[f]),1)]),_:2},1032,["label"])),64)),b("section",A,[s[3]||(s[3]=b("h3",null,"Profile",-1)),b("div",null,[d(a,{class:"pb-2","label-class":"w-40",label:"Institution"},{default:i(()=>[p(m(e.person.institutionName),1)]),_:1}),d(a,{class:"pb-2","label-class":"w-40",label:"Credentials"},{default:i(()=>[d(y,{person:e.person},null,8,["person"])]),_:1}),d(a,{class:"pb-2","label-class":"w-40",label:"Expertise"},{default:i(()=>[d(P,{person:e.person},null,8,["person"])]),_:1}),d(a,{class:"pb-2","label-class":"w-40",label:"Biography"},{default:i(()=>[p(m(e.person.biography),1)]),_:1})])]),b("section",Y,[r.userIsPerson(e.person)||r.hasRole("super-admin")||r.hasRole("admin")?(o(),t("div",j,[d(a,{class:"pb-2","label-class":"w-40",label:"Phone"},{default:i(()=>[p(m(e.person.phone),1)]),_:1}),d(a,{class:"pb-2","label-class":"w-40",label:"Address"},{default:i(()=>[b("div",null,[e.person.street1?(o(),t("div",M,m(e.person.street1),1)):u("",!0),e.person.street2?(o(),t("div",H,m(e.person.street2),1)):u("",!0),b("div",null,[e.person.city?(o(),t("span",J,m(e.person.city)+",",1)):u("",!0),s[4]||(s[4]=p()),e.person.state?(o(),t("span",K,m(e.person.state),1)):u("",!0),s[5]||(s[5]=p()),e.person.zip?(o(),t("span",Q,m(e.person.zip),1)):u("",!0)])])]),_:1})])):u("",!0),d(a,{class:"pb-2","label-class":"w-40",label:"Country"},{default:i(()=>[p(m(e.person.country?e.person.country.name:""),1)]),_:1}),d(a,{class:"pb-2","label-class":"w-40",label:"Timezone"},{default:i(()=>[p(m(e.person.timezone),1)]),_:1})]),r.hasPermission("people-manage")?(o(),t("section",X,[s[6]||(s[6]=b("h3",null,"Metadata",-1)),d(a,{class:"pb-2","label-class":"w-40",label:"Uuid"},{default:i(()=>[p(m(e.person.uuid),1)]),_:1}),d(a,{class:"pb-2","label-class":"w-40",label:"Numeric ID"},{default:i(()=>[p(m(e.person.id),1)]),_:1}),d(a,{class:"pb-2","label-class":"w-40",label:"User ID"},{default:i(()=>[p(m(e.person.user_id||"Account not activated."),1)]),_:1}),e.person.invite?(o(),h(a,{key:0,class:"pb-2","label-class":"w-40",label:"Invite Code"},{default:i(()=>[p(m(e.person.invite.code)+"   ",1),e.person.invite.redeemed_at?(o(),t("span",Z," redeemed on "+m(r.formatDate(e.person.invite.redeemed_at)),1)):u("",!0)]),_:1})):u("",!0),(o(),t(v,null,I(["created_at","updated_at"],f=>d(a,{key:f,class:"pb-2","label-class":"w-40",label:f},{default:i(()=>[p(m(r.formatDate(e.person[f])),1)]),_:2},1032,["label"])),64)),r.hasPermission("people-manage")||r.userIsPerson(e.person)?(o(),t("div",$,[b("button",{class:"btn btn-sm",onClick:s[0]||(s[0]=(...f)=>_.editPerson&&_.editPerson(...f))}," Edit Info ")])):u("",!0)])):u("",!0)])]),(o(),h(O,{to:"body"},[d(l,{modelValue:k.showEditForm,"onUpdate:modelValue":s[1]||(s[1]=f=>k.showEditForm=f),title:_.formDialogTitle},{default:i(()=>[d(n,{person:e.person,onSaved:_.hideEditForm,onCanceled:_.hideEditForm},null,8,["person","onSaved","onCanceled"])]),_:1},8,["modelValue","title"])]))])}const ye=R(G,[["render",ee]]),se={name:"CoiList",components:{CoiDetail:B},props:{person:{type:S,required:!0}},setup(r){const s=V(()=>r.person.membershipsWithCompletedCois.map(l=>l.cois.map(f=>(f.group=l.group,f))).filter(l=>l.completed_at!==null).flat()),e=V(()=>r.person.memberships?r.person.memberships.filter(l=>!!((l.cois===null||l.cois.length===0)&&l.group.expert_panel)):!1),c=[{name:"group.name",label:"Group",type:String,sortable:!0,resolveValue:l=>l.group.display_name},{name:"latest_coi.version",label:"Version",type:String,sortable:!0},{name:"coi_last_completed",label:"Completed",sortable:!0,type:Date}],k=V(()=>{const l={name:"actions",sortable:!1},f={name:"latest_coi.id",label:"ID",sortable:!0},D=[...c];return q("people-manage")?[f,...D,l]:N(r.person)?[...D,l]:c}),_=w({field:"group.name",desc:!1}),g=l=>({name:"alt-coi",params:{name:W(l.group.name),code:l.group.coi_code}}),a=w(null),y=w(null),P=w(!1);return{needsCoi:e,cois:s,coiFields:c,coiSort:_,currentCoi:a,currentGroup:y,showResponseDialog:P,showCoiResponse:l=>{const f=l.cois[l.cois.length-1];a.value=f,y.value=l.group,P.value=!0},getCoiRoute:g,fields:k}}},oe={key:0},te={key:0,class:"mb-4"},ne={key:0},le={class:"my-2"},re={key:1},ie={key:1},ae={key:0},de=["onClick"],ue={key:2},ce={key:0},me=["onClick"],pe={key:3,class:"well"},be={key:1,class:"well"};function fe(r,s,e,c,k,_){const g=C("router-link"),a=C("data-table"),y=C("CoiDetail"),P=C("modal-dialog");return o(),t("div",null,[e.person.membershipsWithCoiRequirement.length>0?(o(),t("div",oe,[e.person.hasPendingCois?(o(),t("div",te,[r.userIsPerson(e.person)?(o(),t("div",ne,[s[3]||(s[3]=b("h3",null,"You must complete a Conflict of Interest Disclosure for the following memberships:",-1)),b("div",le,[(o(!0),t(v,null,I(e.person.membershipsWithPendingCois,n=>(o(),h(g,{key:n.id,class:"block my-0 font-bold p-2 border border-gray-300 first:rounded-t-lg last:rounded-b-lg cursor-pointer hover:bg-blue-50 link",to:c.getCoiRoute(n)},{default:i(()=>[p(m(n.group.display_name),1)]),_:2},1032,["to"]))),128))])])):(o(),t("div",re,[s[4]||(s[4]=b("h3",null,"Outstanding COI disclosures:",-1)),b("ul",null,[(o(!0),t(v,null,I(e.person.membershipsWithPendingCois,n=>(o(),t("li",{key:n.id,class:"list-disc ml-6"},m(n.group.display_name),1))),128))])]))])):u("",!0),e.person.hasCompletedCois?(o(),t("section",ie,[s[7]||(s[7]=b("h3",null,"Completed & Current COI Disclosures",-1)),d(a,{sort:c.coiSort,"onUpdate:sort":s[0]||(s[0]=n=>c.coiSort=n),fields:c.fields,data:e.person.membershipsWithCompletedCois,class:"my-2"},{"cell-actions":i(({item:n})=>[n.coi_last_completed?(o(),t("div",ae,[b("button",{class:"btn btn-xs",onClick:l=>c.showCoiResponse(n)}," View response ",8,de),s[6]||(s[6]=p("   ")),r.userIsPerson(e.person)?(o(),h(g,{key:0,to:{name:"alt-coi",params:{code:n.group.coi_code,name:r.kebabCase(n.group.name)}},class:"btn btn-xs"},{default:i(()=>s[5]||(s[5]=[p(" Update COI ")])),_:2},1032,["to"])):u("",!0)])):u("",!0)]),_:1},8,["sort","fields","data"])])):u("",!0),e.person.hasOutdatedCois?(o(),t("section",ue,[s[10]||(s[10]=b("h3",null,"Past COI Disclosures",-1)),d(a,{sort:c.coiSort,"onUpdate:sort":s[1]||(s[1]=n=>c.coiSort=n),fields:c.fields,data:e.person.membershipsWithOutdatedCois,class:"my-2"},{"cell-actions":i(({item:n})=>[n.coi_last_completed?(o(),t("div",ce,[b("button",{class:"btn btn-xs",onClick:l=>c.showCoiResponse(n)}," View response ",8,me),s[9]||(s[9]=p("   ")),r.userIsPerson(e.person)?(o(),h(g,{key:0,to:{name:"alt-coi",params:{code:n.group.coi_code,name:r.kebabCase(n.group.name)}},class:"btn btn-xs"},{default:i(()=>s[8]||(s[8]=[p(" Update COI ")])),_:2},1032,["to"])):u("",!0)])):u("",!0)]),_:1},8,["sort","fields","data"])])):u("",!0),!e.person.hasPending&&!e.person.completedCois?(o(),t("div",pe," None of your memberships require a conflict of interest disclosure ")):u("",!0)])):(o(),t("div",be," You are not required to complete conflict of interest disclsoures. ")),(o(),h(O,{to:"body"},[d(P,{modelValue:c.showResponseDialog,"onUpdate:modelValue":s[2]||(s[2]=n=>c.showResponseDialog=n),size:"xl"},{default:i(()=>[c.currentCoi?(o(),h(y,{key:0,coi:c.currentCoi,group:c.currentGroup},null,8,["coi","group"])):u("",!0)]),_:1},8,["modelValue"])]))])}const Pe=R(se,[["render",fe]]);export{Pe as C,ye as P};
//# sourceMappingURL=CoiList-C7kTdVOX.js.map
