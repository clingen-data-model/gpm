"use strict";(self["webpackChunkepam"]=self["webpackChunkepam"]||[]).push([[243,257],{9272:function(e,t,l){l.d(t,{Q3:function(){return s},ld:function(){return u},pE:function(){return i},pO:function(){return p},q1:function(){return d}});var o=l(2262),n=l(6252),a=l(812);const r=(0,o.iH)([]),s=(0,n.Fl)((()=>r.value)),i=async e=>{r.value=await a.Z.get(e).then((e=>e.data.data))},d=async(e,t)=>await a.Z.post(e,t).then((e=>(r.value.push(e.data),e.data))),u=async(e,t)=>await a.Z.put(e,t).then((e=>{const t=r.value.findIndex((t=>t.id==e.data.id));return r.value[t]=e.data,e.data})),p=async(e,t)=>await a.Z["delete"](`${e}/${t}`).then((e=>{const l=r.value.findIndex((e=>e.id==t));return r.value.splice(l,1),e}))},5242:function(e,t,l){l.d(t,{Z:function(){return q}});var o=l(6252);const n={key:0,class:"px-3 py-2 rounded border border-gray-300 text-gray-500 bg-gray-200"},a={key:0,class:"flex space-x-1"},r=["onClick"],s=["onClick"],i=["innerHTML"];function d(e,t,l,d,u,p){const m=(0,o.up)("icon-edit"),c=(0,o.up)("icon-trash"),g=(0,o.up)("data-table"),h=(0,o.up)("log-entry-form"),b=(0,o.up)("modal-dialog"),y=(0,o.up)("activity-log-delete-confirmation");return(0,o.wg)(),(0,o.iD)("div",null,[d.hasLogEntries?((0,o.wg)(),(0,o.j4)(g,{key:1,fields:d.fields,data:l.logEntries,sort:d.sort,"onUpdate:sort":t[0]||(t[0]=e=>d.sort=e)},{"cell-id":(0,o.w5)((({item:t})=>[e.hasPermission("groups-manage")?((0,o.wg)(),(0,o.iD)("div",a,[(0,o._)("button",{class:"btn btn-xs inline-block",onClick:e=>d.editLogEntry(t)},[(0,o.Wm)(m,{width:"12"})],8,r),null===t.activity_type?((0,o.wg)(),(0,o.iD)("button",{key:0,onClick:e=>d.confirmDelete(t),class:"btn btn-xs inline-block"},[(0,o.Wm)(c,{width:"12"})],8,s)):(0,o.kq)("",!0)])):(0,o.kq)("",!0)])),"cell-description":(0,o.w5)((({item:e})=>[(0,o._)("div",{innerHTML:e.description,class:"links-blue"},null,8,i)])),_:1},8,["fields","data","sort"])):((0,o.wg)(),(0,o.iD)("div",n," No log entries to display ")),(0,o.Wm)(b,{modelValue:d.editingEntry,"onUpdate:modelValue":t[1]||(t[1]=e=>d.editingEntry=e),title:"Edit log entry"},{default:(0,o.w5)((()=>[(0,o.Wm)(h,{"log-entry":d.selectedEntry,"api-url":l.apiUrl,onSaved:d.closeEntryForm,onCanceled:d.closeEntryForm},null,8,["log-entry","api-url","onSaved","onCanceled"])])),_:1},8,["modelValue"]),(0,o.Wm)(b,{modelValue:d.showDeleteConfirmation,"onUpdate:modelValue":t[2]||(t[2]=e=>d.showDeleteConfirmation=e),title:"Delete this log entry?"},{default:(0,o.w5)((()=>[(0,o.Wm)(y,{logEntry:d.selectedEntry,"api-url":l.apiUrl,onCanceled:d.closeDeleteConfirmation,onDeleted:d.closeDeleteConfirmation},null,8,["logEntry","api-url","onCanceled","onDeleted"])])),_:1},8,["modelValue"])])}var u=l(2262),p=l(3907),m=l(2584),c=l(703),g=l(9272),h={__name:"ActivityLogEntryForm",props:{logEntry:{required:!1,default:()=>({log_date:(new Date).toISOString(),step:null,entry:""})},apiUrl:{required:!0,type:String}},emits:["saved"],setup(e,{emit:t}){const l=e,n=(0,p.oR)(),a=(0,u.iH)({log_date:(new Date).toISOString(),step:null,entry:""}),r=(0,u.iH)({}),s=(0,o.Fl)((()=>n.getters["groups/currentItemOrNew"])),i=e=>{e&&e.created_at&&(a.value={id:e.id,log_date:new Date(Date.parse(e.created_at)).toISOString(),step:e.step,entry:e.description})},d=()=>{a.value={log_date:(new Date).toISOString(),step:null,entry:""}},h=async()=>{try{a.value.id?await(0,g.ld)(`${l.apiUrl}/${a.value.id}`,a.value):await(0,g.q1)(l.apiUrl,a.value),await(0,g.pE)(l.apiUrl),d(),t("saved",a.value)}catch(e){if(e.response&&422==e.response.status&&e.response.data.errors)return void(r.value=e.response.data.errors)}},b=()=>{d(),t("canceled")};return(0,o.YP)((()=>l.logEntry),(e=>{i(e)}),{immediate:!0}),(e,t)=>{const l=(0,o.up)("input-row"),n=(0,o.up)("button-row"),i=(0,o.up)("form-container");return(0,o.wg)(),(0,o.j4)(i,{class:"log-entry-form",ref:"form-container"},{default:(0,o.w5)((()=>[(0,o.Wm)(l,{label:"Log Date",modelValue:a.value.log_date,"onUpdate:modelValue":t[0]||(t[0]=e=>a.value.log_date=e),errors:r.value.log_date,type:"date",ref:"logdate"},null,8,["modelValue","errors"]),(0,u.SU)(s).isVcep()?((0,o.wg)(),(0,o.j4)(c["default"],{key:0,errors:r.value.step,modelValue:a.value.step,"onUpdate:modelValue":t[1]||(t[1]=e=>a.value.step=e)},null,8,["errors","modelValue"])):(0,o.kq)("",!0),(0,o.Wm)(l,{label:"Entry",errors:r.value.entry},{default:(0,o.w5)((()=>[(0,o.Wm)(m["default"],{modelValue:a.value.entry,"onUpdate:modelValue":t[2]||(t[2]=e=>a.value.entry=e)},null,8,["modelValue"])])),_:1},8,["errors"]),(0,o.Wm)(n,null,{default:(0,o.w5)((()=>[(0,o._)("button",{class:"btn",onClick:b},"Cancel"),(0,o._)("button",{class:"btn blue",onClick:h},"Save")])),_:1})])),_:1},512)}}};const b=h;var y=b,w=l(3577);const f=(0,o._)("p",null,"You are about to delete the following log entry:",-1),v={class:"border-y py-2"},_=["innerHTML"],D={key:0,class:"ml-4 mt-2 mb-4 text-gray-700 text-sm"},C=(0,o._)("div",null,"This can not be undone. Are you sure you want to continue?",-1),k={key:0,class:"bg-red-200 text-red-900 rounded p-2 my-2"};function E(e,t,l,n,a,r){const s=(0,o.up)("button-row");return(0,o.wg)(),(0,o.iD)("div",null,[f,(0,o._)("div",v,[(0,o._)("blockquote",null,[(0,o._)("div",{innerHTML:l.logEntry.description},null,8,_)]),l.logEntry.causer?((0,o.wg)(),(0,o.iD)("div",D,"Logged by "+(0,w.zw)(l.logEntry.causer.name)+", "+(0,w.zw)(n.logDate),1)):(0,o.kq)("",!0)]),C,n.flattenedErrors.length>0?((0,o.wg)(),(0,o.iD)("div",k,[(0,o._)("ul",null,[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(n.flattenedErrors,((e,t)=>((0,o.wg)(),(0,o.iD)("li",{key:t},(0,w.zw)(e),1)))),128))])])):(0,o.kq)("",!0),(0,o.Wm)(s,{onCanceled:t[0]||(t[0]=t=>e.$emit("canceled")),onSubmitted:n.deleteLogEntry,submitText:"Delete Log Entry"},null,8,["onSubmitted"])])}var M=l(5699),W=l(9700),L={name:"ConfirmDeleteLogEntry",props:{logEntry:{required:!0,type:Object},apiUrl:{required:!0,type:String}},emits:["deleted","canceled"],setup(e,t){const l=(0,u.iH)({}),n=(0,o.Fl)((()=>(0,M.p6)(e.logEntry.log_date))),a=(0,o.Fl)((()=>Object.values(l.value).flat())),r=async()=>{try{await(0,g.pO)(e.apiUrl,e.logEntry.id),t.emit("deleted"),await(0,g.pE)(e.apiUrl)}catch(o){if((0,W.Z)(o))return void(l.value=o.response.data.errors);l.value={a:o.message}}};return{errors:l,logDate:n,flattenedErrors:a,deleteLogEntry:r}}},U=l(3744);const V=(0,U.Z)(L,[["render",E]]);var x=V;const P=[{name:"created_at",label:"Date & Time",sortName:"created_at",sortable:!0,resolveValue({created_at:e}){return e?(0,M.p6)(e):null},type:Date,colspan:2,class:"w-16"},{name:"created_at",label:"Time",sortName:"created_at",hideHeader:!0,sortable:!1,resolveValue({created_at:e}){return e?(0,M.mr)(e):null},class:"w-28",type:Date},{name:"description",label:"Entry",sortable:!0,type:String},{name:"causer.name",label:"User",sortable:!0},{name:"id",label:"",sortable:!1}];var S={components:{LogEntryForm:y,ActivityLogDeleteConfirmation:x},props:{logEntries:{required:!0,type:Array},apiUrl:{required:!0,type:String}},setup(e){const t=(0,u.iH)({field:"created_at",desc:!0}),l=(0,u.iH)({}),n=(0,u.iH)(!1),a=(0,u.iH)(!1),r=(0,o.Fl)((()=>e.logEntries.length>0)),s=e=>{n.value=!0,l.value=e},i=()=>{n.value=!1,l.value={}},d=e=>{l.value=e,a.value=!0},p=()=>{a.value=!1,l.value={}};return{fields:(0,u.iH)(P),sort:t,selectedEntry:l,editingEntry:n,hasLogEntries:r,editLogEntry:s,closeEntryForm:i,showDeleteConfirmation:a,confirmDelete:d,closeDeleteConfirmation:p}}};const $=(0,U.Z)(S,[["render",d]]);var q=$},2677:function(e,t,l){l.r(t),l.d(t,{default:function(){return me}});var o=l(6252),n=l(3577);const a={class:"pb-4"},r={class:"flex space-x-4"},s={class:"flex-1"},i=(0,o.Uk)("People"),d={class:"flex justify-between items-center"},u=(0,o._)("h2",null,"Groups",-1),p=(0,o._)("h2",null,"Profile",-1),m={class:"flex space-x-4 items-center"},c={class:"flex space-x-4 items-center"},g=(0,o._)("h2",null,"Log Entries",-1),h={class:"border my-4 p-4 bg-red-100 border-red-200 rounded"},b=(0,o._)("h2",{class:"mb-4 text-red-800"}," Here be dragons. Proceed with caution. ",-1),y=(0,o._)("p",null,"You are about to delete this person. All related data will also be deleted including:",-1),w=(0,o._)("ul",{class:"list-disc pl-6"},[(0,o._)("li",null,"User record, system roles, and system permissions (if account is activated)"),(0,o._)("li",null,"Invite"),(0,o._)("li",null,"Group Memberships and group roles (if any)")],-1),f=(0,o._)("div",{class:"border my-4 px-2 py-1 font-bold bg-red-100 border-red-200 rounded text-red-800"}," This cannot be undone. ",-1);function v(e,t,l,v,_,D){const C=(0,o.up)("profile-picture"),k=(0,o.up)("router-link"),E=(0,o.up)("note"),M=(0,o.up)("icon-edit"),W=(0,o.up)("dictionary-row"),L=(0,o.up)("membership-list"),U=(0,o.up)("tab-item"),V=(0,o.up)("person-profile"),x=(0,o.up)("demographics-form"),P=(0,o.up)("coi-list"),S=(0,o.up)("refresh-button"),$=(0,o.up)("person-mail-log"),q=(0,o.up)("activity-log"),I=(0,o.up)("tabs-container"),H=(0,o.up)("router-view"),j=(0,o.up)("modal-dialog"),F=(0,o.up)("button-row"),R=(0,o.up)("person-merge-form");return(0,o.wg)(),(0,o.iD)("div",null,[(0,o._)("header",a,[(0,o._)("div",r,[(0,o.Wm)(C,{person:e.person,style:{width:"155px"},class:"rounded-lg"},null,8,["person"]),(0,o._)("div",s,[(0,o.Wm)(k,{class:"note",to:"/people"},{default:(0,o.w5)((()=>[i])),_:1}),(0,o._)("h1",d,[(0,o._)("div",null,[(0,o.Uk)((0,n.zw)(e.person.name)+" ",1),(0,o.Wm)(E,null,{default:(0,o.w5)((()=>[(0,o.Uk)("ID: "+(0,n.zw)(e.person.id),1)])),_:1})]),e.hasPermission("people-manage")||e.userIsPerson(e.person)||e.coordinatesPerson(e.person)?((0,o.wg)(),(0,o.j4)(k,{key:0,to:`/people/${l.uuid}/edit`,class:"btn btn-xs flex-grow-0"},{default:(0,o.w5)((()=>[(0,o.Wm)(M,{width:"16",heigh:"16"})])),_:1},8,["to"])):(0,o.kq)("",!0)]),(0,o.Wm)(W,{label:"Email","label-class":"w-24 font-bold"},{default:(0,o.w5)((()=>[(0,o.Uk)((0,n.zw)(e.person.email),1)])),_:1}),(0,o.Wm)(W,{label:"Institution","label-class":"w-24 font-bold"},{default:(0,o.w5)((()=>[(0,o.Uk)((0,n.zw)(e.person.institution?e.person.institution.name:null),1)])),_:1})])])]),(0,o.Wm)(I,null,{default:(0,o.w5)((()=>[(0,o.Wm)(U,{label:"groups"},{default:(0,o.w5)((()=>[u,(0,o.Wm)(L,{person:e.person},null,8,["person"])])),_:1}),(0,o.Wm)(U,{label:"Info"},{default:(0,o.w5)((()=>[p,(0,o.Wm)(V,{person:e.person},null,8,["person"])])),_:1}),(0,o.Wm)(U,{label:"Demographics",visible:e.hasRole("super-admin")||e.userIsPerson(e.person)},{default:(0,o.w5)((()=>[(0,o.Wm)(x,{person:e.person},null,8,["person"])])),_:1},8,["visible"]),(0,o.Wm)(U,{label:"Conflict of Interest"},{default:(0,o.w5)((()=>[(0,o.Wm)(P,{person:e.person},null,8,["person"])])),_:1}),(0,o.Wm)(U,{label:"Email Log",visible:e.hasPermission("people-manage")||e.userIsPerson(e.person)||e.coordinatesPerson(e.person)},{default:(0,o.w5)((()=>[(0,o._)("header",m,[(0,o._)("h2",null,"Mail sent to "+(0,n.zw)(e.person.first_name),1),(0,o.Wm)(S,{loading:_.mailLoading,onClick:D.getMailLog},null,8,["loading","onClick"])]),(0,o.Wm)($,{person:e.person,mail:D.sortedMailLog},null,8,["person","mail"])])),_:1},8,["visible"]),(0,o.Wm)(U,{label:"Log",visible:e.hasPermission("people-manage")||e.coordinatesPerson(e.person)},{default:(0,o.w5)((()=>[(0,o._)("div",c,[g,(0,o.Wm)(S,{loading:_.logsLoading,onClick:D.getLogEntries},null,8,["loading","onClick"])]),(0,o.Wm)(q,{"log-entries":v.logEntries,"api-url":`/api/people/${e.person.uuid}/activity-logs`,"log-updated":D.getLogEntries},null,8,["log-entries","api-url","log-updated"])])),_:1},8,["visible"]),(0,o.Wm)(U,{label:"Admin",visible:e.hasPermission("people-manage")},{default:(0,o.w5)((()=>[(0,o._)("section",h,[b,(0,o._)("p",null,[(0,o._)("button",{class:"btn btn red",onClick:t[0]||(t[0]=(...e)=>D.initMerge&&D.initMerge(...e))},"Merge Person into another")]),(0,o._)("p",null,[(0,o._)("button",{class:"btn btn red",onClick:t[1]||(t[1]=(...e)=>D.initDelete&&D.initDelete(...e))},"Delete Person")])])])),_:1},8,["visible"])])),_:1}),((0,o.wg)(),(0,o.j4)(o.lR,{to:"body"},[(0,o.Wm)(j,{modelValue:D.showModal,"onUpdate:modelValue":t[2]||(t[2]=e=>D.showModal=e),title:e.$route.meta.title},{default:(0,o.w5)((()=>[(0,o.Wm)(H,{name:"modal"})])),_:1},8,["modelValue","title"]),(0,o.Wm)(j,{title:`You are about to delete ${e.person.name}`,modelValue:_.showDeleteConfirmation,"onUpdate:modelValue":t[3]||(t[3]=e=>_.showDeleteConfirmation=e)},{default:(0,o.w5)((()=>[y,w,f,(0,o.Wm)(F,{"submit-text":`Delete ${e.person.name}`,onSubmitted:D.commitDelete,onCanceled:D.cancelDelete,"submit-variant":"red"},null,8,["submit-text","onSubmitted","onCanceled"])])),_:1},8,["title","modelValue"]),(0,o.Wm)(j,{title:`Merge ${e.person.name} into another person`,modelValue:_.showMergeForm,"onUpdate:modelValue":t[4]||(t[4]=e=>_.showMergeForm=e)},{default:(0,o.w5)((()=>[(0,o.Wm)(R,{obsolete:e.person,onSaved:D.handleMerged,onCanceled:D.handleMergeCanceled},null,8,["obsolete","onSaved","onCanceled"])])),_:1},8,["title","modelValue"])]))])}var _=l(3907),D=l(5699),C=l(9272),k=l(2640);function E(e,t,l,n,a,r){const s=(0,o.up)("data-table");return(0,o.wg)(),(0,o.iD)("div",null,[(0,o.Wm)(s,{fields:a.fields,data:r.memberships,sort:a.sort,"onUpdate:sort":t[0]||(t[0]=e=>a.sort=e),rowClickHandler:r.goToGroup,"row-class":()=>"cursor-pointer"},null,8,["fields","data","sort","rowClickHandler","row-class"])])}var M=l(8979),W={name:"MembershipList",props:{person:{type:Object,required:!0}},data(){return{sort:{field:"group.displayName",desc:!1},fields:[{name:"group.displayName",type:String,sortable:!0,label:"Name"},{name:"group.type.name",type:String,sortable:!0,label:"Type"},{name:"roles",type:String,sortable:!1,label:"Roles",resolveValue(e){return e.roles.map((e=>e.name)).join(", ")}},{name:"permissions",type:String,sortable:!1,label:"Permissions",resolveValue(e){return e.permissions.map((e=>e.name)).join(", ")}},{name:"start_date",type:Date,sortable:!0,label:"Started"},{name:"end_date",type:Date,sortable:!0,label:"Ended"}]}},computed:{memberships(){return this.person.memberships?this.person.memberships.map((e=>(e.group&&(e.group=new M.ZA(e.group)),e))):[]}},methods:{goToGroup(e){this.$router.push({name:"GroupDetail",params:{uuid:e.group.uuid}})}}},L=l(3744);const U=(0,L.Z)(W,[["render",E]]);var V=U,x=l(4923);const P=(0,o._)("p",{class:"mb-8"},[(0,o.Uk)(" Merging peple will do the following: "),(0,o._)("ol",{class:"list-decimal ml-6"},[(0,o._)("li",null,"Add the authoritative person to all groups of which the obsolete person is a member."),(0,o._)("li",null,"Delete the obsolete person, their memberships, their invite, and their user account (if activated).")])],-1),S=(0,o.Uk)(" Merge "),$=(0,o.Uk)("(Obsolete person that will be deleted)"),q=(0,o.Uk)("Into "),I=(0,o.Uk)("(Authoritative person)");function H(e,t,l,n,a,r){const s=(0,o.up)("note"),i=(0,o.up)("person-search-select"),d=(0,o.up)("input-row"),u=(0,o.up)("button-row");return(0,o.wg)(),(0,o.iD)("div",null,[P,(0,o.Wm)(d,{label:"Merge",vertical:""},{label:(0,o.w5)((()=>[S,(0,o.Wm)(s,{class:"inline-block"},{default:(0,o.w5)((()=>[$])),_:1})])),default:(0,o.w5)((()=>[(0,o.Wm)(i,{modelValue:a.obsoleteCopy,"onUpdate:modelValue":t[0]||(t[0]=e=>a.obsoleteCopy=e),"allow-add":!1},null,8,["modelValue"])])),_:1}),(0,o.Wm)(d,{label:"Into",errors:a.errors.authority_id,vertical:""},{label:(0,o.w5)((()=>[q,(0,o.Wm)(s,{class:"inline"},{default:(0,o.w5)((()=>[I])),_:1})])),default:(0,o.w5)((()=>[(0,o.Wm)(i,{modelValue:a.authorityCopy,"onUpdate:modelValue":t[1]||(t[1]=e=>a.authorityCopy=e),"allow-add":!1},null,8,["modelValue"])])),_:1},8,["errors"]),(0,o.Wm)(u,{"submit-text":"Merge",onSubmitted:r.commitMerge,onCanceled:r.cancelMerge},null,8,["onSubmitted","onCanceled"])])}var j=l(9028),F={name:"PersonMergeForm",props:{authority:{type:Object,required:!1},obsolete:{type:Object,default:()=>({})}},emits:["saved","canceled"],data(){return{authorityCopy:null,obsoleteCopy:null,errors:{}}},watch:{authority:{immediate:!0,handler(e){e&&(this.authorityCopy={...e.attributes})}},obsolete:{immediate:!0,handler(e){e&&(this.obsoleteCopy={...e.attributes})}}},methods:{async commitMerge(){try{this.errors={},await this.$store.dispatch("people/mergePeople",{authority:this.authorityCopy,obsolete:this.obsoleteCopy}),this.authorityId=null,this.obsoleteIds=null,this.$emit("saved")}catch(e){if((0,j.z1)(e))return void(this.errors=e.response.data.errors)}},cancelMerge(){this.authorityId=null,this.obsoleteId=null,this.$emit("canceled")}}};const R=(0,L.Z)(F,[["render",H]]);var Z=R,T=l(7026),z=l(5242),O=l(9963);const A={key:0,class:"well"},N=(0,o._)("span",{class:"text-gray-600"},"Sent at",-1),G=(0,o._)("span",{class:"text-gray-600"},"To:",-1),Y={key:0},K=(0,o._)("span",{class:"text-gray-600"},"CC:",-1),Q={key:1},B=(0,o._)("span",{class:"text-gray-600"},"BCC:",-1),J={class:"mt-1"},X=(0,o._)("span",{class:"text-gray-600"},"Subject:",-1),ee=(0,o._)("hr",null,null,-1),te=["innerHTML"],le=(0,o._)("hr",null,null,-1),oe=["onClick"];function ne(e,t,l,a,r,s){const i=(0,o.up)("custom-email-form"),d=(0,o.up)("modal-dialog");return(0,o.wg)(),(0,o.iD)("div",null,[0==l.mail.length?((0,o.wg)(),(0,o.iD)("div",A,(0,n.zw)(l.person.first_name)+" has not received any mail via the GPM. ",1)):(0,o.kq)("",!0),((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(l.mail,(t=>((0,o.wg)(),(0,o.iD)("div",{class:"w-3/4 my-4 p-4 border",key:t.id},[N,(0,o.Uk)(" "+(0,n.zw)(e.formatDate(t.created_at))+" ",1),(0,o._)("div",null,[G,(0,o.Uk)(" "+(0,n.zw)(t.to.map((e=>e.address)).join(", ")),1)]),t.cc?((0,o.wg)(),(0,o.iD)("div",Y,[K,(0,o.Uk)(" "+(0,n.zw)(t.cc.map((e=>e.address)).join(", ")),1)])):(0,o.kq)("",!0),t.bcc?((0,o.wg)(),(0,o.iD)("div",Q,[B,(0,o.Uk)(" "+(0,n.zw)(t.bcc.map((e=>e.address)).join(", ")),1)])):(0,o.kq)("",!0),(0,o._)("div",J,[X,(0,o.Uk)(" "+(0,n.zw)(t.subject),1)]),ee,(0,o._)("div",{innerHTML:t.body},null,8,te),le,e.hasPermission("people-manage")||e.coordinatesPerson(l.person)?((0,o.wg)(),(0,o.iD)("button",{key:2,onClick:(0,O.iM)((e=>s.initResend(t)),["stop"]),class:"btn btn-xs"}," Resend ",8,oe)):(0,o.kq)("",!0)])))),128)),((0,o.wg)(),(0,o.j4)(o.lR,{to:"body"},[(0,o.Wm)(d,{title:"Resend Email",modelValue:r.showResendDialog,"onUpdate:modelValue":t[0]||(t[0]=e=>r.showResendDialog=e)},{default:(0,o.w5)((()=>[(0,o.Wm)(i,{"mail-data":r.currentEmail,onSent:s.cleanupResend,onCanceled:s.cleanupResend},null,8,["mail-data","onSent","onCanceled"])])),_:1},8,["modelValue"])]))])}var ae={name:"ComponentName",props:{person:{type:Object,required:!0},mail:{type:Array,required:!0}},data(){return{currentEmail:{},showResendDialog:null}},computed:{},methods:{initResend(e){this.currentEmail={...e},this.showResendDialog=!0},cleanupResend(){this.currentEmail={},this.showResendDialog=!1,this.$store.dispatch("people/getMail",this.person)}}};const re=(0,L.Z)(ae,[["render",ne]]);var se=re,ie=l(6570),de=l(3613),ue={name:"PersonDetail",components:{TabsContainer:k["default"],MembershipList:V,PersonProfile:x.Z,DemographicsForm:de["default"],PersonMergeForm:Z,CoiList:T.Z,ActivityLog:z.Z,PersonMailLog:se,ProfilePicture:ie.Z},props:{uuid:{required:!0,type:String}},data(){return{showDeleteConfirmation:!1,showMergeForm:!1,mailLoading:!1,logsLoading:!1}},watch:{uuid:{immediate:!0,handler:async function(){await this.$store.dispatch("people/getPerson",{uuid:this.uuid}),this.coordinatesPerson(this.person)&&(this.getLogEntries(),this.getMailLog())}},"person.memberships":function(e){e.length>0&&(this.getLogEntries(),this.getMailLog())}},computed:{...(0,_.Se)({person:"people/currentItem"}),showModal:{get(){return this.$route.meta.showModal},set(e){e&&this.$router.push({name:"PersonEdit",params:{uuid:this.person.uuid}}),this.$router.push({name:"PersonDetail",params:{uuid:this.person.uuid}})}},sortedMailLog(){return[...this.person.mailLog].sort(((e,t)=>e.created_at==t.created_at?0:Date.parse(e.created_at)>Date.parse(t.created_at)?-1:1))}},methods:{initDelete(){this.showDeleteConfirmation=!0},async commitDelete(){await this.$store.dispatch("people/deletePerson",this.person),this.showDeleteConfirmation=!1,this.$router.go(-1)},cancelDelete(){this.showDeleteConfirmation=!1},initMerge(){this.showMergeForm=!0},handleMerged(){this.showMergeForm=!1,this.$router.go(-1)},handleMergeCanceled(){this.showMergeForm=!1},async getMailLog(){this.mailLoading=!0,await this.$store.dispatch("people/getMail",this.person),this.mailLoading=!1},async getLogEntries(){this.logsLoading=!0,await this.fetchEntries(`/api/people/${this.uuid}/activity-logs`),this.logsLoading=!1}},setup(){return{formatDate:D.o0,logEntries:C.Q3,fetchEntries:C.pE}},onmounted(){this.$store.dispatch("people/clearCurrentItem")}};const pe=(0,L.Z)(ue,[["render",v]]);var me=pe}}]);
//# sourceMappingURL=243.527c29c4.js.map