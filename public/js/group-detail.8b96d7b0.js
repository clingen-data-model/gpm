"use strict";(self["webpackChunkepam"]=self["webpackChunkepam"]||[]).push([[205],{6412:function(e,t,o){o.d(t,{Z:function(){return b}});var n=o(6252),r=o(3577);const a={class:"flex space-x-2 items-center mb-3"},i={key:0},s=(0,n.Uk)(" has"),l={key:1},u=(0,n.Uk)(" an "),p=(0,n.Uk)(" due on "),d=(0,n.Uk)(". "),c=(0,n.Uk)(" Complete the Annual Update ");function m(e,t,o,m,g,h){const w=(0,n.up)("icon-review"),y=(0,n.up)("router-link"),b=(0,n.up)("static-alert");return h.isPending&&g.annualReview.id?((0,n.wg)(),(0,n.j4)(b,{key:0,variant:h.variant},{default:(0,n.w5)((()=>[(0,n._)("div",a,[(0,n.Wm)(w,{height:"30",width:"30"}),(0,n._)("div",null,[(0,n._)("p",null,[o.showGroupName?((0,n.wg)(),(0,n.iD)("span",i,[(0,n._)("strong",null,(0,r.zw)(o.group.displayName),1),s])):((0,n.wg)(),(0,n.iD)("span",l,"You have")),u,(0,n._)("strong",null,"annual update for "+(0,r.zw)(h.window.for_year),1),p,(0,n._)("strong",null,(0,r.zw)(e.formatDate(h.window.end)),1),d]),o.group.uuid?((0,n.wg)(),(0,n.j4)(y,{key:0,class:"btn font-bold",to:{name:"AnnualUpdate",params:{uuid:o.group.uuid}}},{default:(0,n.w5)((()=>[c])),_:1},8,["to"])):(0,n.kq)("",!0)])])])),_:1},8,["variant"])):(0,n.kq)("",!0)}var g=o(9028),h={name:"AnnualUpdateAlert",props:{group:{type:Object,required:!0},showGroupName:{type:Boolean,default:!1}},data(){return{annualReview:{},loading:!1}},computed:{window(){return this.annualReview.window?this.annualReview.window:{}},isPending(){return this.annualReview&&!this.annualReview.completed_at},variant(){const e=new Date;if(!this.window.end)return"warning";const t=new Date(Date.parse(this.window.end));return e>this.addDays(t,-7)?"danger":"warning"}},watch:{group:{immediate:!0,handler(){this.getAnnualUpdate()}}},methods:{getAnnualUpdate(){this.group.uuid&&this.group.expert_panel.definition_is_approved&&(this.loading=!0,g.hi.get(`/api/groups/${this.group.uuid}/expert-panel/annual-updates`,{headers:{"X-Ignore-Missing":1}}).then((e=>{this.annualReview=e.data})),this.loading=!1)}}},w=o(3744);const y=(0,w.Z)(h,[["render",m]]);var b=y},5242:function(e,t,o){o.d(t,{Z:function(){return j}});var n=o(6252);const r={key:0,class:"px-3 py-2 rounded border border-gray-300 text-gray-500 bg-gray-200"},a={key:0,class:"flex space-x-1"},i=["onClick"],s=["onClick"],l=["innerHTML"];function u(e,t,o,u,p,d){const c=(0,n.up)("icon-edit"),m=(0,n.up)("icon-trash"),g=(0,n.up)("data-table"),h=(0,n.up)("log-entry-form"),w=(0,n.up)("modal-dialog"),y=(0,n.up)("activity-log-delete-confirmation");return(0,n.wg)(),(0,n.iD)("div",null,[u.hasLogEntries?((0,n.wg)(),(0,n.j4)(g,{key:1,fields:u.fields,data:o.logEntries,sort:u.sort,"onUpdate:sort":t[0]||(t[0]=e=>u.sort=e)},{"cell-id":(0,n.w5)((({item:t})=>[e.hasPermission("groups-manage")?((0,n.wg)(),(0,n.iD)("div",a,[(0,n._)("button",{class:"btn btn-xs inline-block",onClick:e=>u.editLogEntry(t)},[(0,n.Wm)(c,{width:"12"})],8,i),null===t.activity_type?((0,n.wg)(),(0,n.iD)("button",{key:0,onClick:e=>u.confirmDelete(t),class:"btn btn-xs inline-block"},[(0,n.Wm)(m,{width:"12"})],8,s)):(0,n.kq)("",!0)])):(0,n.kq)("",!0)])),"cell-description":(0,n.w5)((({item:e})=>[(0,n._)("div",{innerHTML:e.description,class:"links-blue"},null,8,l)])),_:1},8,["fields","data","sort"])):((0,n.wg)(),(0,n.iD)("div",r," No log entries to display ")),(0,n.Wm)(w,{modelValue:u.editingEntry,"onUpdate:modelValue":t[1]||(t[1]=e=>u.editingEntry=e),title:"Edit log entry"},{default:(0,n.w5)((()=>[(0,n.Wm)(h,{"log-entry":u.selectedEntry,"api-url":o.apiUrl,onSaved:u.closeEntryForm,onCanceled:u.closeEntryForm},null,8,["log-entry","api-url","onSaved","onCanceled"])])),_:1},8,["modelValue"]),(0,n.Wm)(w,{modelValue:u.showDeleteConfirmation,"onUpdate:modelValue":t[2]||(t[2]=e=>u.showDeleteConfirmation=e),title:"Delete this log entry?"},{default:(0,n.w5)((()=>[(0,n.Wm)(y,{logEntry:u.selectedEntry,"api-url":o.apiUrl,onCanceled:u.closeDeleteConfirmation,onDeleted:u.closeDeleteConfirmation},null,8,["logEntry","api-url","onCanceled","onDeleted"])])),_:1},8,["modelValue"])])}var p=o(2262),d=o(3907),c=o(2584),m=o(703),g=o(9272),h={__name:"ActivityLogEntryForm",props:{logEntry:{required:!1,default:()=>({log_date:(new Date).toISOString(),step:null,entry:""})},apiUrl:{required:!0,type:String}},emits:["saved"],setup(e,{emit:t}){const o=e,r=(0,d.oR)(),a=(0,p.iH)({log_date:(new Date).toISOString(),step:null,entry:""}),i=(0,p.iH)({}),s=(0,n.Fl)((()=>r.getters["groups/currentItemOrNew"])),l=e=>{e&&e.created_at&&(a.value={id:e.id,log_date:new Date(Date.parse(e.created_at)).toISOString(),step:e.step,entry:e.description})},u=()=>{a.value={log_date:(new Date).toISOString(),step:null,entry:""}},h=async()=>{try{a.value.id?await(0,g.ld)(`${o.apiUrl}/${a.value.id}`,a.value):await(0,g.q1)(o.apiUrl,a.value),await(0,g.pE)(o.apiUrl),u(),t("saved",a.value)}catch(e){if(e.response&&422==e.response.status&&e.response.data.errors)return void(i.value=e.response.data.errors)}},w=()=>{u(),t("canceled")};return(0,n.YP)((()=>o.logEntry),(e=>{l(e)}),{immediate:!0}),(e,t)=>{const o=(0,n.up)("input-row"),r=(0,n.up)("button-row"),l=(0,n.up)("form-container");return(0,n.wg)(),(0,n.j4)(l,{class:"log-entry-form",ref:"form-container"},{default:(0,n.w5)((()=>[(0,n.Wm)(o,{label:"Log Date",modelValue:a.value.log_date,"onUpdate:modelValue":t[0]||(t[0]=e=>a.value.log_date=e),errors:i.value.log_date,type:"date",ref:"logdate"},null,8,["modelValue","errors"]),(0,p.SU)(s).isVcep()?((0,n.wg)(),(0,n.j4)(m["default"],{key:0,errors:i.value.step,modelValue:a.value.step,"onUpdate:modelValue":t[1]||(t[1]=e=>a.value.step=e)},null,8,["errors","modelValue"])):(0,n.kq)("",!0),(0,n.Wm)(o,{label:"Entry",errors:i.value.entry},{default:(0,n.w5)((()=>[(0,n.Wm)(c["default"],{modelValue:a.value.entry,"onUpdate:modelValue":t[2]||(t[2]=e=>a.value.entry=e)},null,8,["modelValue"])])),_:1},8,["errors"]),(0,n.Wm)(r,null,{default:(0,n.w5)((()=>[(0,n._)("button",{class:"btn",onClick:w},"Cancel"),(0,n._)("button",{class:"btn blue",onClick:h},"Save")])),_:1})])),_:1},512)}}};const w=h;var y=w,b=o(3577);const f=(0,n._)("p",null,"You are about to delete the following log entry:",-1),v={class:"border-y py-2"},_=["innerHTML"],D={key:0,class:"ml-4 mt-2 mb-4 text-gray-700 text-sm"},k=(0,n._)("div",null,"This can not be undone. Are you sure you want to continue?",-1),C={key:0,class:"bg-red-200 text-red-900 rounded p-2 my-2"};function U(e,t,o,r,a,i){const s=(0,n.up)("button-row");return(0,n.wg)(),(0,n.iD)("div",null,[f,(0,n._)("div",v,[(0,n._)("blockquote",null,[(0,n._)("div",{innerHTML:o.logEntry.description},null,8,_)]),o.logEntry.causer?((0,n.wg)(),(0,n.iD)("div",D,"Logged by "+(0,b.zw)(o.logEntry.causer.name)+", "+(0,b.zw)(r.logDate),1)):(0,n.kq)("",!0)]),k,r.flattenedErrors.length>0?((0,n.wg)(),(0,n.iD)("div",C,[(0,n._)("ul",null,[((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)(r.flattenedErrors,((e,t)=>((0,n.wg)(),(0,n.iD)("li",{key:t},(0,b.zw)(e),1)))),128))])])):(0,n.kq)("",!0),(0,n.Wm)(s,{onCanceled:t[0]||(t[0]=t=>e.$emit("canceled")),onSubmitted:r.deleteLogEntry,submitText:"Delete Log Entry"},null,8,["onSubmitted"])])}var x=o(5699),S=o(9700),E={name:"ConfirmDeleteLogEntry",props:{logEntry:{required:!0,type:Object},apiUrl:{required:!0,type:String}},emits:["deleted","canceled"],setup(e,t){const o=(0,p.iH)({}),r=(0,n.Fl)((()=>(0,x.p6)(e.logEntry.log_date))),a=(0,n.Fl)((()=>Object.values(o.value).flat())),i=async()=>{try{await(0,g.pO)(e.apiUrl,e.logEntry.id),t.emit("deleted"),await(0,g.pE)(e.apiUrl)}catch(n){if((0,S.Z)(n))return void(o.value=n.response.data.errors);o.value={a:n.message}}};return{errors:o,logDate:r,flattenedErrors:a,deleteLogEntry:i}}},W=o(3744);const q=(0,W.Z)(E,[["render",U]]);var F=q;const A=[{name:"created_at",label:"Date & Time",sortName:"created_at",sortable:!0,resolveValue({created_at:e}){return e?(0,x.p6)(e):null},type:Date,colspan:2,class:"w-16"},{name:"created_at",label:"Time",sortName:"created_at",hideHeader:!0,sortable:!1,resolveValue({created_at:e}){return e?(0,x.mr)(e):null},class:"w-28",type:Date},{name:"description",label:"Entry",sortable:!0,type:String},{name:"causer.name",label:"User",sortable:!0},{name:"id",label:"",sortable:!1}];var $={components:{LogEntryForm:y,ActivityLogDeleteConfirmation:F},props:{logEntries:{required:!0,type:Array},apiUrl:{required:!0,type:String}},setup(e){const t=(0,p.iH)({field:"created_at",desc:!0}),o=(0,p.iH)({}),r=(0,p.iH)(!1),a=(0,p.iH)(!1),i=(0,n.Fl)((()=>e.logEntries.length>0)),s=e=>{r.value=!0,o.value=e},l=()=>{r.value=!1,o.value={}},u=e=>{o.value=e,a.value=!0},d=()=>{a.value=!1,o.value={}};return{fields:(0,p.iH)(A),sort:t,selectedEntry:o,editingEntry:r,hasLogEntries:i,editLogEntry:s,closeEntryForm:l,showDeleteConfirmation:a,confirmDelete:u,closeDeleteConfirmation:d}}};const I=(0,W.Z)($,[["render",u]]);var j=I},6968:function(e,t,o){o.r(t),o.d(t,{default:function(){return zt}});var n=o(6252),r=o(3577);const a={class:"flex space-x-4"},i={class:"flex-grow mt-4"},s=(0,n._)("h3",null," Plans for Ongoing Gene Review and Reanalysis and Discrepancy Resolution ",-1),l=(0,n._)("br",null,null,-1),u={key:0,class:"bg-white bg-opacity-50 absolute top-0 left-0 right-0 bottom-0"},p=(0,n.Uk)(" You can complete these sections after your first Specifications Pilot has been approved. "),d={key:2},c=(0,n._)("header",null,[(0,n._)("h3",null,"Example Evidence Summaries")],-1),m={class:"relative"},g={key:0,class:"bg-white bg-opacity-50 absolute top-0 left-0 right-0 bottom-0"},h=(0,n.Uk)(" You can complete these sections after your Group Definition has been approved. "),w=(0,n.Uk)("Documents are only available to members of this group."),y=(0,n.Uk)("The attestations below are read only. Attestations can only be completed during the application process."),b=(0,n._)("h3",null,"Reanalysis & Discrepancy Resolution",-1),f=(0,n._)("h3",null,"NHGRI Data Availability",-1),v={key:0},_=(0,n._)("h2",{class:"pb-2 border-b mb-4"},"Application",-1),D=(0,n._)("hr",null,null,-1),k={key:1,class:"border my-4 p-4 rounded"},C=(0,n._)("h2",{class:"mb-4"},"Annual Update",-1),U=["href"],x={class:"border my-4 p-4 bg-red-100 border-red-200 rounded"},S=(0,n._)("h2",{class:"mb-4 text-red-800"}," Here be dragons. Proceed with caution. ",-1),E={key:2,class:"border my-4 p-4 rounded"},W=(0,n._)("h2",{class:"mb-4"},[(0,n.Uk)(" Dev tools "),(0,n._)("span",{class:"text-gray-500"}," - don't use if you don't know.")],-1),q={key:0,class:"md:w-1/5 lg:w-1/4"},F={class:"text-lg"},A=(0,n._)("p",null,"This cannot be undone.",-1);function $(e,t,o,$,I,j){const M=(0,n.up)("annual-update-alert"),P=(0,n.up)("sustained-curation-review-alert"),V=(0,n.up)("group-detail-header"),L=(0,n.up)("application-summary"),G=(0,n.up)("member-list"),T=(0,n.up)("membership-description-form"),R=(0,n.up)("submission-wrapper"),Z=(0,n.up)("tab-item"),z=(0,n.up)("scope-description-form"),N=(0,n.up)("static-alert"),H=(0,n.up)("evidence-summaries"),O=(0,n.up)("specifications-section"),Y=(0,n.up)("group-documents"),B=(0,n.up)("note"),K=(0,n.up)("attestation-gcep"),J=(0,n.up)("attestation-reanalysis"),Q=(0,n.up)("attestation-nhgri"),X=(0,n.up)("activity-log"),ee=(0,n.up)("progress-chart"),te=(0,n.up)("step-tabs"),oe=(0,n.up)("tabs-container"),ne=(0,n.up)("subgroup-list"),re=(0,n.up)("router-view"),ae=(0,n.up)("modal-dialog"),ie=(0,n.up)("group-form"),se=(0,n.up)("button-row");return(0,n.wg)(),(0,n.iD)("div",null,[e.hasAnyPermission(["annual-updates-mange",["annual-update-manage",$.group]])?((0,n.wg)(),(0,n.j4)(M,{key:0,group:$.group,class:"mb-2"},null,8,["group"])):(0,n.kq)("",!0),$.needsToReviewSustainedCuration&&e.hasAnyPermission(["ep-applications-manage",["application-edit",$.group]])?((0,n.wg)(),(0,n.j4)(P,{key:1,group:$.group,class:"mb-2"},null,8,["group"])):(0,n.kq)("",!0),(0,n.Wm)(V,{group:$.group,onShowEdit:j.showEdit},null,8,["group","onShowEdit"]),(0,n._)("div",a,[(0,n._)("div",i,[$.group.isApplying?((0,n.wg)(),(0,n.j4)(L,{key:0,group:$.group},null,8,["group"])):(0,n.kq)("",!0),(0,n.Wm)(oe,{onTabChanged:j.handleTabChange},{default:(0,n.w5)((()=>[(0,n.Wm)(Z,{label:"Members"},{default:(0,n.w5)((()=>[(0,n.Wm)(G,{group:$.group},null,8,["group"]),$.group.is_vcep_or_scvcep?((0,n.wg)(),(0,n.j4)(R,{key:0,onSubmitted:t[1]||(t[1]=e=>j.submitForm("saveMembershipDescription","editingExpertise")),onCanceled:t[2]||(t[2]=e=>j.cancelForm("editingExpertise")),"show-controls":I.editingExpertise},{default:(0,n.w5)((()=>[(0,n.Wm)(T,{ref:"membershipDescriptionFormRef",class:"mt-8",editing:I.editingExpertise,"onUpdate:editing":t[0]||(t[0]=e=>I.editingExpertise=e),errors:I.errors},null,8,["editing","errors"])])),_:1},8,["show-controls"])):(0,n.kq)("",!0)])),_:1}),(0,n.Wm)(Z,{label:"Scope",visible:$.group.is_ep},{default:(0,n.w5)((()=>[s,$.group.is_ep?((0,n.wg)(),(0,n.j4)(R,{key:0,onSubmitted:t[4]||(t[4]=t=>e.$refs.groupGeneListRef.save()),onCanceled:t[5]||(t[5]=t=>e.$refs.groupGeneListRef.cancel()),"show-controls":I.editingGenes},{default:(0,n.w5)((()=>[((0,n.wg)(),(0,n.j4)((0,n.LL)($.groupGeneList),{ref:"groupGeneListRef",editing:I.editingGenes,"onUpdate:editing":t[3]||(t[3]=e=>I.editingGenes=e)},null,40,["editing"]))])),_:1},8,["show-controls"])):(0,n.kq)("",!0),l,(0,n.Wm)(R,{visible:$.group.is_ep,onSubmitted:t[7]||(t[7]=e=>j.submitForm("saveScopeDescription","editingScopeDescription")),onCanceled:t[8]||(t[8]=e=>j.cancelForm("editingScopeDescription")),"show-controls":I.editingScopeDescription},{default:(0,n.w5)((()=>[(0,n.Wm)(z,{ref:"scopeDescriptionRef",editing:I.editingScopeDescription,"onUpdate:editing":t[6]||(t[6]=e=>I.editingScopeDescription=e),errors:I.errors},null,8,["editing","errors"])])),_:1},8,["visible","show-controls"])])),_:1},8,["visible"]),(0,n.Wm)(Z,{label:"Sustained Curation",visible:$.group.is_ep,class:"relative"},{default:(0,n.w5)((()=>[!$.group.expert_panel.pilotSpecificationsIsApproved&&$.group.is_vcep_or_scvcep?((0,n.wg)(),(0,n.iD)("div",u)):(0,n.kq)("",!0),!$.group.expert_panel.pilotSpecificationsIsApproved&&$.group.is_vcep_or_scvcep?((0,n.wg)(),(0,n.j4)(N,{key:1,variant:"info"},{default:(0,n.w5)((()=>[p])),_:1})):(0,n.kq)("",!0),(0,n.Wm)(R,{onSubmitted:t[9]||(t[9]=e=>j.submitForm("saveOngoingPlansForm")),onCanceled:t[10]||(t[10]=e=>j.cancelForm()),class:"pb-4",showControls:e.hasAnyPermission(["ep-applications-manage",["application-edit",$.group]])&&$.group.expert_panel.pilotSpecificationsIsApproved},{default:(0,n.w5)((()=>[((0,n.wg)(),(0,n.j4)((0,n.LL)($.ongoingPlansFormComponent),{ref:"ongoingPlansForm",errors:I.errors,readonly:!$.group.expert_panel.pilotSpecificationsIsApproved},null,8,["errors","readonly"]))])),_:1},8,["showControls"]),$.group.is_vcep_or_scvcep?((0,n.wg)(),(0,n.iD)("section",d,[c,(0,n.Wm)(H,{group:$.group,readonly:!$.group.expert_panel.pilotSpecificationsIsApproved,class:"pb-2 mb-4 border-b"},null,8,["group","readonly"])])):(0,n.kq)("",!0)])),_:1},8,["visible"]),(0,n.Wm)(Z,{label:"Specifications",visible:$.group.is_vcep_or_scvcep},{default:(0,n.w5)((()=>[(0,n._)("div",m,[!$.group.expert_panel.defIsApproved&&$.group.is_vcep_or_scvcep?((0,n.wg)(),(0,n.iD)("div",g)):(0,n.kq)("",!0),!$.group.expert_panel.defIsApproved&&$.group.is_vcep_or_scvcep?((0,n.wg)(),(0,n.j4)(N,{key:1,variant:"info"},{default:(0,n.w5)((()=>[h])),_:1})):(0,n.kq)("",!0),(0,n._)("div",null,[(0,n.Wm)(O,{"doc-type-id":$.group.expert_panel.draftSpecApproved?[2,3,4,7]:2,step:$.group.expert_panel.draftSpecApproved?3:2},null,8,["doc-type-id","step"])])])])),_:1},8,["visible"]),e.userInGroup($.group)||e.hasPermission("groups-manage")?((0,n.wg)(),(0,n.j4)(Z,{key:0,label:"Documents"},{default:(0,n.w5)((()=>[(0,n.Wm)(Y),(0,n.Wm)(B,null,{default:(0,n.w5)((()=>[w])),_:1})])),_:1})):(0,n.kq)("",!0),(0,n.Wm)(Z,{label:"Attestations",visible:$.group.is_ep},{default:(0,n.w5)((()=>[(0,n.Wm)(B,null,{default:(0,n.w5)((()=>[y])),_:1}),$.group.is_gcep?((0,n.wg)(),(0,n.j4)(K,{key:0,class:"pb-2 mb-4 border-b",disabled:!0})):(0,n.kq)("",!0),b,$.group.is_vcep_or_scvcep?((0,n.wg)(),(0,n.j4)(J,{key:1,class:"pb-2 mb-4 border-b",disabled:!0})):(0,n.kq)("",!0),f,(0,n.Wm)(Q,{class:"pb-2 mb-4 border-b",disabled:!0})])),_:1},8,["visible"]),(0,n.Wm)(Z,{label:"Log",visible:e.hasPermission("groups-manage")||e.userInGroup($.group)},{default:(0,n.w5)((()=>[(0,n.Wm)(X,{"log-entries":$.logEntries,"api-url":`/api/groups/${$.group.uuid}/activity-logs`,"log-updated":$.getLogEntries},null,8,["log-entries","api-url","log-updated"]),(0,n._)("button",{class:"btn btn-xs mt-1",onClick:t[11]||(t[11]=(...e)=>$.getLogEntries&&$.getLogEntries(...e))},"Refresh")])),_:1},8,["visible"]),(0,n.Wm)(Z,{label:"Admin",visible:e.hasPermission("groups-manage")},{default:(0,n.w5)((()=>[$.group.isApplying&&$.group.is_ep?((0,n.wg)(),(0,n.iD)("div",v,[_,(0,n.Wm)(ee,{application:$.group.expert_panel,class:"pb-4 border-b border-gray-300 mb-6"},null,8,["application"]),$.group.is_ep?((0,n.wg)(),(0,n.j4)(te,{key:0,application:$.group.expert_panel,onStepApproved:$.getGroup},null,8,["application","onStepApproved"])):(0,n.kq)("",!0),D])):(0,n.kq)("",!0),$.group.is_ep?((0,n.wg)(),(0,n.iD)("section",k,[C,j.showCreateAnnualUpdateButton?((0,n.wg)(),(0,n.iD)("button",{key:0,class:"btn",onClick:t[12]||(t[12]=(...e)=>j.createAnnualUpdateForLatestWindow&&j.createAnnualUpdateForLatestWindow(...e))}," Create Annual Update for latest window. ")):$.group.expert_panel.annualUpdate?((0,n.wg)(),(0,n.iD)("a",{key:1,href:`/annual-updates/${this.group.expert_panel.annualUpdate.id}`,target:"annual update"}," View Annual Update for "+(0,r.zw)(this.group.expert_panel.annualUpdate.window.for_year),9,U)):(0,n.kq)("",!0)])):(0,n.kq)("",!0),(0,n._)("section",x,[S,(0,n._)("button",{class:"btn btn red",onClick:t[13]||(t[13]=(...e)=>j.initDelete&&j.initDelete(...e))},"Delete Group")]),"production"!==e.$store.state.systemInfo.env?((0,n.wg)(),(0,n.iD)("section",E,[W,$.group.is_vcep_or_scvcep&&$.group.expert_panel.has_approved_pilot?((0,n.wg)(),(0,n.iD)("button",{key:0,class:"btn",onClick:t[14]||(t[14]=(...e)=>j.fakeCspecPilotApproved&&j.fakeCspecPilotApproved(...e))}," Fake a Pilot Approved Message ")):(0,n.kq)("",!0)])):(0,n.kq)("",!0)])),_:1},8,["visible"])])),_:1},8,["onTabChanged"])]),$.group.hasChildren?((0,n.wg)(),(0,n.iD)("div",q,[(0,n.Wm)(ne)])):(0,n.kq)("",!0)]),((0,n.wg)(),(0,n.j4)(n.lR,{to:"body"},[(0,n.Wm)(ae,{modelValue:$.showModal,"onUpdate:modelValue":t[15]||(t[15]=e=>$.showModal=e),onClosed:j.handleModalClosed,title:this.$route.meta.title},{default:(0,n.w5)((()=>[(0,n.Wm)(re,{ref:"modalView",onSaved:j.hideModal,onCanceled:j.hideModal},null,8,["onSaved","onCanceled"])])),_:1},8,["modelValue","onClosed","title"]),(0,n.Wm)(ae,{modelValue:I.showInfoEdit,"onUpdate:modelValue":t[20]||(t[20]=e=>I.showInfoEdit=e),onClosed:t[21]||(t[21]=e=>I.showInfoEdit=!1),title:"Edit Group Info",size:"sm"},{default:(0,n.w5)((()=>[(0,n.Wm)(R,{onSubmitted:t[18]||(t[18]=t=>e.$refs.infoForm.save()),onCanceled:t[19]||(t[19]=t=>e.$refs.infoForm.cancel())},{default:(0,n.w5)((()=>[(0,n.Wm)(ie,{ref:"infoForm",onCanceled:t[16]||(t[16]=e=>I.showInfoEdit=!1),onSaved:t[17]||(t[17]=e=>I.showInfoEdit=!1)},null,512)])),_:1})])),_:1},8,["modelValue"]),(0,n.Wm)(ae,{modelValue:I.showConfirmDelete,"onUpdate:modelValue":t[23]||(t[23]=e=>I.showConfirmDelete=e),title:"Delete This Group?"},{default:(0,n.w5)((()=>[(0,n._)("div",F,[(0,n._)("p",null," You are about to delete "+(0,r.zw)($.group.displayName)+" and all associated data. ",1),A]),(0,n.Wm)(se,{"submit-text":"Delete this group.",onSubmitted:j.deleteGroup,onCanceled:t[22]||(t[22]=e=>I.showConfirmDelete=!1)},null,8,["onSubmitted"])])),_:1},8,["modelValue"])]))])}var I=o(2262),j=o(3907),M=o(9272),P=o(865),V=o(5242);const L={key:0,class:"p-4 my-4 mb-8 border rounded-xl bg-white"},G={class:"mb-2"},T=(0,n.Uk)(" Application Summary "),R={key:0},Z={class:"px-8"},z={key:2},N=(0,n.Uk)("Approved"),H={key:0,class:"flex-1"},O={key:0,class:"mt-4"},Y=(0,n._)("button",{class:"btn blue btn-lg"},"Go to application",-1);function B(e,t,o,a,i,s){const l=(0,n.up)("requirements-badge"),u=(0,n.up)("icon-lock"),p=(0,n.up)("badge"),d=(0,n.up)("router-link");return o.group.is_ep?((0,n.wg)(),(0,n.iD)("div",L,[(0,n._)("h2",G,[T,s.applicationStarted&&o.group.is_vcep_or_scvcep?((0,n.wg)(),(0,n.iD)("span",R," - "+(0,r.zw)(this.currentMenuItem.title),1)):(0,n.kq)("",!0)]),(0,n._)("ul",Z,[((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)(s.menu,((e,t)=>((0,n.wg)(),(0,n.iD)("li",{key:t,class:"py-1 flex justify-between border-b border-gray-300 my-2"},[(0,n._)("div",{class:(0,r.C_)(["flex justify-between",{"w-full":!s.isStep(e)}])},[(0,n._)("div",{class:(0,r.C_)(["w-56 text-lg",{"text-gray-400":s.isStep(e)&&e.isDisabled(o.group)}])},(0,r.zw)(e.title),3),(0,n._)("div",null,[s.isStep(e)?(0,n.kq)("",!0):((0,n.wg)(),(0,n.j4)(l,{key:0,section:e},null,8,["section"])),s.isStep(e)&&e.isDisabled(o.group)?((0,n.wg)(),(0,n.j4)(u,{key:1,class:"inline text-gray-400",height:14,width:14})):(0,n.kq)("",!0),s.isStep(e)&&e.isComplete(o.group)?((0,n.wg)(),(0,n.iD)("div",z,[(0,n.Wm)(p,{color:"green"},{default:(0,n.w5)((()=>[N])),_:1})])):(0,n.kq)("",!0)])],2),s.isCurrentStep(e)?((0,n.wg)(),(0,n.iD)("div",H,[(0,n._)("ul",null,[((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)(e.sections,((e,t)=>((0,n.wg)(),(0,n.iD)("li",{key:t,class:"pb-2 flex justify-between my-2"},[(0,n._)("div",null,(0,r.zw)(e.title),1),(0,n.Wm)(l,{section:e},null,8,["section"])])))),128))])])):(0,n.kq)("",!0)])))),128))]),e.hasAnyPermission(["ep-applications-manage",["application-edit",o.group]])?((0,n.wg)(),(0,n.iD)("div",O,[o.group.uuid?((0,n.wg)(),(0,n.j4)(d,{key:0,to:s.applicationRoute},{default:(0,n.w5)((()=>[Y])),_:1},8,["to"])):(0,n.kq)("",!0)])):(0,n.kq)("",!0)])):(0,n.kq)("",!0)}var K=o(9766),J=o(4981),Q={name:"ApplicationSummary",components:{RequirementsBadge:K.Z},props:{group:{required:!0,type:Object}},data(){return{}},computed:{applicationStarted(){return!0},application(){return(0,J.L)(this.group)},currentStep(){return this.group.expert_panel.current_step},applicationRoute(){return{name:"GroupApplication",params:{uuid:this.group.uuid},hash:`#${this.currentMenuItem.id}`}},currentMenuItem(){return this.application.getStep(this.group.expert_panel.current_step)},menu(){return this.application.steps.length>1?this.application.steps:this.application.steps[0].sections}},methods:{isStep(e){return Boolean(e.sections)},isCurrentStep(e){return!(!this.isStep(e)||this.application.getStep(this.group.expert_panel.current_step)!=e)}}},X=o(3744);const ee=(0,X.Z)(Q,[["render",B]]);var te=ee,oe=o(8012),ne=o(5547),re=o(4561),ae=o(8977),ie=o(9955),se=o(640),le=o(4358),ue=o(7889);const pe={class:"flex justify-between items-start"},de={class:"text-sm text-gray-800 mt-1 font-normal"},ce={key:0},me=(0,n.Uk)("Short Name: "),ge=(0,n.Uk)(" | "),he={key:1},we=(0,n.Uk)(" Affiliation ID: "),ye={key:2},be=(0,n.Uk)(" | Part of the "),fe={key:0},ve=(0,n._)("strong",null,"Chairs:",-1),_e={key:0},De={key:1,class:"text-gray-500"},ke=(0,n._)("strong",null,"Coordinators:",-1),Ce={key:0},Ue={key:1,class:"text-gray-500"};function xe(e,t,o,a,i,s){const l=(0,n.up)("group-breadcrumbs"),u=(0,n.up)("badge"),p=(0,n.up)("router-link"),d=(0,n.up)("note"),c=(0,n.up)("dictionary-row");return(0,n.wg)(),(0,n.iD)("header",null,[(0,n.Wm)(l),(0,n._)("h1",pe,[(0,n._)("div",null,[(0,n.Uk)((0,r.zw)(o.group.displayName)+" ",1),(0,n.Wm)(u,{color:o.group.statusColor,class:"text-xs"},{default:(0,n.w5)((()=>[(0,n.Uk)((0,r.zw)(o.group.status?o.group.status.name:"loading..."),1)])),_:1},8,["color"]),(0,n._)("div",de,[o.group.isEp()&&s.showShortName?((0,n.wg)(),(0,n.iD)("span",ce,[me,(0,n._)("strong",null,(0,r.zw)(o.group.expert_panel.full_short_base_name||"--"),1),ge])):(0,n.kq)("",!0),o.group.isEp()?((0,n.wg)(),(0,n.iD)("span",he,[we,(0,n._)("strong",null,(0,r.zw)(o.group.expert_panel.affiliation_id||"--"),1)])):(0,n.kq)("",!0),o.group.parent_id?((0,n.wg)(),(0,n.iD)("span",ye,[be,(0,n.Wm)(p,{to:{name:"GroupDetail",params:{uuid:o.group.parent.uuid}}},{default:(0,n.w5)((()=>[(0,n.Uk)((0,r.zw)(o.group.parent.name),1)])),_:1},8,["to"])])):(0,n.kq)("",!0)]),e.hasRole("super-user")?((0,n.wg)(),(0,n.j4)(d,{key:0,class:"font-normal mt-2"},{default:(0,n.w5)((()=>[(0,n.Uk)(" group.id: "+(0,r.zw)(o.group.id)+" ",1),o.group.is_ep?((0,n.wg)(),(0,n.iD)("span",fe," | expertPanel.id: "+(0,r.zw)(o.group.expert_panel.id),1)):(0,n.kq)("",!0)])),_:1})):(0,n.kq)("",!0)]),e.hasAnyPermission(["groups-manage",["info-edit",o.group]])?((0,n.wg)(),(0,n.iD)("button",{key:0,onClick:t[0]||(t[0]=t=>e.$emit("showEdit")),class:"btn btn-xs"}," Edit Group Info ")):(0,n.kq)("",!0)]),(0,n.Wm)(c,{label:"Chairs:"},{label:(0,n.w5)((()=>[ve])),default:(0,n.w5)((()=>[o.group.chairs.length>0?((0,n.wg)(),(0,n.iD)("div",_e,(0,r.zw)(o.group.chairs.map((e=>e.person.name)).join(", ")),1)):((0,n.wg)(),(0,n.iD)("div",De," None assigned "))])),_:1}),(0,n.Wm)(c,{label:"Coordinators:"},{label:(0,n.w5)((()=>[ke])),default:(0,n.w5)((()=>[o.group.coordinators.length>0?((0,n.wg)(),(0,n.iD)("div",Ce,(0,r.zw)(o.group.coordinators.map((e=>e.person.name)).join(", ")),1)):((0,n.wg)(),(0,n.iD)("div",Ue," None assigned "))])),_:1})])}var Se=o(7506),Ee={name:"GroupDetailHeader",props:{group:{type:Se.Z,required:!0}},emits:["showEdit"],computed:{showShortName(){return this.group.expert_panel.short_base_name!==this.group.expert_panel.long_base_name}}};const We=(0,X.Z)(Ee,[["render",xe]]);var qe=We,Fe=o(5812),Ae=o(7750),$e=o(7048),Ie=o(1158),je=o(1211);function Me(e,t,o,r,a,i){const s=(0,n.up)("document-list");return(0,n.wg)(),(0,n.iD)("div",null,[(0,n.Wm)(s,{documents:i.displayDocuments,documentUpdater:i.updateDocument,documentCreator:i.createDocument,documentDeleter:i.deleteDocument,canManage:i.canManageDocuments},null,8,["documents","documentUpdater","documentCreator","documentDeleter","canManage"])])}var Pe=o(9963);const Ve={class:"flex justify-between py-2"},Le={class:"flex space-x-2"},Ge=(0,n.Uk)(" Search: "),Te=(0,n.Uk)(" Type:   "),Re=(0,n._)("option",{value:null},"Any",-1),Ze=["value"],ze=["onClick"],Ne={class:"note"},He={key:0},Oe={key:1},Ye=(0,n._)("button",{class:"btn btn-xs"},"…",-1),Be=(0,n.Uk)("Download"),Ke=(0,n.Uk)("Update"),Je=(0,n.Uk)("Delete"),Qe={class:"px-4 pb-4 border"},Xe={key:0,class:"flex space-x-2 pt-2 border-t"},et=["onClick"],tt=["onClick"],ot=["onClick"],nt={key:0},rt={key:0,class:"mb-3"},at=(0,n._)("p",null,"Are you sure you want to continue?",-1);function it(e,t,o,a,i,s){const l=(0,n.up)("icon-cheveron-right"),u=(0,n.up)("icon-cheveron-down"),p=(0,n.up)("dropdown-item"),d=(0,n.up)("dropdown-menu"),c=(0,n.up)("object-dictionary"),m=(0,n.up)("data-table"),g=(0,n.up)("document-edit-form"),h=(0,n.up)("modal-dialog"),w=(0,n.up)("document-upload-form"),y=(0,n.up)("button-row");return(0,n.wg)(),(0,n.iD)("div",null,[(0,n.WI)(e.$slots,"heading",{},(()=>[(0,n._)("div",Ve,[(0,n._)("div",Le,[(0,n._)("label",null,[Ge,(0,n.wy)((0,n._)("input",{type:"text",placeholder:"Filter","onUpdate:modelValue":t[0]||(t[0]=e=>i.keyword=e),class:"sm"},null,512),[[Pe.nr,i.keyword]])]),(0,n._)("label",null,[Te,(0,n.wy)((0,n._)("select",{"onUpdate:modelValue":t[1]||(t[1]=e=>i.filterType=e)},[Re,((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)(i.documentTypes,(e=>((0,n.wg)(),(0,n.iD)("option",{key:e.id,value:e.id},(0,r.zw)(e.long_name),9,Ze)))),128))],512),[[Pe.bM,i.filterType]])])]),o.canManage?((0,n.wg)(),(0,n.iD)("button",{key:0,class:"btn btn-xs",onClick:t[2]||(t[2]=(...e)=>s.initUpload&&s.initUpload(...e))},"Upload")):(0,n.kq)("",!0)])])),(0,n.Wm)(m,{fields:i.fields,data:s.filteredDocuments,sort:i.sort,"onUpdate:sort":t[3]||(t[3]=e=>i.sort=e),detailRows:!0},{"cell-cheveron":(0,n.w5)((({item:e})=>[e.metadata?((0,n.wg)(),(0,n.iD)("button",{key:0,onClick:(0,Pe.iM)((t=>s.toggleItemDetails(e)),["stop"]),class:"w-9 align-center block -mx-3"},[e.showDetails?(0,n.kq)("",!0):((0,n.wg)(),(0,n.j4)(l,{key:0,class:"m-auto cursor-pointer"})),e.showDetails?((0,n.wg)(),(0,n.j4)(u,{key:1,class:"m-auto cursor-pointer"})):(0,n.kq)("",!0)],8,ze)):(0,n.kq)("",!0)])),"cell-filename":(0,n.w5)((({item:e})=>[(0,n.Uk)((0,r.zw)(e.filename)+" ",1),(0,n._)("span",Ne,[e.type.is_versioned&&e.version?((0,n.wg)(),(0,n.iD)("em",He,"(version "+(0,r.zw)(e.version)+")",1)):(0,n.kq)("",!0),e.is_final?((0,n.wg)(),(0,n.iD)("em",Oe," FINAL")):(0,n.kq)("",!0)])])),"cell-actions":(0,n.w5)((({item:e})=>[(0,n.Wm)(d,{hideCheveron:""},{label:(0,n.w5)((()=>[Ye])),default:(0,n.w5)((()=>[(0,n.Wm)(p,{onClick:t=>s.initDownload(e)},{default:(0,n.w5)((()=>[Be])),_:2},1032,["onClick"]),o.canManage?((0,n.wg)(),(0,n.j4)(p,{key:0,onClick:t=>s.initUpdate(e)},{default:(0,n.w5)((()=>[Ke])),_:2},1032,["onClick"])):(0,n.kq)("",!0),o.canManage?((0,n.wg)(),(0,n.j4)(p,{key:1,onClick:t=>s.initDelete(e)},{default:(0,n.w5)((()=>[Je])),_:2},1032,["onClick"])):(0,n.kq)("",!0)])),_:2},1024)])),detail:(0,n.w5)((({item:e})=>[(0,n._)("div",Qe,[(0,n.Wm)(c,{obj:e.metadata},null,8,["obj"]),o.canManage?((0,n.wg)(),(0,n.iD)("div",Xe,[(0,n._)("button",{class:"btn btn-xs",onClick:t=>s.initDownload(e)},"Download",8,et),(0,n._)("button",{class:"btn btn-xs",onClick:t=>s.initUpdate(e)},"Update",8,tt),(0,n._)("button",{class:"btn btn-xs red",onClick:t=>s.initDelete(e)},"Delete",8,ot)])):(0,n.kq)("",!0)])])),_:1},8,["fields","data","sort"]),((0,n.wg)(),(0,n.j4)(n.lR,{to:"body"},[(0,n.Wm)(h,{modelValue:i.showEditForm,"onUpdate:modelValue":t[5]||(t[5]=e=>i.showEditForm=e),title:`Update ${i.activeDocument.filename}`},{default:(0,n.w5)((()=>[(0,n.Wm)(g,{document:i.activeDocument,"save-function":this.commitUpdate,onSaved:t[4]||(t[4]=t=>e.$emit("updated"))},null,8,["document","save-function"])])),_:1},8,["modelValue","title"]),(0,n.Wm)(h,{modelValue:i.showUploadForm,"onUpdate:modelValue":t[7]||(t[7]=e=>i.showUploadForm=e),title:"Upload a new document"},{default:(0,n.w5)((()=>[(0,n.Wm)(w,{"save-function":this.commitCreate,onSaved:t[6]||(t[6]=t=>e.$emit("updated"))},null,8,["save-function"])])),_:1},8,["modelValue"]),(0,n.Wm)(h,{modelValue:i.showDeleteConfirmation,"onUpdate:modelValue":t[8]||(t[8]=e=>i.showDeleteConfirmation=e),title:`You are about to delete ${i.activeDocument.filename}`},{default:(0,n.w5)((()=>[i.activeDocument?((0,n.wg)(),(0,n.iD)("div",nt,[i.activeDocument.is_final?((0,n.wg)(),(0,n.iD)("p",rt," This version has been tagged as the final version of the document. ")):(0,n.kq)("",!0),at,(0,n.Wm)(y,{"submit-text":"Delete Document",onCanceled:s.cancelDelete,onSubmitted:s.commitDelete},null,8,["onCanceled","onSubmitted"])])):(0,n.kq)("",!0)])),_:1},8,["modelValue","title"])]))])}var st=o(9028);const lt={type:"file",ref:"fileInput"},ut=(0,n._)("option",{value:null},"Select...",-1),pt=["value"];function dt(e,t,o,a,i,s){const l=(0,n.up)("input-row"),u=(0,n.up)("button-row"),p=(0,n.up)("form-container");return(0,n.wg)(),(0,n.j4)(p,null,{default:(0,n.w5)((()=>[(0,n.Wm)(l,{label:"Document",errors:i.errors.file},{default:(0,n.w5)((()=>[(0,n._)("input",lt,null,512)])),_:1},8,["errors"]),(0,n.Wm)(l,{label:"Type",errors:i.errors.document_type_id},{default:(0,n.w5)((()=>[(0,n.wy)((0,n._)("select",{"onUpdate:modelValue":t[0]||(t[0]=e=>i.newDocument.document_type_id=e)},[ut,((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)(e.documentTypes,(e=>((0,n.wg)(),(0,n.iD)("option",{value:e.id,key:e.id},(0,r.zw)(e.long_name),9,pt)))),128))],512),[[Pe.bM,i.newDocument.document_type_id]])])),_:1},8,["errors"]),(0,n.Wm)(l,{errors:i.errors.notes,label:"Notes"},{default:(0,n.w5)((()=>[(0,n.wy)((0,n._)("textarea",{name:"notes","onUpdate:modelValue":t[1]||(t[1]=e=>i.newDocument.notes=e),cols:"30",rows:"10"},null,512),[[Pe.nr,i.newDocument.notes]])])),_:1},8,["errors"]),(0,n.Wm)(u,null,{default:(0,n.w5)((()=>[(0,n._)("button",{class:"btn white",onClick:t[2]||(t[2]=(...e)=>s.cancel&&s.cancel(...e))},"Cancel"),(0,n._)("button",{class:"btn blue",onClick:t[3]||(t[3]=(...e)=>s.save&&s.save(...e))},"Save")])),_:1})])),_:1})}var ct={props:{saveFunction:{type:Function,required:!0}},data(){return{newDocument:{file:null,document_type_id:this.documentTypeId,notes:null},errors:{}}},computed:{...(0,j.rn)({documentTypes:e=>e.doctypes.items}),group(){return this.$store.getters["groups/currentItemOrNew"]},application(){return this.group.expert_panel},isReviewed(){return Boolean(this.newDocument.date_reviewed)},documentType(){return 0==this.documentTypes.length?{}:this.$store.getters["doctypes/getItemById"](this.documentTypeId)}},methods:{async save(){try{let e=new FormData;Object.keys(this.newDocument).forEach((t=>{const o=this.newDocument[t];null!=o&&e.append(t,o)})),e.append("file",this.$refs.fileInput.files[0]),await this.saveFunction(e),this.clearForm(),this.$emit("saved")}catch(e){if((0,st.z1)(e))return void(this.errors=e.response.data.errors)}},cancel(){this.clearForm(),this.$emit("canceled")},clearForm(){this.initNewDocument(),this.clearErrors()},initNewDocument(){this.$refs.fileInput.value=null,this.newDocument={file:null,document_type_id:this.documentTypeId,notes:null}},clearErrors(){this.errors={}}},mounted(){this.$store.dispatch("doctypes/getItems")}};const mt=(0,X.Z)(ct,[["render",dt]]);var gt=mt;const ht=["value"];function wt(e,t,o,a,i,s){const l=(0,n.up)("dictionary-row"),u=(0,n.up)("input-row"),p=(0,n.up)("button-row"),d=(0,n.up)("form-container");return(0,n.wg)(),(0,n.j4)(d,null,{default:(0,n.w5)((()=>[(0,n.Wm)(l,{label:"File"},{default:(0,n.w5)((()=>[(0,n.Uk)((0,r.zw)(o.document.filename),1)])),_:1}),(0,n.Wm)(u,{label:"Type",errors:i.errors.document_type_id},{default:(0,n.w5)((()=>[(0,n.wy)((0,n._)("select",{"onUpdate:modelValue":t[0]||(t[0]=e=>i.docProxy.document_type_id=e)},[((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)(e.documentTypes,(e=>((0,n.wg)(),(0,n.iD)("option",{value:e.id,key:e.id},(0,r.zw)(e.long_name),9,ht)))),128))],512),[[Pe.bM,i.docProxy.document_type_id]])])),_:1},8,["errors"]),(0,n.Wm)(u,{errors:i.errors.notes,label:"Notes"},{default:(0,n.w5)((()=>[(0,n.wy)((0,n._)("textarea",{name:"notes","onUpdate:modelValue":t[1]||(t[1]=e=>i.docProxy.notes=e),cols:"30",rows:"10"},null,512),[[Pe.nr,i.docProxy.notes]])])),_:1},8,["errors"]),(0,n.Wm)(p,null,{default:(0,n.w5)((()=>[(0,n._)("button",{class:"btn",onClick:t[2]||(t[2]=(...e)=>s.cancel&&s.cancel(...e))},"Cancel"),(0,n._)("button",{class:"btn blue",onClick:t[3]||(t[3]=(...e)=>s.save&&s.save(...e))},"Save")])),_:1})])),_:1})}var yt={name:"DocumentEditForm",props:{document:{required:!0,type:Object},saveFunction:{required:!0,type:Function}},emits:["saved"],data(){return{docProxy:{},errors:{}}},computed:{...(0,j.rn)({documentTypes:e=>e.doctypes.items})},watch:{document:{immediate:!0,handler(){this.docProxy=JSON.parse(JSON.stringify(this.document))}}},methods:{cancel(){this.docProxy={},this.$emit("canceled")},async save(){try{this.saveFunction(this.docProxy),this.$emit("saved")}catch(e){throw(0,st.z1)(e)&&(this.errors=e.response.data.errors),e}}},mounted(){this.$store.dispatch("doctypes/getItems")}};const bt=(0,X.Z)(yt,[["render",wt]]);var ft=bt,vt={name:"DocumentList",components:{DocumentUploadForm:gt,DocumentEditForm:ft},emits:["updated"],props:{documents:{type:Array,required:!0},documentCreator:{type:Function,required:!1},documentUpdater:{type:Function,required:!1},documentDeleter:{type:Function,required:!1},canManage:{type:Boolean,default:!1}},data(){return{fields:[{name:"cheveron",label:"",sortable:!1},{name:"filename",label:"File",type:String,sortable:!0},{name:"type.long_name",label:"Type",type:String,sortable:!0},{name:"notes",type:String,sortable:!0},{name:"actions",label:"",type:String,sortable:!1}],sort:{field:"filename",desc:!1},keyword:null,filterType:null,documentTypes:[],activeDocument:{type:{}},showDeleteConfirmation:!1,showEditForm:!1,showUploadForm:!1}},computed:{filteredDocuments(){let e=[...this.documents];if(this.keyword){const t=new RegExp(".*"+this.keyword+".*","i");e=e.filter((e=>e.filename.match(t)||e.notes&&e.notes.match(t)||e.type.name.match(t)))}return this.filterType&&(e=e.filter((e=>e.document_type_id==this.filterType))),e}},methods:{toggleItemDetails(e){e.showDetails=!e.showDetails},initDownload(e){window.location=e.download_url},initUpdate(e){this.showEditForm=!0,this.activeDocument=e},commitUpdate(e){this.documentUpdater?this.documentUpdater(e):alert("we need a default document upload function"),this.$emit("updated"),this.showUploadForm=!1},initDelete(e){this.activeDocument=e,this.showDeleteConfirmation=!0},cancelDelete(){this.showDeleteConfirmation=!1,this.resetActiveDocument()},async commitDelete(){this.documentDeleter?this.documentDeleter(this.activeDocument):alert("we need to add a default document deleter."),this.showDeleteConfirmation=!1,this.resetActiveDocument(),this.$emit("updated")},initUpload(){this.showUploadForm=!0},commitCreate(e){this.documentCreator?this.documentCreator(e):alert("we need a default document upload function"),this.$emit("updated"),this.showUploadForm=!1},resetActiveDocument(){this.activeDocument={type:{}}}},mounted(){st.hi.get("/api/document-types").then((e=>this.documentTypes=e.data))}};const _t=(0,X.Z)(vt,[["render",it]]);var Dt=_t,kt={name:"GroupDocuments",components:{DocumentList:Dt},props:{},data(){return{}},computed:{group:{get(){return this.$store.getters["groups/currentItemOrNew"]}},displayDocuments(){return this.group.documents},canManageDocuments(){return this.hasAnyPermission(["groups-manage","ep-applications-manage",["info-edit",this.group]])}},methods:{async updateDocument(e){this.canManageDocuments?await this.$store.dispatch("groups/updateDocument",{group:this.group,document:e}):this.$store.pushError("Permission denied")},async createDocument(e){this.canManageDocuments?await this.$store.dispatch("groups/addDocument",{group:this.group,data:e}):this.$store.pushError("Permission denied")},async deleteDocument(e){this.canManageDocuments?await this.$store.dispatch("groups/deleteDocument",{group:this.group,document:e}):this.$store.pushError("Permission denied")}}};const Ct=(0,X.Z)(kt,[["render",Me]]);var Ut=Ct,xt=o(6412),St=o(4882),Et=o(7954),Wt=o(4344);const qt=e=>((0,n.dD)("data-v-f6a38f6c"),e=e(),(0,n.Cn)(),e),Ft={class:"flex justify-between"},At=qt((()=>(0,n._)("h2",{class:"mb-4"},"Subgroups",-1))),$t={class:"btn btn-icon"},It=(0,n.Uk)("Downloads:"),jt=["href"],Mt=(0,n.Uk)(" (CSV)"),Pt={class:"text-xs"};function Vt(e,t,o,a,i,s){const l=(0,n.up)("icon-download"),u=(0,n.up)("dropdown-item"),p=(0,n.up)("note"),d=(0,n.up)("dropdown-menu"),c=(0,n.up)("dictionary-row"),m=(0,n.up)("router-link"),g=(0,n.up)("popover");return(0,n.wg)(),(0,n.iD)("div",null,[(0,n._)("div",Ft,[At,(0,n.Wm)(d,{"hide-cheveron":"",orientation:"right"},{label:(0,n.w5)((()=>[(0,n._)("button",$t,[(0,n.Wm)(l,{width:"16",height:"16"})])])),default:(0,n.w5)((()=>[(0,n.Wm)(u,{class:"text-right font-bold"},{default:(0,n.w5)((()=>[It])),_:1}),s.showMemberReportButton?((0,n.wg)(),(0,n.j4)(u,{key:0,class:"text-right"},{default:(0,n.w5)((()=>[(0,n._)("a",{href:s.exportUrl},"Member Export",8,jt),(0,n.Wm)(p,{class:"inline"},{default:(0,n.w5)((()=>[Mt])),_:1})])),_:1})):(0,n.kq)("",!0)])),_:1})]),(0,n._)("ul",null,[((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)(s.group.children,(e=>((0,n.wg)(),(0,n.iD)("li",{class:"child-group",key:e.id},[(0,n.Wm)(g,{hover:"",arrow:"",placement:"left",class:"block w-full"},{content:(0,n.w5)((()=>[(0,n._)("div",Pt,[(0,n.Wm)(c,{label:"Status","label-class":"font-bold","label-width":"8em"},{default:(0,n.w5)((()=>[(0,n.Uk)((0,r.zw)(e.status.name),1)])),_:2},1024),e.chairs.length>0?((0,n.wg)(),(0,n.j4)(c,{key:0,label:"Chairs","label-class":"font-bold","label-width":"8em",class:"my-1"},{default:(0,n.w5)((()=>[(0,n.Uk)((0,r.zw)(e.coordinators.map((e=>e.person.name)).join(", ")),1)])),_:2},1024)):(0,n.kq)("",!0),e.coordinators.length>0?((0,n.wg)(),(0,n.j4)(c,{key:1,label:"Coordinators","label-class":"font-bold","label-width":"8em"},{default:(0,n.w5)((()=>[(0,n.Uk)((0,r.zw)(e.coordinators.map((e=>e.person.name)).join(", ")),1)])),_:2},1024)):(0,n.kq)("",!0),(0,n.Wm)(c,{label:"# Members","label-width":"8em","label-class":"font-bold"},{default:(0,n.w5)((()=>[(0,n.Uk)((0,r.zw)(e.members_count),1)])),_:2},1024)])])),default:(0,n.w5)((()=>[(0,n.Wm)(m,{to:{name:"GroupDetail",params:{uuid:e.uuid}},class:"block w-full"},{default:(0,n.w5)((()=>[(0,n.Uk)((0,r.zw)(e.name),1)])),_:2},1032,["to"])])),_:2},1024)])))),128))])])}var Lt={name:"SubgroupList",props:{},data(){return{}},computed:{group(){return this.$store.getters["groups/currentItemOrNew"]},showMemberReportButton(){return this.hasAnyPermission([["members-invite",this.group],"groups-manage","ep-applications-manage","annual-updates-manage"])},exportUrl(){return`/api/report/groups/${this.group.uuid}/subgroup-member-export`}}};const Gt=(0,X.Z)(Lt,[["render",Vt],["__scopeId","data-v-f6a38f6c"]]);var Tt=Gt,Rt={name:"GroupDetail",components:{ActivityLog:V.Z,ApplicationSummary:te,AttestationGcep:oe.Z,AttestationNhgri:ne.Z,AttestationReanalysis:re.Z,SpecificationsSection:ae.Z,GroupDocuments:Ut,GroupForm:ue.Z,GroupDetailHeader:qe,EvidenceSummaries:ie.Z,GcepGeneList:se.Z,GcepOngoingPlansForm:le.Z,MemberList:Fe.Z,MembershipDescriptionForm:Ae.Z,ScopeDescriptionForm:$e.Z,VcepGeneList:Ie.Z,VcepOngoingPlansForm:je.Z,AnnualUpdateAlert:xt.Z,StepTabs:St.Z,ProgressChart:Et.Z,SustainedCurationReviewAlert:Wt["default"],SubgroupList:Tt},props:{uuid:{type:String,required:!0}},data(){return{showInfoEdit:!1,editingExpertise:!1,editingScopeDescription:!1,editingGenes:!1,showConfirmDelete:!1,ongoingPlansErrors:{},errors:{}}},computed:{showCreateAnnualUpdateButton(){return this.hasPermission("annual-updates-manage")&&this.group.expert_panel&&!this.group.expert_panel.annualUpdate}},setup(e){const t=(0,j.oR)(),o=(0,I.iH)(!1),r=(0,n.Fl)({get:function(){return t.getters["groups/currentItemOrNew"]},set:function(e){t.commit("groups/addItem",e)}}),a=(0,n.Fl)((()=>r.value.is_ep?r.value.is_vcep_or_scvcep?Ie.Z:se.Z:null)),i=(0,n.Fl)((()=>r.value.is_vcep_or_scvcep?je.Z:le.Z)),s=async()=>{await(0,M.pE)(`/api/groups/${e.uuid}/activity-logs`)},l=()=>{t.dispatch("groups/find",e.uuid).then((()=>{t.commit("groups/setCurrentItemIndexByUuid",e.uuid),t.dispatch("groups/getChildren",r.value),r.value.is_ep&&(t.dispatch("groups/getGenes",r.value),t.dispatch("groups/getDocuments",r.value),r.value.is_vcep_or_scvcep&&t.dispatch("groups/getEvidenceSummaries",r.value),t.dispatch("groups/getPendingTasks",r.value),t.dispatch("groups/getAnnualUpdate",r.value))}))},u=(0,n.Fl)((()=>r.value.pendingTasks&&r.value.pendingTasks.filter((e=>1===e.task_type_id)).length>0));return(0,n.YP)((()=>e.uuid),(()=>l()),{immediate:!0}),(0,n.bv)((async()=>{})),{group:r,groupGeneList:a,showModal:o,ongoingPlansFormComponent:i,logEntries:M.Q3,needsToReviewSustainedCuration:u,getLogEntries:s,getGroup:l}},watch:{$route(){this.showModal=!!this.$route.meta.showModal&&Boolean(this.$route.meta.showModal)}},methods:{hideModal(){this.$router.replace({name:"GroupDetail",params:{uuid:this.uuid}})},handleModalClosed(e){this.clearModalForm(e),this.$router.push({name:"GroupDetail",params:{uuid:this.uuid}})},clearModalForm(){"function"===typeof this.$refs.modalView.clearForm&&this.$refs.modalView.clearForm()},showEdit(){this.showInfoEdit=!0},cancelForm(e){this[e]=!1,this.errors={},this.revertGroupChanges()},async submitForm(e,t){try{await this[e].apply(this.group),this[t]=!1}catch(o){if((0,st.z1)(o))return void(this.errors=o.response.data.errors);throw o}},saveMembershipDescription(){return this.$store.dispatch("groups/membershipDescriptionUpdate",{uuid:this.group.uuid,membershipDescription:this.group.expert_panel.membership_description}).then((()=>{this.$store.commit("pushSuccess","Description of expertise updated.")}))},saveScopeDescription(){return this.$store.dispatch("groups/scopeDescriptionUpdate",{uuid:this.group.uuid,scopeDescription:this.group.expert_panel.scope_description}).then((e=>(this.$store.commit("pushSuccess","Description of scope updated."),e)))},saveOngoingPlansForm(){const{uuid:e,expert_panel:t}=this.group;return this.$store.dispatch("groups/curationReviewProtocolUpdate",{uuid:e,expertPanel:t}).then((()=>{this.$store.commit("pushSuccess","Curation review protocol updated.")}))},revertGroupChanges(){return this.errors={},this.$store.dispatch("groups/find",this.group.uuid).then((()=>{this.$store.commit("pushInfo","Update canceled.")}))},handleTabChange(e){"Log"==e&&(0,P.Fs)("groups-manage")&&this.getLogEntries()},initDelete(){this.showConfirmDelete=!0},deleteGroup(){this.$store.dispatch("groups/delete",this.group.uuid),this.$store.commit("pushSuccess","Group deleted."),this.$router.push({name:"GroupList"})},async fakeCspecPilotApproved(){try{await st.hi.post(`/api/groups/${this.uuid}/dev/fake-pilot-approved`),this.$store.dispatch("groups/getPendingTasks",this.group)}catch(e){418==e.response.status&&this.$store.commit("pushError",e.response.data)}},createAnnualUpdateForLatestWindow(){this.$store.dispatch("groups/createAnnualUpdateForLatestWindow",this.group)}},mounted(){this.showModal=Boolean(this.$route.meta.showModal),this.showConfirmDelete=!1},beforeUnmount(){this.$store.commit("groups/clearCurrentItem")}};const Zt=(0,X.Z)(Rt,[["render",$]]);var zt=Zt}}]);
//# sourceMappingURL=group-detail.8b96d7b0.js.map