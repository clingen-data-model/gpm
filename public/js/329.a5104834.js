"use strict";(self["webpackChunkepam"]=self["webpackChunkepam"]||[]).push([[329,715],{9272:function(e,t,a){a.d(t,{Q3:function(){return i},ld:function(){return u},pE:function(){return p},pO:function(){return d},q1:function(){return l}});var o=a(2262),r=a(6252),n=a(812);const s=(0,o.iH)([]),i=(0,r.Fl)((()=>s.value)),p=async e=>{s.value=await n.Z.get(e).then((e=>e.data.data))},l=async(e,t)=>await n.Z.post(e,t).then((e=>(s.value.push(e.data),e.data))),u=async(e,t)=>await n.Z.put(e,t).then((e=>{const t=s.value.findIndex((t=>t.id==e.data.id));return s.value[t]=e.data,e.data})),d=async(e,t)=>await n.Z["delete"](`${e}/${t}`).then((e=>{const a=s.value.findIndex((e=>e.id==t));return s.value.splice(a,1),e}))},289:function(e,t,a){a.d(t,{i:function(){return r}});const o={approve:"green","approve-after-revisions":"blue","request-revisions":"yellow"},r=e=>e.decision?o[e.decision]:"gray"},3774:function(e,t,a){a.d(t,{R0:function(){return s}});var o=a(2262),r=a(9700),n=a(812);const s=(0,o.iH)({}),i=(0,o.iH)(!1),p=()=>{i.value=!1,s.value={}},l=async({method:e,url:t,data:a})=>{try{return await(0,n.Z)({method:e,url:t,data:a}).then((e=>e.data.data))}catch(o){(0,r.Z)(o)&&(s.value={...s,...o.response.data.errors})}},u=()=>{s.value={}};t["ZP"]=()=>({errors:s,editing:i,hideForm:p,submitFormData:l,resetErrors:u})},3170:function(e,t,a){a.d(t,{Z:function(){return v}});var o=a(6252),r=a(3577);const n={key:0,class:"px-3 py-2 rounded border border-gray-300 text-gray-500 bg-gray-200"},s={class:"flex space-x-1"},i=["innerHTML"];function p(e,t,a,p,l,u){const d=(0,o.up)("icon-edit"),c=(0,o.up)("router-link"),m=(0,o.up)("icon-trash"),h=(0,o.up)("data-table"),g=(0,o.up)("log-entry-form"),v=(0,o.up)("modal-dialog");return(0,o.wg)(),(0,o.iD)("div",null,[u.hasLogEntries?((0,o.wg)(),(0,o.j4)(h,{key:1,fields:u.fields,data:u.filteredLogEntries,sort:l.sort,"onUpdate:sort":t[0]||(t[0]=e=>l.sort=e)},{"cell-id":(0,o.w5)((({item:e})=>[(0,o._)("div",s,[(0,o.Wm)(c,{to:{name:"EditLogEntry",params:{id:e.id}},class:"btn btn-xs inline-block"},{default:(0,o.w5)((()=>[(0,o.Wm)(d,{width:"12"})])),_:2},1032,["to"]),null===e.activity_type?((0,o.wg)(),(0,o.j4)(c,{key:0,to:{name:"ConfirmDeleteLogEntry",params:{id:e.id}},class:"btn btn-xs inline-block"},{default:(0,o.w5)((()=>[(0,o.Wm)(m,{width:"12"})])),_:2},1032,["to"])):(0,o.kq)("",!0)])])),"cell-description":(0,o.w5)((({item:e})=>[(0,o._)("div",{innerHTML:e.description,class:"links-blue"},null,8,i)])),_:1},8,["fields","data","sort"])):((0,o.wg)(),(0,o.iD)("div",n,(0,r.zw)(u.noResultsMessage),1)),(0,o.Wm)(v,{modelValue:l.editingEntry,"onUpdate:modelValue":t[1]||(t[1]=e=>l.editingEntry=e),title:"Edit log entry"},{default:(0,o.w5)((()=>[(0,o.Wm)(g)])),_:1},8,["modelValue"])])}a(6699);var l=a(3907),u=a(8887),d=a(9272);const c=[{name:"created_at",label:"Created",sortName:"created_at",sortable:!0,type:Date},{name:"description",label:"Entry",sortable:!0,type:String},{name:"causer.name",label:"User",sortable:!0},{name:"id",label:"",sortable:!1}];var m={components:{LogEntryForm:u["default"]},props:{step:{required:!1,type:Number}},data(){return{sort:{field:"created_at",desc:!0},selectedLogEntry:{},editingEntry:!1}},computed:{fields(){return 4!=this.group.group_type_id||c.map((e=>e.name)).includes("step")||c.splice(2,0,{name:"step",sortable:!0}),c},hasLogEntries(){return this.filteredLogEntries.length>0},filteredLogEntries(){return this.logEntries&&this.step?this.logEntries.filter((e=>e.step==this.step)):this.logEntries?this.logEntries:[]},noResultsMessage(){return"number"==typeof this.step?`No progress log entries have been entered for step ${this.step}`:"There are no log entries for this application"}},methods:{async getLogEntries(){},editLogEntry(e){this.editingEntry=!0,this.selectedLogEntry=e}},mounted(){},setup(){const e=(0,l.oR)(),t=(0,o.Fl)((()=>e.getters["groups/currentItemOrNew"])),a=(0,o.Fl)((()=>t.value.expert_panel));return(0,o.YP)(t,(()=>{t.value.uuid&&(0,d.pE)(`/api/groups/${t.value.uuid}/activity-logs`)}),{immediate:!0}),{group:t,application:a,logEntries:d.Q3}}},h=a(3744);const g=(0,h.Z)(m,[["render",p]]);var v=g},2156:function(e,t,a){a.d(t,{Z:function(){return _}});var o=a(6252),r=a(2262),n=a(3577),s=a(417);const i={class:"comment-container"},p={class:"flex items-start space-x-2"},l={class:"replies ml-1"},u={key:0,class:""};var d={__name:"ReviewCommentAnonymous",props:{comment:{type:Object,required:!0}},setup(e){const t=e,a=(0,r.iH)((0,s.Z)("App\\Models\\Comment",t.comment.id)),d=e=>{switch(e.type.name){case"required revision":return"yellow";case"suggestion":return"blue";case"internal comment":return"gray";default:break}},c=(0,r.iH)(!1),m=async()=>{c.value||await a.value.getComments(),c.value=!c.value};return(t,r)=>{const s=(0,o.up)("badge"),h=(0,o.up)("popper"),g=(0,o.up)("markdown-block"),v=(0,o.up)("ReviewCommentAnonymous",!0);return(0,o.wg)(),(0,o.iD)("div",null,[(0,o._)("div",i,[(0,o._)("div",p,[(0,o.Wm)(h,{content:t.titleCase(e.comment.type.name),hover:"",arrow:"",placement:"left"},{default:(0,o.w5)((()=>[(0,o.Wm)(s,{class:"block",color:d(e.comment),size:"xxs"},{default:(0,o.w5)((()=>[(0,o.Uk)((0,n.zw)(t.titleCase(e.comment.type.name.substr(0,1))),1)])),_:1},8,["color"])])),_:1},8,["content"]),(0,o._)("div",null,[(0,o.Wm)(g,{markdown:e.comment.content,class:"text-sm"},null,8,["markdown"]),(0,o._)("div",l,[c.value?((0,o.wg)(),(0,o.iD)("ul",u,[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(a.value.comments,(e=>((0,o.wg)(),(0,o.iD)("li",{key:e.id,class:"border-l-2 mt-2 px-2 py-1"},[(0,o.Wm)(v,{comment:e,commentManager:a.value,onDeleted:t.handleReplyRemoved},null,8,["comment","commentManager","onDeleted"])])))),128))])):(0,o.kq)("",!0),e.comment.comments_count>0?((0,o.wg)(),(0,o.iD)("button",{key:1,class:"link text-sm",onClick:m},(0,n.zw)(c.value?"Hide":"Show")+" "+(0,n.zw)(e.comment.comments_count)+" "+(0,n.zw)(e.comment.comments_count>1?"replies":"reply"),1)):(0,o.kq)("",!0)])])])])])}}};const c=d;var m=c;const h={class:"md:w-1/5 flex-shrink-0"},g={key:0};var v={__name:"CommentSummary",props:{comments:{type:Array,required:!0}},setup(e){const t=e,a=(0,o.Fl)((()=>{const e={};return t.comments.forEach((t=>{const a=t.metadata.section||"general";e[t.metadata.section]||(e[a]=[]),e[a].push(t)})),e}));return(t,s)=>((0,o.wg)(),(0,o.iD)("div",null,[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)((0,r.SU)(a),((e,a)=>((0,o.wg)(),(0,o.iD)("div",{key:a,class:"md:flex md:space-x-4 mt-3 ml-2"},[(0,o._)("h4",h,(0,n.zw)(t.titleCase(a)),1),((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(e,(e=>((0,o.wg)(),(0,o.j4)(m,{key:e.id,comment:e,class:"mb-1 flex-grow-0"},null,8,["comment"])))),128))])))),128)),0==e.comments.length?((0,o.wg)(),(0,o.iD)("div",g," No comments ")):(0,o.kq)("",!0)]))}};const f=v;var _=f},7954:function(e,t,a){a.d(t,{Z:function(){return y}});var o=a(6252);const r=e=>((0,o.dD)("data-v-52f06f94"),e=e(),(0,o.Cn)(),e),n=r((()=>(0,o._)("h3",{class:"pb-2"},"EP Progress",-1))),s={class:"flex flex-row space-x-1"};function i(e,t,a,r,i,p){const l=(0,o.up)("progress-step");return(0,o.wg)(),(0,o.iD)("div",null,[n,(0,o._)("div",s,[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(p.steps,(e=>((0,o.wg)(),(0,o.j4)(l,{key:e,step:e,application:a.application},null,8,["step","application"])))),128))])])}var p=a(3577);const l={class:"flex-1"},u={class:"flex flex-row-reverse justify-between bg-transparent mt-1"},d={key:0};function c(e,t,a,r,n,s){return(0,o.wg)(),(0,o.iD)("div",l,[(0,o._)("div",{class:(0,p.C_)(["progress-step",s.displayClass])},null,2),(0,o._)("div",u,[(0,o._)("div",{class:(0,p.C_)({"-mr-10":!s.isLastStep})},(0,p.zw)(s.approvalDate),3),s.isFirstStep?((0,o.wg)(),(0,o.iD)("div",d,(0,p.zw)(s.dateInitiated),1)):(0,o.kq)("",!0)])])}var m=a(5699),h={props:{step:{type:Number,required:!0},application:{type:Object,required:!0}},data(){return{}},computed:{dateInitiated(){return(0,m.p6)(this.application.date_initiated)},approvalDate(){return this.application.approvalDateForStep(this.step)?(0,m.p6)(this.application.approvalDateForStep(this.step)):" "},displayClass(){const e=[];return this.isApproved?e.push("approved"):this.isCurrentStep&&e.push("active"),this.isFirstStep&&e.push("rounded-l"),this.isLastStep&&e.push("rounded-r"),e.join(" ")},isCurrentStep(){return this.application.current_step==this.step},isApproved(){return this.application.stepIsApproved(this.step)},isFirstStep(){return 1==this.step},isLastStep(){const e=Math.max.apply(Math,this.application.steps);return this.step==e}},methods:{}},g=a(3744);const v=(0,g.Z)(h,[["render",c]]);var f=v,_={components:{ProgressStep:f},props:{application:{required:!0,type:Object}},computed:{steps(){return this.application.steps}}};const w=(0,g.Z)(_,[["render",i],["__scopeId","data-v-52f06f94"]]);var y=w},4882:function(e,t,a){a.d(t,{Z:function(){return gt}});var o=a(6252);const r={key:0};function n(e,t,a,n,s,i){const p=(0,o.up)("step-one"),l=(0,o.up)("tab-item"),u=(0,o.up)("step-two"),d=(0,o.up)("step-three"),c=(0,o.up)("step-four"),m=(0,o.up)("tabs-container");return(0,o.wg)(),(0,o.iD)("div",null,[i.application.is_gcep?((0,o.wg)(),(0,o.iD)("div",r,[(0,o.Wm)(p,{onStepApproved:i.handleApproved,onUpdated:i.handleUpdated},null,8,["onStepApproved","onUpdated"])])):(0,o.kq)("",!0),2==this.application.expert_panel_type_id?((0,o.wg)(),(0,o.j4)(m,{key:1,"tab-location":"right",modelValue:i.activeIndex,"onUpdate:modelValue":t[0]||(t[0]=e=>i.activeIndex=e)},{default:(0,o.w5)((()=>[(0,o.Wm)(l,{label:"Group Definition"},{default:(0,o.w5)((()=>[(0,o.Wm)(p,{onStepApproved:i.handleApproved,onUpdated:i.handleUpdated},null,8,["onStepApproved","onUpdated"])])),_:1}),(0,o.Wm)(l,{label:"Draft Specifications"},{default:(0,o.w5)((()=>[(0,o.Wm)(u,{onStepApproved:i.handleApproved,onUpdated:i.handleUpdated},null,8,["onStepApproved","onUpdated"])])),_:1}),(0,o.Wm)(l,{label:"Pilot Specfications"},{default:(0,o.w5)((()=>[(0,o.Wm)(d,{onStepApproved:i.handleApproved,onUpdated:i.handleUpdated},null,8,["onStepApproved","onUpdated"])])),_:1}),(0,o.Wm)(l,{label:"Sustained Curation"},{default:(0,o.w5)((()=>[(0,o.Wm)(c,{onStepApproved:i.handleApproved,onUpdated:i.handleUpdated},null,8,["onStepApproved","onUpdated"])])),_:1})])),_:1},8,["modelValue"])):(0,o.kq)("",!0)])}var s=a(3907);const i={class:"application-review"};function p(e,t,a,r,n,s){const p=(0,o.up)("definition-review"),l=(0,o.up)("base-step");return(0,o.wg)(),(0,o.iD)("div",i,[(0,o.Wm)(l,{step:1,"document-name":"Scope and Membership Application",title:"Scope and Membership","document-type":1,"document-gets-reviewed":!0,"approve-button-label":"Approve Scope and Membership",onUpdated:t[0]||(t[0]=e=>this.$emit("updated"))},{sections:(0,o.w5)((()=>[(0,o.Wm)(p)])),_:1})])}var l=a(3577);const u={class:"overflow-x-auto"},d={class:"mb-6"},c={class:"flex justify-between text-lg font-bold pb-2 mb-2 border-b"},m={class:"flex space-x-2"},h={key:0},g={key:0,class:"flex space-x-1"},v={class:"text-white bg-green-600 rounded-xl px-2"},f={key:1,class:"flex space-x-1"},_={class:"screen-block-container"},w=(0,o.Uk)(" Step sections here! "),y={class:"mb-6 mt-4 border-t pt-4"},b={class:"mb-2"};function S(e,t,a,r,n,s){const i=(0,o.up)("step-controls"),p=(0,o.up)("edit-icon-button"),S=(0,o.up)("date-input"),k=(0,o.up)("remove-button"),U=(0,o.up)("application-log");return(0,o.wg)(),(0,o.iD)("div",u,[(0,o._)("div",d,[s.application.stepIsApproved(a.step)?(0,o.kq)("",!0):((0,o.wg)(),(0,o.j4)(i,{key:0,step:a.step,onUpdated:s.handleUpdated},null,8,["step","onUpdated"])),(0,o._)("div",c,[(0,o._)("div",m,[(0,o._)("h2",null,(0,l.zw)(a.title),1),s.dateApproved?((0,o.wg)(),(0,o.iD)("div",h,[n.editApprovalDate?((0,o.wg)(),(0,o.iD)("div",f,[(0,o.Wm)(S,{modelValue:n.newApprovalDate,"onUpdate:modelValue":t[0]||(t[0]=e=>n.newApprovalDate=e)},null,8,["modelValue"]),(0,o._)("button",{class:"btn blue",onClick:t[1]||(t[1]=(...e)=>s.updateApprovalDate&&s.updateApprovalDate(...e))},"Save"),(0,o.Wm)(k,{onClick:t[2]||(t[2]=e=>n.editApprovalDate=!1)})])):((0,o.wg)(),(0,o.iD)("div",g,[(0,o._)("div",v," Approved: "+(0,l.zw)(s.dateApproved),1),(0,o.Wm)(p,{class:"text-black",onClick:s.initEditApprovalDate},null,8,["onClick"])]))])):(0,o.kq)("",!0)]),(0,o._)("div",null,[(0,o._)("button",{class:"btn btn-xs",onClick:t[3]||(t[3]=(...e)=>s.goToPrintable&&s.goToPrintable(...e))},"Printable Application")])]),(0,o._)("div",_,[(0,o.WI)(e.$slots,"sections",{},(()=>[w]))])]),(0,o._)("div",null,[(0,o.WI)(e.$slots,"default")]),(0,o.WI)(e.$slots,"log",{},(()=>[(0,o._)("div",y,[(0,o._)("h3",b,"Step "+(0,l.zw)(a.step)+" Progress Log",1),(0,o.Wm)(U,{step:a.step},null,8,["step"])])]))])}var k=a(5699),U=a(3170),D=a(2262),x=a(289),C=a(8661),A=a(4332);const E=e=>((0,o.dD)("data-v-d4e65afc"),e=e(),(0,o.Cn)(),e),V={key:0},W={key:0},q=E((()=>(0,o._)("strong",null,"Submitted",-1))),$={key:1},F=E((()=>(0,o._)("strong",null,"Sent to chairs",-1))),T=(0,o.Uk)(" on "),j=(0,o.Uk)(". "),I={key:2},Z=(0,o.Uk)(" - Revisions Requested. "),P={key:3},N=E((()=>(0,o._)("hr",{class:"my-1"},null,-1))),R=E((()=>(0,o._)("strong",null,"Latest Chair Decisions:",-1))),O={key:0,class:"list-disc pl-6"},M=(0,o.Uk)("   "),L={key:0,class:"text-sm"},z=E((()=>(0,o._)("strong",null,"Notes:",-1))),G={key:1,class:"ml-4 text-gray-500"};var H={__name:"SubmissionInfo",props:{group:{type:Object,required:!0},step:{type:Number,required:!0}},setup(e){const t=e,a=(0,o.Fl)((()=>r.value&&r.value.length>0)),r=(0,o.Fl)((()=>t.group.expert_panel.submissionsForStep(t.step))),n=(0,o.Fl)((()=>t.group.expert_panel.latestPendingSubmissionForStep(t.step))),s=(0,o.Fl)((()=>r.value?1==r.value.length||3==n.value.submission_status_id||2==n.value.submission_status_id?n.value.judgements:r.value[r.value.length-2].judgements:[]));return(t,r)=>{const i=(0,o.up)("badge"),p=(0,o.up)("static-alert");return e.step==e.group.expert_panel.current_step?((0,o.wg)(),(0,o.iD)("div",V,[(0,D.SU)(a)?((0,o.wg)(),(0,o.j4)(p,{key:0,class:"mb-4 border-blue-700",variant:"bland"},{default:(0,o.w5)((()=>[(0,D.SU)(n).sent_to_chairs_at?(0,o.kq)("",!0):((0,o.wg)(),(0,o.iD)("div",W,[q,(0,o.Uk)(" by "+(0,l.zw)((0,D.SU)(n).submitter?(0,D.SU)(n).submitter.name:"")+" on ",1),(0,o._)("strong",null,(0,l.zw)((0,D.SU)(k.p6)((0,D.SU)(n).created_at)),1),(0,D.SU)(n).notes?((0,o.wg)(),(0,o.j4)(A["default"],{key:0,class:"ml-4",markdown:(0,D.SU)(n).notes},null,8,["markdown"])):(0,o.kq)("",!0)])),3==(0,D.SU)(n).submission_status_id?((0,o.wg)(),(0,o.iD)("div",$,[F,T,(0,o._)("strong",null,(0,l.zw)((0,D.SU)(k.p6)((0,D.SU)(n).sent_to_chairs_at)),1),j])):(0,o.kq)("",!0),2==(0,D.SU)(n).submission_status_id?((0,o.wg)(),(0,o.iD)("div",I,[(0,o._)("strong",null,(0,l.zw)((0,D.SU)(k.p6)((0,D.SU)(n).updated_at)),1),Z])):(0,o.kq)("",!0),(0,D.SU)(C.ft)("chair_review")&&3==(0,D.SU)(n).submission_status_id?((0,o.wg)(),(0,o.iD)("div",P,[N,R,(0,D.SU)(s)&&(0,D.SU)(s).length>0?((0,o.wg)(),(0,o.iD)("ul",O,[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)((0,D.SU)(s),(e=>((0,o.wg)(),(0,o.iD)("li",{key:e.id},[(0,o._)("strong",null,(0,l.zw)(e.person.name)+":",1),M,(0,o.Wm)(i,{color:(0,D.SU)(x.i)(e)},{default:(0,o.w5)((()=>[(0,o.Uk)((0,l.zw)(e.decision),1)])),_:2},1032,["color"]),e.notes?((0,o.wg)(),(0,o.iD)("div",L,[z,(0,o.Uk)(" "+(0,l.zw)(e.notes),1)])):(0,o.kq)("",!0)])))),128))])):((0,o.wg)(),(0,o.iD)("div",G," Awaiting decisions... "))])):(0,o.kq)("",!0)])),_:1})):(0,o.kq)("",!0)])):(0,o.kq)("",!0)}}},B=a(3744);const Y=(0,B.Z)(H,[["__scopeId","data-v-d4e65afc"]]);var K=Y,Q=a(9963);const J={class:"text-sm"},X=(0,o._)("div",null,"Send notification email to contacts",-1),ee=(0,o.Uk)(" The expert panel has not yet submitted the application for approval. "),te=(0,o._)("br",null,null,-1),ae=(0,o.Uk)(' You can approve this application but be aware that it is not part of the "normal" application workflow. '),oe={key:0};function re(e,t,a,r,n,s){const i=(0,o.up)("input-row"),p=(0,o.up)("dictionary-row"),u=(0,o.up)("static-alert"),d=(0,o.up)("user-defined-mail-form"),c=(0,o.up)("button-row"),m=(0,o.up)("form-container");return(0,o.wg)(),(0,o.j4)(m,null,{default:(0,o.w5)((()=>[(0,o._)("h2",null,"Approve Step "+(0,l.zw)(s.application.current_step),1),(0,o.Wm)(i,{modelValue:n.dateApproved,"onUpdate:modelValue":t[0]||(t[0]=e=>n.dateApproved=e),type:"date",errors:n.errors.date_approved,label:"Date Approved"},null,8,["modelValue","errors"]),(0,o.Wm)(p,{label:""},{default:(0,o.w5)((()=>[(0,o._)("div",null,[(0,o._)("label",J,[(0,o.wy)((0,o._)("input",{type:"checkbox","onUpdate:modelValue":t[1]||(t[1]=e=>n.notifyContacts=e),value:!0},null,512),[[Q.e8,n.notifyContacts]]),X])])])),_:1}),s.application.hasPendingSubmissionForCurrentStep?(0,o.kq)("",!0):((0,o.wg)(),(0,o.j4)(u,{key:0,variant:"warning"},{default:(0,o.w5)((()=>[ee,te,ae])),_:1})),(0,o.Wm)(Q.uT,{name:"slide-fade-down"},{default:(0,o.w5)((()=>[(0,o.wy)((0,o.Wm)(d,{modelValue:n.email,"onUpdate:modelValue":t[2]||(t[2]=e=>n.email=e)},null,8,["modelValue"]),[[Q.F8,n.notifyContacts]])])),_:1}),(0,o.Wm)(c,null,{default:(0,o.w5)((()=>[(0,o._)("button",{class:"btn",onClick:t[3]||(t[3]=(...e)=>s.cancel&&s.cancel(...e))},"Cancel"),(0,o._)("button",{class:"btn blue",onClick:t[4]||(t[4]=(...e)=>s.save&&s.save(...e))},[(0,o.Uk)(" Approve step "+(0,l.zw)(s.application.current_step)+" ",1),n.notifyContacts?((0,o.wg)(),(0,o.iD)("span",oe," and notify ")):(0,o.kq)("",!0)])])),_:1})])),_:1})}var ne=a(812),se=a(9700),ie=a(9334);const pe={1:"App\\Mail\\UserDefinedMailTemplates\\InitialApprovalMailTemplate",2:"App\\Mail\\UserDefinedMailTemplates\\SpecificationDraftMailTemplate",3:"App\\Mail\\UserDefinedMailTemplates\\SpecificationPilotMailTemplate",4:"App\\Mail\\UserDefinedMailTemplates\\SustainedCurationApprovalMailTemplate"};var le={components:{UserDefinedMailForm:ie["default"]},emits:["canceled","saved"],data(){return{dateApproved:null,notifyContacts:!1,email:{subject:"",body:"",cc:[],to:[],files:[]},errors:{}}},computed:{...(0,s.Se)({group:"groups/currentItemOrNew"}),application(){return this.group.expert_panel}},watch:{notifyContacts:function(e){e&&ne.Z.get(`/api/email-drafts/groups/${this.group.uuid}`,{params:{templateClass:pe[this.group.expert_panel.current_step]}}).then((e=>{this.email=e.data,this.email["files"]=[]}))}},methods:{clearForm(){this.dateApproved=null,this.notifyContacts=!1},cancel(){this.clearForm(),this.$emit("canceled")},async save(){const e={group:this.group,dateApproved:this.dateApproved,notifyContacts:this.notifyContacts,subject:this.email.subject,body:this.email.body,attachments:this.email.files};try{await this.$store.dispatch("groups/approveCurrentStep",e),this.clearForm(),this.$emit("saved")}catch(t){if((0,se.Z)(t))return void(this.errors=t.response.data.errors)}}},mounted(){}};const ue=(0,B.Z)(le,[["render",re]]);var de=ue;const ce=["disabled","title"];var me={__name:"StepApproveControl",props:{group:{type:Object,required:!0},step:{type:Number,required:!0}},emits:["stepApproved"],setup(e,{emit:t}){const a=e,r=(0,o.l1)(),n=(0,D.iH)(!1),s=(0,o.Fl)((()=>a.step==a.group.expert_panel.current_step)),i=(0,o.Fl)((()=>s.value?"Approve this step":"You can only approve the application's current step")),p=()=>{n.value=!0},l=()=>{u(),t("stepApproved")},u=()=>{n.value=!1};return(e,t)=>{const a=(0,o.up)("modal-dialog");return(0,o.wg)(),(0,o.iD)("div",null,[(0,o._)("button",(0,o.dG)({disabled:!(0,D.SU)(s),title:(0,D.SU)(i),class:"btn btn-lg w-full"},(0,D.SU)(r),{onClick:p}),[(0,o.WI)(e.$slots,"default")],16,ce),((0,o.wg)(),(0,o.j4)(o.lR,{to:"body"},[(0,o.Wm)(a,{modelValue:n.value,"onUpdate:modelValue":t[0]||(t[0]=e=>n.value=e),size:"xl",onClosed:t[1]||(t[1]=t=>e.$refs.approvestepform.clearForm())},{default:(0,o.w5)((()=>[(0,o.Wm)(de,{ref:"approvestepform",onSaved:l,onCanceled:u},null,512)])),_:1},8,["modelValue"])]))])}}};const he=me;var ge=he,ve=a(2156),fe=a(9028);const _e=(0,o._)("p",null,[(0,o.Uk)(" Sending the application to the chairs for approval will send a message to the "),(0,o._)("em",null,"cdwgoc_approvals"),(0,o.Uk)(" with a PDF of the application and the Core Group comments shown below. ")],-1),we=(0,o._)("h3",null,"Comments from the Core Group",-1),ye=(0,o.Uk)("This is not intended for additional comments about the applicaiton. This is intended for notes about process, timeing, etc. To add comments related to the content of the application click 'Cancel' and add notes alongside the application.");var be={__name:"StepSendToChairsControl",props:{group:{type:Object,required:!0}},emits:["sentToChairs"],setup(e,{emit:t}){const a=e,r=(0,o.l1)(),n=(0,o.f3)("commentManager"),s=(0,D.iH)(),i=(0,D.iH)(!1),p=()=>{n.value.getComments(),i.value=!0},l=async()=>{await fe.hi.post(`/api/groups/${a.group.uuid}/command`,{command:"app.modules.group.actions.applicationSendToChairs",additionalComments:s.value||null}),t("sentToChairs"),i.value=!1},u=()=>{i.value=!1};return(e,t)=>{const a=(0,o.up)("note"),d=(0,o.up)("input-row"),c=(0,o.up)("button-row"),m=(0,o.up)("modal-dialog");return(0,o.wg)(),(0,o.iD)("div",null,[(0,o._)("button",(0,o.dG)({class:"btn btn-lg w-full",onClick:p},(0,D.SU)(r))," Send to Chairs for Review ",16),((0,o.wg)(),(0,o.j4)(o.lR,{to:"body"},[(0,o.Wm)(m,{modelValue:i.value,"onUpdate:modelValue":t[1]||(t[1]=e=>i.value=e),title:"Send to CDWG OC co-chairs for approval"},{footer:(0,o.w5)((()=>[(0,o.Wm)(c,{onSubmitted:l,onCanceled:u,"submit-text":"Send to Chairs"})])),default:(0,o.w5)((()=>[_e,we,(0,o.Wm)(ve.Z,{comments:(0,D.SU)(n).openComments},null,8,["comments"]),(0,o.Wm)(d,{modelValue:s.value,"onUpdate:modelValue":t[0]||(t[0]=e=>s.value=e),vertical:"",type:"large-text",label:"Additional notes for chairs",labelClass:"font-bold"},{"after-input":(0,o.w5)((()=>[(0,o.Wm)(a,null,{default:(0,o.w5)((()=>[ye])),_:1})])),_:1},8,["modelValue"])])),_:1},8,["modelValue"])]))])}}};const Se=be;var ke=Se;const Ue={class:"text-sm"},De=(0,o._)("div",null,"Send notification email to contacts",-1),xe=(0,o.Uk)(" The expert panel has not yet submitted the application for approval. "),Ce=(0,o._)("br",null,null,-1),Ae=(0,o.Uk)(' You can approve this application but be aware that it is not part of the "normal" application workflow. ');function Ee(e,t,a,r,n,s){const i=(0,o.up)("dictionary-row"),p=(0,o.up)("static-alert"),l=(0,o.up)("user-defined-mail-form"),u=(0,o.up)("button-row"),d=(0,o.up)("form-container");return(0,o.wg)(),(0,o.j4)(d,null,{default:(0,o.w5)((()=>[(0,o.Wm)(i,{label:""},{default:(0,o.w5)((()=>[(0,o._)("div",null,[(0,o._)("label",Ue,[(0,o.wy)((0,o._)("input",{type:"checkbox","onUpdate:modelValue":t[0]||(t[0]=e=>n.notifyContacts=e),value:!0},null,512),[[Q.e8,n.notifyContacts]]),De])])])),_:1}),s.application.hasPendingSubmissionForCurrentStep?(0,o.kq)("",!0):((0,o.wg)(),(0,o.j4)(p,{key:0,variant:"warning"},{default:(0,o.w5)((()=>[xe,Ce,Ae])),_:1})),(0,o.Wm)(Q.uT,{name:"slide-fade-down"},{default:(0,o.w5)((()=>[(0,o.wy)((0,o.Wm)(l,{modelValue:n.email,"onUpdate:modelValue":t[1]||(t[1]=e=>n.email=e)},null,8,["modelValue"]),[[Q.F8,n.notifyContacts]])])),_:1}),(0,o.Wm)(u,{onCanceled:s.cancel,onSubmitted:s.save,"submit-text":s.submissionText},null,8,["onCanceled","onSubmitted","submit-text"])])),_:1})}var Ve={components:{UserDefinedMailForm:ie["default"]},emits:["canceled","saved"],data(){return{notifyContacts:!0,email:{subject:"",body:"",cc:[],to:[],files:[]},errors:{}}},computed:{...(0,s.Se)({group:"groups/currentItemOrNew"}),application(){return this.group.expert_panel},submissionText(){return"Request Revisions"+(this.notifyContacts?" and notify":"")}},watch:{notifyContacts:{immediate:!0,handler:function(e){e&&this.getEmailTemplate()}}},methods:{clearForm(){this.dateApproved=null,this.notifyContacts=!0},cancel(){this.clearForm(),this.$emit("canceled")},async save(){try{const e={notify_contacts:this.notifyContacts,subject:this.email.subject,body:this.email.body,attachments:this.email.files},t=`/api/groups/${this.group.uuid}/application/submission/${this.group.expert_panel.pendingSubmission.id}/rejection`;await fe.hi.post(t,e).then((e=>e.data)),this.clearForm(),this.$emit("saved")}catch(e){if((0,se.Z)(e))return void(this.errors=e.response.data.errors);throw e}},getEmailTemplate(){fe.hi.get(`/api/email-drafts/groups/${this.group.uuid}`,{params:{templateClass:"App\\Mail\\UserDefinedMailTemplates\\ApplicationRevisionRequestTemplate"}}).then((e=>{this.email=e.data,this.email["files"]=[]}))}},mounted(){}};const We=(0,B.Z)(Ve,[["render",Ee]]);var qe=We,$e={__name:"StepRequestRevisionsControl",props:{group:{type:Object,required:!0}},emits:["revisionsRequested"],setup(e,{emit:t}){const a=(0,o.l1)(),r=(0,D.iH)(null),n=(0,D.iH)(!1),s=()=>{n.value=!0,r.value.getEmailTemplate()},i=()=>{p(),t("revisionsRequested")},p=()=>{n.value=!1};return(t,l)=>{const u=(0,o.up)("modal-dialog");return(0,o.wg)(),(0,o.iD)("div",null,[e.group.expert_panel.hasPendingSubmissionForCurrentStep?((0,o.wg)(),(0,o.iD)("button",(0,o.dG)({key:0,class:"btn btn-lg w-full",onClick:s},(0,D.SU)(a))," Request revisions ",16)):(0,o.kq)("",!0),((0,o.wg)(),(0,o.j4)(o.lR,{to:"body"},[(0,o.Wm)(u,{title:"Request Revisions to Application",modelValue:n.value,"onUpdate:modelValue":l[0]||(l[0]=e=>n.value=e),size:"xl",onClosed:l[1]||(l[1]=e=>t.$refs.rejectsubmissionform.clearForm())},{default:(0,o.w5)((()=>[(0,o.Wm)(qe,{ref_key:"rejectsubmissionform",ref:r,onSaved:i,onCanceled:p},null,512)])),_:1},8,["modelValue"])]))])}}};const Fe=$e;var Te=Fe;const je={class:"border-t border-b py-4 mb-6"},Ie={class:"flex w-full space-x-4"};var Ze={__name:"StepControls",props:{step:{type:Number,required:!0},approveLabel:{type:String,required:!1,default:"Approve"}},setup(e){const t=e,a=(0,s.oR)(),r=(0,o.Fl)((()=>a.getters["groups/currentItemOrNew"])),n=(0,o.Fl)((()=>{if(!r.value)return!1;const e=r.value.expert_panel.latestPendingSubmissionForStep(t.step);return e&&1==e.submission_status_id}));return(t,a)=>((0,o.wg)(),(0,o.iD)("div",je,[(0,o.Wm)(K,{class:"mb-4",group:(0,D.SU)(r),step:e.step},null,8,["group","step"]),(0,o._)("div",Ie,[(0,o.Wm)(ge,{class:"flex-1",group:(0,D.SU)(r),step:e.step,onStepApproved:a[0]||(a[0]=()=>{t.$emit("stepApproved"),t.$emit("updated")})},{default:(0,o.w5)((()=>[(0,o.Uk)((0,l.zw)(e.approveLabel),1)])),_:1},8,["group","step"]),(0,D.SU)(n)?((0,o.wg)(),(0,o.j4)((0,D.SU)(ke),{key:0,class:"flex-1",group:(0,D.SU)(r),onSentToChairs:a[1]||(a[1]=()=>{t.$emit("sentToChairs"),t.$emit("updated")})},null,8,["group"])):(0,o.kq)("",!0),(0,D.SU)(r).expert_panel.hasPendingSubmissionForCurrentStep?((0,o.wg)(),(0,o.j4)((0,D.SU)(Te),{key:1,class:"flex-1",group:(0,D.SU)(r),onRevisionsRequested:a[2]||(a[2]=()=>{t.$emit("revisionsRequested"),t.$emit("updated")})},null,8,["group"])):(0,o.kq)("",!0)])]))}};const Pe=Ze;var Ne=Pe,Re=a(2691),Oe={components:{ApplicationLog:U.Z,StepControls:Ne,RemoveButton:Re["default"]},props:{title:{type:String,required:!1,default:"YOU SHOULD SET A TITLE"},step:{type:Number,required:!0},documentName:{type:String,required:!1,default:'Set a document-type attribute if you don\'t use the "document" slot'},documentType:{type:Number,required:!1,default:1},documentGetsReviewed:{type:Boolean,required:!1,default:!0},approveButtonLabel:{type:String,required:!1,default:'Set "approve-button-label" if not overriding slot "approve-button"'}},emits:["documentUploaded","approved","updated"],data(){return{showApproveForm:!1,editApprovalDate:!1,newApprovalDate:null,showRejectForm:!1}},computed:{...(0,s.Se)({group:"groups/currentItemOrNew"}),application(){return this.group.expert_panel},isCurrentStep(){return this.step==this.application.current_step},dateApproved(){return this.application.approvalDateForStep(this.step)?(0,k.p6)(this.application.approvalDateForStep(this.step)):null}},methods:{goToPrintable(){window.open(`/groups/${this.group.uuid}/application/review`)},handleUpdated(){this.$emit("updated")},initEditApprovalDate(){this.editApprovalDate=!0,this.newApprovalDate=this.dateApproved},async updateApprovalDate(){try{await this.$store.dispatch("groups/updateApprovalDate",{group:this.group,dateApproved:this.newApprovalDate,step:this.step}),this.editApprovalDate=!1}catch(e){if((0,se.Z)(e))return void(this.errors=e.response.data.errors)}}}};const Me=(0,B.Z)(Oe,[["render",S]]);var Le=Me,ze=a(7411),Ge={name:"StepOne",components:{BaseStep:Le,DefinitionReview:ze.Z},emits:["approved","updated"],data(){return{}},computed:{...(0,s.Se)({group:"groups/currentItemOrNew"}),application(){return this.group.expert_panel}},methods:{}};const He=(0,B.Z)(Ge,[["render",p]]);var Be=He;const Ye={class:"application-section screen-block"},Ke=(0,o._)("h2",null,"Draft Specifications",-1);function Qe(e,t,a,r,n,s){const i=(0,o.up)("specifications-section"),p=(0,o.up)("base-step");return(0,o.wg)(),(0,o.j4)(p,{step:2,"document-type":2,"document-name":"Draft Specifications","document-gets-reviewed":!1,"approve-button-label":"Approve Draft Specifications",title:"Draft ACMG Guideline Specifications",onUpdated:t[0]||(t[0]=t=>e.$emit("updated"))},{sections:(0,o.w5)((()=>[(0,o._)("div",Ye,[Ke,(0,o.Wm)(i,{"doc-type-id":2})])])),_:1})}var Je=a(8977),Xe={name:"StepTwo",components:{BaseStep:Le,SpecificationsSection:Je.Z},props:{},emits:["approved","updated"],data(){return{}},computed:{...(0,s.Se)({group:"groups/currentItemOrNew"}),application(){return this.group.expert_panel}},methods:{}};const et=(0,B.Z)(Xe,[["render",Qe]]);var tt=et;const at={class:"application-section screen-block"},ot=(0,o._)("h2",null,"Pilot Specifications",-1);function rt(e,t,a,r,n,s){const i=(0,o.up)("specifications-section"),p=(0,o.up)("base-step");return(0,o.wg)(),(0,o.j4)(p,{step:3,"approve-button-label":"Approve Pilot and Specifications",title:"Pilot ACMG Guideline Specificiations",onUpdated:t[0]||(t[0]=t=>e.$emit("updated"))},{sections:(0,o.w5)((()=>[(0,o._)("div",at,[ot,(0,o.Wm)(i,{"doc-type-id":[3,4,7]})])])),_:1})}var nt={name:"StepThree",components:{BaseStep:Le,SpecificationsSection:Je.Z},props:{},emits:["approved","updated"],data(){return{}},computed:{...(0,s.Se)({group:"groups/currentItemOrNew"}),application(){return this.group.expert_panel}},methods:{formatDate(e){return(0,k.p6)(e)}}};const st=(0,B.Z)(nt,[["render",rt]]);var it=st;function pt(e,t,a,r,n,s){const i=(0,o.up)("sustained-curation-review"),p=(0,o.up)("base-step");return(0,o.wg)(),(0,o.j4)(p,{step:4,"document-type":5,"document-name":"Sustained Curation","document-gets-reviewed":!0,"approve-button-label":"Approve Sustained Curation",title:"Sustained Curation",onUpdated:t[0]||(t[0]=t=>e.$emit("updated"))},{sections:(0,o.w5)((()=>[(0,o.Wm)(i)])),_:1})}var lt=a(3496),ut={name:"StepFour",components:{BaseStep:Le,SustainedCurationReview:lt.Z},props:{},emits:["approved","updated"],data(){return{}},computed:{...(0,s.Se)({group:"groups/currentItemOrNew"}),application(){return this.group.expert_panel}},methods:{}};const dt=(0,B.Z)(ut,[["render",pt]]);var ct=dt,mt={components:{StepOne:Be,StepTwo:tt,StepThree:it,StepFour:ct},emits:["approved","updated"],data(){return{activeStep:1}},computed:{...(0,s.Se)({group:"groups/currentItemOrNew"}),application(){return this.group.expert_panel},activeIndex:{deep:!0,get(){return this.application&&this.application.current_step?this.application.current_step-1:0},set(e){this.activeStep=e+1}}},methods:{handleApproved(){this.$emit("approved"),this.$emit("updated")},handleUpdated(){this.$emit("updated")}}};const ht=(0,B.Z)(mt,[["render",n]]);var gt=ht},7889:function(e,t,a){a.d(t,{Z:function(){return C}});var o=a(6252),r=a(3577),n=a(9963);const s={key:0},i={key:0},p=(0,o.Uk)(" Affiliation ID "),l=(0,o.Uk)("admin-only"),u={key:0},d={key:1,class:"text-gray-400"},c={key:1},m={key:2},h=(0,o.Uk)(" Status: "),g=(0,o.Uk)("admin-only"),v=(0,o.Uk)(" Parent group: "),f=(0,o.Uk)("admin-only");function _(e,t,a,_,w,y){const b=(0,o.up)("input-row"),S=(0,o.up)("dictionary-row"),k=(0,o.up)("note");return(0,o.wg)(),(0,o.iD)("div",null,[y.canSetType?((0,o.wg)(),(0,o.j4)(b,{key:0,modelValue:y.group.group_type_id,"onUpdate:modelValue":t[0]||(t[0]=e=>y.group.group_type_id=e),errors:_.errors.group_type_id,type:"select",options:y.typeOptions,label:"Type"},null,8,["modelValue","errors","options"])):((0,o.wg)(),(0,o.j4)(S,{key:1,label:"Type"},{default:(0,o.w5)((()=>[(0,o.Uk)((0,r.zw)(this.group?.type?.display_name),1)])),_:1})),(0,o.Wm)(n.uT,{name:"slide-fade-down",mode:"out-in"},{default:(0,o.w5)((()=>[y.group.group_type_id>2&&y.group.expert_panel?((0,o.wg)(),(0,o.iD)("div",s,[(0,o.Wm)(b,{label:"Long Base Name",modelValue:y.group.expert_panel.long_base_name,"onUpdate:modelValue":[t[1]||(t[1]=e=>y.group.expert_panel.long_base_name=e),y.emitUpdate],placeholder:"Long base name",errors:_.errors.long_base_name,"input-class":"w-full"},null,8,["modelValue","onUpdate:modelValue","errors"]),(0,o.Wm)(b,{label:"Short Base Name",modelValue:y.group.expert_panel.short_base_name,"onUpdate:modelValue":[t[2]||(t[2]=e=>y.group.expert_panel.short_base_name=e),y.emitUpdate],placeholder:"Short base name",errors:_.errors.short_base_name,"input-class":"w-full"},null,8,["modelValue","onUpdate:modelValue","errors"]),e.hasAnyPermission(["groups-manage"])?((0,o.wg)(),(0,o.iD)("div",i,[(0,o.Wm)(b,{label:"Affiliation ID",modelValue:y.group.expert_panel.affiliation_id,"onUpdate:modelValue":[t[3]||(t[3]=e=>y.group.expert_panel.affiliation_id=e),y.emitUpdate],placeholder:y.affiliationIdPlaceholder,errors:_.errors.affiliation_id,"input-class":"w-full"},{label:(0,o.w5)((()=>[p,(0,o.Wm)(k,null,{default:(0,o.w5)((()=>[l])),_:1})])),_:1},8,["modelValue","placeholder","errors","onUpdate:modelValue"])])):((0,o.wg)(),(0,o.j4)(S,{key:1,label:"Affiliation ID"},{default:(0,o.w5)((()=>[y.group.expert_panel.affiliation_id?((0,o.wg)(),(0,o.iD)("span",u,(0,r.zw)(y.group.expert_panel.affiliation_id),1)):((0,o.wg)(),(0,o.iD)("span",d,(0,r.zw)("Not yet assigend")))])),_:1}))])):((0,o.wg)(),(0,o.iD)("div",c,[(0,o.Wm)(b,{modelValue:y.group.name,"onUpdate:modelValue":[t[4]||(t[4]=e=>y.group.name=e),y.emitUpdate],placeholder:"Name",label:"Name","input-class":"w-full",errors:_.errors.name},null,8,["modelValue","errors","onUpdate:modelValue"])]))])),_:1}),e.hasPermission("groups-manage")?((0,o.wg)(),(0,o.iD)("div",m,[(0,o.Wm)(b,{modelValue:y.group.group_status_id,"onUpdate:modelValue":[t[5]||(t[5]=e=>y.group.group_status_id=e),y.emitUpdate],type:"select",options:y.statusOptions,errors:_.errors.group_status_id},{label:(0,o.w5)((()=>[h,(0,o.Wm)(k,null,{default:(0,o.w5)((()=>[g])),_:1})])),_:1},8,["modelValue","options","errors","onUpdate:modelValue"]),(0,o.Wm)(b,{modelValue:y.group.parent_id,"onUpdate:modelValue":[t[6]||(t[6]=e=>y.group.parent_id=e),y.emitUpdate],type:"select",options:y.parentOptions,errors:_.errors.parent_id},{label:(0,o.w5)((()=>[v,(0,o.Wm)(k,null,{default:(0,o.w5)((()=>[f])),_:1})])),_:1},8,["modelValue","options","errors","onUpdate:modelValue"])])):(0,o.kq)("",!0)])}var w=a(6486),y=a(9028),b=a(7506),S=a(3823),k=a(3774),U={name:"GroupForm",emits:["canceled","saved","update"],data(){return{groupTypes:S.groups.types,groupStatuses:S.groups.statuses,newGroup:new b.Z,parents:[]}},computed:{group:{get(){const e=this.$store.getters["groups/currentItem"];return e||this.newGroup},set(e){try{this.$store.commit("groups/addItem",e)}catch(t){this.newGroup=e}}},statusOptions(){return Object.values(this.groupStatuses).map((e=>({value:e.id,label:this.titleCase(e.name)})))},typeOptions(){return Object.values(this.groupTypes).map((e=>({value:e.id,label:e.display_name})))},canSetType(){return this.hasPermission("groups-manage")&&!this.group.id},affiliationIdPlaceholder(){return 5e4},cdwgs(){return this.$store.getters["cdwgs/all"]},namesDirty(){return this.group.expert_panel.isDirty("long_base_name")||this.group.expert_panel.isDirty("short_base_name")},affiliationIdDirty(){return this.group.expert_panel.isDirty("affiliation_id")},parentOptions(){const e=[{value:0,label:"None"}];return this.parents.filter((e=>e.type.can_be_parent)).forEach((t=>{e.push({value:t.id,label:t.displayName})})),(0,w.sortBy)(e,"label")}},methods:{async save(){this.resetErrors();try{if(this.group.id)return await this.updateGroup(),void this.$emit("saved");const e=await this.createGroup().then((e=>e.data.data));this.$emit("saved"),this.$store.commit("pushSuccess","Group created."),this.$router.push({name:"AddMember",params:{uuid:e.uuid}})}catch(e){throw(0,y.z1)(e)&&(this.errors=e.response.data.errors),e}},createGroup(){let{name:e,parent_id:t,group_type_id:a,group_status_id:o}=this.group.attributes;const{short_base_name:r}=this.group.expert_panel;return null===e&&this.group.expert_panel&&(e=this.group.expert_panel.long_base_name),this.$store.dispatch("groups/create",{name:e,parent_id:t,group_type_id:a,group_status_id:o,short_base_name:r})},updateGroup(){const e=[];return e.push(this.saveGroupData()),this.group.expert_panel&&e.push(this.saveEpData()),Promise.all(e)},saveGroupData(){const e=[];return this.group.isDirty("parent_id")&&e.push(this.saveParent()),this.group.isDirty("name")&&e.push(this.saveName()),this.group.isDirty("group_status_id")&&e.push(this.saveStatus()),Promise.all(e)},async saveEpData(){const e=[];if(this.namesDirty){const{long_base_name:t,short_base_name:a}=this.group.expert_panel;e.push(this.submitFormData({method:"put",url:`/api/groups/${this.group.uuid}/expert-panel/name`,data:{long_base_name:t,short_base_name:a}}))}return this.affiliationIdDirty&&e.push(this.submitFormData({method:"put",url:`/api/groups/${this.group.uuid}/expert-panel/affiliation-id`,data:{affiliation_id:this.group.expert_panel.affiliation_id}})),await Promise.all(e)},isDirty(e){return this.group[e]!=this.group[e]},saveParent(){return this.submitFormData({method:"put",url:`/api/groups/${this.group.uuid}/parent`,data:{parent_id:this.group.parent_id}})},saveName(){return this.submitFormData({method:"put",url:`/api/groups/${this.group.uuid}/name`,data:{name:this.group.name}})},saveStatus(){return this.submitFormData({method:"put",url:`/api/groups/${this.group.uuid}/status`,data:{status_id:this.group.group_status_id}})},resetData(){this.group.uuid&&this.$store.dispatch("groups/find",this.group.uuid)},cancel(){this.group.uuid&&this.resetData(),this.$emit("canceled")},async getParentOptions(){const e={"where[group_type_id]":[1,2],without:["coordinators","expertPanel"]};this.parents=await y.hi.get("/api/groups",{params:e}).then((e=>e.data.filter((e=>e.id!=this.group.id)).map((e=>new b.Z(e)))))},emitUpdate(){this.$emit("update")}},beforeMount(){this.getParentOptions(),this.$store.dispatch("cdwgs/getAll")},setup(e,t){const{errors:a,submitFormData:o,resetErrors:r}=(0,k.ZP)(e,t);return{errors:a,submitFormData:o,resetErrors:r}}},D=a(3744);const x=(0,D.Z)(U,[["render",_]]);var C=x},8887:function(e,t,a){a.r(t),a.d(t,{default:function(){return m}});var o=a(6252);function r(e,t,a,r,n,s){const i=(0,o.up)("input-row"),p=(0,o.up)("step-input"),l=(0,o.up)("rich-text-editor"),u=(0,o.up)("button-row"),d=(0,o.up)("form-container");return(0,o.wg)(),(0,o.j4)(d,{class:"log-entry-form",ref:"form-container"},{default:(0,o.w5)((()=>[(0,o.Wm)(i,{label:"Log Date",modelValue:n.newEntry.log_date,"onUpdate:modelValue":t[0]||(t[0]=e=>n.newEntry.log_date=e),errors:n.errors.log_date,type:"date",ref:"logdate"},null,8,["modelValue","errors"]),2==s.application.expert_panel_type_id?((0,o.wg)(),(0,o.j4)(p,{key:0,modelValue:n.newEntry.step,"onUpdate:modelValue":t[1]||(t[1]=e=>n.newEntry.step=e),errors:n.errors.step},null,8,["modelValue","errors"])):(0,o.kq)("",!0),(0,o.Wm)(i,{label:"Entry",errors:n.errors.entry},{default:(0,o.w5)((()=>[(0,o.Wm)(l,{modelValue:n.newEntry.entry,"onUpdate:modelValue":t[2]||(t[2]=e=>n.newEntry.entry=e)},null,8,["modelValue"])])),_:1},8,["errors"]),(0,o.Wm)(u,null,{default:(0,o.w5)((()=>[(0,o._)("button",{class:"btn",onClick:t[3]||(t[3]=(...e)=>s.cancel&&s.cancel(...e))},"Cancel"),(0,o._)("button",{class:"btn blue",onClick:t[4]||(t[4]=(...e)=>s.save&&s.save(...e))},"Save")])),_:1})])),_:1},512)}var n=a(3907),s=a(5699),i=a(703),p=a(2584),l=a(9272),u={name:"LogEntryForm",components:{StepInput:i["default"],RichTextEditor:p["default"]},props:{id:{required:!1,default:null}},data(){return{newEntry:{log_date:new Date,step:null,entry:""},errors:{}}},computed:{...(0,n.Se)({group:"groups/currentItemOrNew"}),application(){return this.group.expert_panel}},watch:{id:{immediate:!0,handler:function(){const e=this.findEntry();e&&this.syncEntry(e)}},application:{immediate:!0,handler:function(){const e=this.findEntry();e&&this.syncEntry(e)}}},methods:{findEntry(){return null===this.id?null:this.logEntries?this.logEntries.find((e=>e.id==this.id)):void 0},initNewEntry(){this.newEntry={log_date:(0,s.p6)(new Date),step:null,entry:""}},syncEntry(e){e&&(this.newEntry={id:e.id,log_date:(0,s.p6)(new Date(Date.parse(e.created_at))),step:parseInt(e.step),entry:e.description})},cancel(){this.initNewEntry(),this.$emit("canceled")},async save(){try{this.newEntry.id?(0,l.ld)(`/api/groups/${this.group.uuid}/activity-logs/${this.newEntry.id}`,this.newEntry):(0,l.q1)(`/api/groups/${this.group.uuid}/activity-logs`,this.newEntry),this.initNewEntry(),this.$emit("saved")}catch(e){if(e.response&&422==e.response.status&&e.response.data.errors)return void(this.errors=e.response.data.errors)}}},mounted(){this.$el.querySelectorAll("input")[0].focus()},setup(){return{logEntries:l.Q3}}},d=a(3744);const c=(0,d.Z)(u,[["render",r]]);var m=c}}]);
//# sourceMappingURL=329.a5104834.js.map