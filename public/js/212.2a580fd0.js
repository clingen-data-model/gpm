"use strict";(self["webpackChunkepam"]=self["webpackChunkepam"]||[]).push([[212],{9212:function(e,t,i){i.r(t),i.d(t,{default:function(){return f}});var a=i(6252),n=i(9963),r=i(3577);const s=(0,a.Uk)("Admin"),o=(0,a._)("h1",null,"Invites",-1),l=["onClick"],d=(0,a._)("p",null,"This cannot be undone.",-1),m=(0,a._)("p",null,"Do you want to reset the invite?",-1);function u(e,t,i,u,h,p){const c=(0,a.up)("note"),b=(0,a.up)("data-table"),v=(0,a.up)("button-row"),f=(0,a.up)("modal-dialog"),g=(0,a.Q2)("remaining-height");return(0,a.wg)(),(0,a.iD)("div",null,[(0,a.Wm)(c,null,{default:(0,a.w5)((()=>[s])),_:1}),o,(0,a.wy)(((0,a.wg)(),(0,a.j4)(b,{data:p.itemProvider,fields:h.fields,sort:h.tableSort,"onUpdate:sort":t[1]||(t[1]=e=>h.tableSort=e),class:"text-sm",paginated:"",ref:"dataTable"},{header:(0,a.w5)((()=>[(0,a.wy)((0,a._)("input",{type:"text","onUpdate:modelValue":t[0]||(t[0]=e=>h.searchTerm=e),placeholder:"filter by name or email",class:"mb-2"},null,512),[[n.nr,h.searchTerm]])])),"cell-reset":(0,a.w5)((({item:e})=>[e.redeemed_at?((0,a.wg)(),(0,a.iD)("button",{key:0,class:"btn btn-xs",onClick:t=>p.confirmReset(e)}," Reset ",8,l)):(0,a.kq)("",!0)])),_:1},8,["data","fields","sort"])),[[g]]),((0,a.wg)(),(0,a.j4)(a.lR,{to:"body"},[(0,a.Wm)(f,{title:"Reset Invite",modelValue:h.showConfirmation,"onUpdate:modelValue":t[3]||(t[3]=e=>h.showConfirmation=e)},{default:(0,a.w5)((()=>[(0,a._)("p",null,"You are about to reset the invite for "+(0,r.zw)(h.resettingInvite.first_name)+" "+(0,r.zw)(h.resettingInvite.last_name)+".",1),d,m,(0,a.Wm)(v,{"submit-text":"Reset Invite",onSubmitted:t[2]||(t[2]=e=>p.resetInvite(h.resettingInvite))})])),_:1},8,["modelValue"])]))])}var h=i(9028),p=i(9183),c={name:"InviteAdmin",props:{},data(){return{resettingInvite:{},tableSort:{field:"id",desc:!1},invites:[],showConfirmation:!1,searchTerm:null,fields:[{name:"id",sortable:!0,type:Number},{name:"person.name",label:"Name",sortable:!0,type:String},{name:"person.email",label:"Email",sortable:!0,type:String},{name:"redeemed_at",sortable:!0,type:Date},{name:"inviter",sortable:!0,type:String,resolveValue:e=>e.inviter?e.inviter.name:null},{name:"code",sortable:!1,type:String},{name:"reset",sortable:!1,type:String}]}},watch:{searchTerm(){this.triggerSearch()}},methods:{async itemProvider(e,t,i,a){const n={page:e,page_size:t,"sort[field]":i.field.name,"sort[dir]":i.desc?"DESC":"ASC","where[keyword]":this.searchTerm},r=await h.hi.get("/api/people/invites",{params:n}).then((e=>e.data));return a(r.meta.total),r.data},async resetInvite(e){try{const t=await h.hi.put(`/api/people/invites/${e.code}/reset`),i=this.invites.findIndex((t=>t.id==e.id));-1==i&&alert("what??"),this.invites[i]=t.data}catch(t){if((0,h.z1)(t))return void alert("Problem resetting invite!")}this.showConfirmation=!1},confirmReset(e){this.resettingInvite=e,this.showConfirmation=!0}},mounted(){this.triggerSearch=(0,p.Z)((()=>this.$refs.dataTable.getItems()),500)}},b=i(3744);const v=(0,b.Z)(c,[["render",u]]);var f=v}}]);
//# sourceMappingURL=212.2a580fd0.js.map