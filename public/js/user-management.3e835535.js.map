{"version":3,"file":"js/user-management.3e835535.js","mappings":"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","sources":["webpack://epam/./src/composables/router_aware_sort_and_filter.js","webpack://epam/./src/views/users/UserDetail.vue","webpack://epam/./src/views/users/UserDetail.vue?b814","webpack://epam/./src/views/users/UserList.vue","webpack://epam/./src/views/users/UserList.vue?6dab"],"sourcesContent":["import { useRouter, useRoute } from 'vue-router'\nimport {computed} from 'vue'\n\nexport default function (defaultSort = null) {\n    const router = useRouter()\n    const route = useRoute()\n    if (!defaultSort){\n        console.log('Warning: defaultSort is deprecated.  Please provide a sort object: {field: \"fieldname\", desc: boolean}')\n        defaultSort = (defaultSort) ? defaultSort : {field: 'name', desc: false}\n    }\n    \n    const sort = computed({\n        immediate: true,\n        get() {\n            if (Object.keys(route.query).includes('sort-field')) {\n                return {\n                    field: route.query['sort-field'],\n                    desc: Boolean(parseInt(route.query['sort-desc']))\n                }\n            }\n            return defaultSort;\n        },\n        set(sortObj) {\n            const newSortQuery = {'sort-field': sortObj.field, 'sort-desc': sortObj.desc ? 1 : 0}\n    \n            const newQuery = {\n                ...route.query, \n                ...newSortQuery\n            };\n    \n            router.replace({path: route.path, query: newQuery})\n        }\n    });\n    \n    const filter = computed({\n        set(value) {\n            let currentQuery = route.query;\n            let currentPath = route.path;\n    \n            let updatedQuery = {...currentQuery};\n    \n            if (!value) {\n                delete updatedQuery.filter;\n            } else {\n                updatedQuery = {...currentQuery, ...{'filter': value} };\n            }\n    \n            router.replace({path: currentPath, query: updatedQuery})\n        },\n        get() {\n            return route.query.filter\n        },\n        immediate: true\n    });\n\n    return {\n        sort,\n        filter\n    }\n}\n","<template>\n    <div>\n        <h1>{{user.person.name || 'loading...'}}</h1>\n\n        <object-dictionary :obj=\"userInfo\"></object-dictionary>\n        <button class=\"btn btn-xs\" @click=\"initEdit\" v-if=\"canEditUser\">Edit system roles &amp; permissions</button>\n\n        <h2 class=\"mt-8 mb-2\">Memberships</h2>\n        <data-table :fields=\"membershipFields\" :data=\"membershipInfo\"></data-table>\n\n        <teleport to=\"body\">\n            <modal-dialog\n                v-model=\"showEditForm\"\n                title=\"Edit System Roles & Permissions\"\n            >\n                <h3 class=\"border-b mb-1\">Roles</h3>\n                <ul class=\"flex flex-wrap\">\n                    <li v-for=\"role in availableSystemRoles\" :key=\"role.id\" class=\"w-1/3 h-12\">\n                        <checkbox v-model=\"checkedRoles\" :label=\"titleCase(role.display_name)\" :value=\"role.id\" />\n                    </li>\n                </ul>\n\n                <h3 class=\"border-b mb-1\">Permissions</h3>\n                <ul class=\"flex flex-wrap\">\n                    <li v-for=\"permission in availableSystemPermissions\" :key=\"permission.id\" class=\"w-1/3 h-12\">\n                        <checkbox\n                            v-if=\"checkedRolePermissionIds.includes(permission.id)\"\n                            :modelValue=\"true\" :disabled=\"true\" :label=\"permission.display_name\"\n                        />\n                        <checkbox\n                            v-else\n                            v-model=\"checkedPermissions\"\n                            :label=\"titleCase(permission.display_name)\"\n                            :value=\"permission.id\"\n                        />\n                    </li>\n                </ul>\n\n                <div class=\"px-2 py-1 mb-2 mt-4 bg-gray-100 border relative text-xs\">\n                    <div class=\"flex space-x-2\">\n                    <strong>Legend: </strong>\n                        <checkbox label=\"Not granted\" />\n                        <checkbox :value=\"1\" :modelValue=\"true\" label=\"Granted\" />\n                        <checkbox :value=\"2\" :modelValue=\"true\"  disabled label=\"Granted w/ role\" />\n                    </div>\n                    <div class=\"absolute top-0 left-0 w-full h-full bg-pink-500 opacity-0\">&nbsp;</div>\n                </div>\n\n                <button-row\n                    submit-text=\"Save\"\n                    @submitted=\"saveRolesAndPermissions\"\n                    @canceled=\"closeEditForm\"\n                ></button-row>\n            </modal-dialog>\n        </teleport>\n    </div>\n</template>\n<script>\nimport User from '@/domain/user'\nimport {api} from '@/http'\nimport configs from '@/configs'\n\nexport default {\n    name: 'UserDetail',\n    props: {\n        id: {\n            require: true\n        }\n    },\n    data() {\n        return {\n            user: new User(),\n            membershipFields: [\n                {name: 'id'},\n                {name: 'group'},\n                {name: 'roles'},\n                {name: 'extra_permissions'}\n            ],\n            showEditForm: false,\n            systemRoles: [],\n            systemPermissions: Object.values(configs.system.permissions),\n            configs,\n            checkedRoles: [],\n            checkedPermissions: [],\n        }\n    },\n    computed: {\n        userInfo () {\n            return {\n                name: this.user.person.name,\n                email: this.user.person.email,\n                roles: this.user.roles.map(r => r.name).join(', '),\n                additional_permissions: this.user.permissions.map(r => r.name).join(', '),\n                registered: this.formatDate(this.user.created_at),\n            }\n        },\n        membershipInfo () {\n            return this.user.person.memberships.map(m => ({\n                    id: m.id,\n                    group: m.group.display_name,\n                    roles: m.roles.map(r => r.name).join(', '),\n                    extra_permissions: m.permissions.map(r => r.name).join(', ') || '',\n                    is_contact: m.is_contact ? 'Yes' : 'No',\n                }))\n        },\n        checkedRolePermissionIds () {\n            if (!this.systemRoles) {\n                return [];\n            }\n            const checkedRolePerms = this.systemRoles\n                                        .filter(r => this.checkedRoles.includes(r.id))\n                                        .map(r => r.permissions)\n                                        .flat()\n                                        .map(p => p.id);\n            return [...(new Set(checkedRolePerms))];\n        },\n        availableSystemRoles () {\n            return this.systemRoles.filter(r => {\n                if (this.hasRole('super-user')) return true;\n                if (this.hasRole('super-admin')) {\n                    if (r.name === 'super-user') return false;\n                    return true;\n                }\n                return false;\n            });\n        },\n        availableSystemPermissions () {\n            return this.systemPermissions.filter(p => {\n                if (this.hasRole('super-user')) return true;\n                if (this.hasRole('super-admin')) {\n                    if (p.name === 'logs-view') return false;\n                    return true;\n                }\n                return false;\n            });\n        },\n        canEditUser () {\n            const currentUser = this.$store.getters.currentUser;\n            if (!this.hasPermission('users-manage')) {\n                return false;\n            }\n\n            if (this.currentUserIsUser) {\n                return true;\n            }\n\n            if (currentUser.hasRole('super-user')) {\n                return true;\n            }\n\n            if (currentUser.hasRole('super-admin') && (this.user.hasRole('admin') || this.user.hasNoRole())) {\n                return true;\n            }\n\n            return false;\n\n        },\n        currentUserIsUser () {\n            return this.$store.getters.currentUser.id == this.user.id;\n        }\n    },\n    watch: {\n        id: {\n            immediate: true,\n            handler () {\n                this.getUser();\n            }\n        }\n    },\n    methods: {\n        async getUser () {\n            this.user = await api.get(`/api/users/${this.id}`)\n                            .then(response => {\n                                return new User(response.data)\n                            });\n            this.resetCheckedRolesAndPermissions();\n        },\n        resetCheckedRolesAndPermissions () {\n            this.checkedRoles = this.user.roles.map(r => r.id);\n            this.checkedPermissions = this.user.permissions.map(r => r.id);\n        },\n        async getSystemRoles () {\n            this.systemRoles = await api.get(`/api/roles`)\n                                .then(response => response.data);\n        },\n        initEdit () {\n            this.showEditForm = true;\n        },\n        async saveRolesAndPermissions () {\n            const payload = {\n                role_ids: this.checkedRoles,\n                permission_ids: this.checkedPermissions\n            };\n\n            await api.put(`/api/users/${this.user.id}/roles-and-permissions`, payload);\n            this.showEditForm = false;\n\n            this.getUser();\n\n        },\n        closeEditForm () {\n            this.resetCheckedRolesAndPermissions();\n            this.showEditForm = false;\n        }\n    },\n    mounted () {\n        this.getSystemRoles();\n    }\n}\n</script>\n","import { render } from \"./UserDetail.vue?vue&type=template&id=0f72f512\"\nimport script from \"./UserDetail.vue?vue&type=script&lang=js\"\nexport * from \"./UserDetail.vue?vue&type=script&lang=js\"\n\nimport exportComponent from \"/Users/bpow/src/clingen/gpm/resources/app/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render]])\n\nexport default __exports__","<template>\n    <div>\n        <h1>Users</h1>\n        <data-table\n            :fields=\"fields\"\n            :data=\"getUsers\"\n            v-model:sort=\"sort\"\n            @rowClick=\"goToUser\"\n            row-class=\"cursor-pointer\"\n            ref=\"dataTable\"\n            paginated\n        >\n            <template v-slot:header>\n                <div>Filter: &nbsp;<input type=\"text\" v-model=\"filter\" placeholder=\"name, email\"></div>\n            </template>\n        </data-table>\n    </div>\n</template>\n<script>\nimport {api} from '@/http'\nimport {debounce} from 'lodash-es'\nimport sortAndFilterSetup from '@/composables/router_aware_sort_and_filter'\n\nexport default {\n    name: 'ComponentName',\n    props: {\n\n    },\n    data() {\n        return {\n            users: [],\n            fields: [\n                {\n                    name: 'id',\n                    type: Number,\n                    sortable: true\n                },\n                {\n                    name: 'person.name',\n                    label: 'Name',\n                    type: String,\n                    sortable: true\n                },\n                {\n                    name: 'person.email',\n                    label: 'Email',\n                    type: String,\n                    sortable: true\n                },\n                {\n                    name: 'roles',\n                    label: 'System Roles',\n                    type: String,\n                    sortable: false,\n                    resolveValue (item) {\n                        return item.roles.map(r => r.display_name).join(', ')\n                    }\n                },\n                {\n                    name: 'permissions',\n                    label: '+ Permissions',\n                    type: String,\n                    sortable: false,\n                    resolveValue (item) {\n                        return item.permissions.map(r => r.display_name).join(', ')\n                    },\n                    class: 'text-xs'\n                },\n                // {\n                //     name: 'actions',\n                //     sortable: false,\n                //     label: ''\n                // }\n\n            ]\n        }\n    },\n    computed: {\n        filteredUsers () {\n            if (!this.filter) {\n                return this.users;\n            }\n            const pattern = new RegExp(`.*${this.filter}.*`, 'i')\n            return this.users.filter(u => {\n                return u.person.name.match(pattern)\n                    || u.person.email.match(pattern);\n            });\n        }\n    },\n    watch: {\n        filter: {\n            immediate: true,\n            handler () {\n                if (this.triggerSearch) {\n                    this.triggerSearch()\n                }\n            }\n        },\n        sort: {\n            immediate: true,\n            handler () {\n                 if (this.triggerSearch) {\n                    this.triggerSearch()\n                }\n            }\n        }\n    },\n    methods: {\n        async getUsers (currentPage, pageSize, sort, setTotalItems) {\n            const params = {\n                page: currentPage,\n                page_size: pageSize,\n                'sort[field]': sort.field.name,\n                'sort[dir]': sort.desc ? 'DESC' : 'ASC',\n                'where[filterString]': this.filter,\n                'with': ['roles', 'permissions'],\n                paginated: true\n            }\n            const pageResponse = await api.get('/api/users', {params: params})\n                                .then(response => response.data);\n            setTotalItems(pageResponse.meta.total);\n            return pageResponse.data;\n        },\n        goToUser (user) {\n            this.$router.push({name: 'UserDetail', params: {id: user.id}})\n        }\n    },\n    setup() {\n        const {sort, filter} = sortAndFilterSetup({\n            field: 'person.name',\n            desc: false\n        });\n\n        return {\n            sort,\n            filter,\n        }\n    },\n    created () {\n        this.triggerSearch = debounce(() => this.$refs.dataTable.getItems(), 500)\n    }\n}\n</script>\n","import { render } from \"./UserList.vue?vue&type=template&id=54a2e21a\"\nimport script from \"./UserList.vue?vue&type=script&lang=js\"\nexport * from \"./UserList.vue?vue&type=script&lang=js\"\n\nimport exportComponent from \"/Users/bpow/src/clingen/gpm/resources/app/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render]])\n\nexport default __exports__"],"names":["defaultSort","router","useRouter","route","useRoute","console","log","field","desc","sort","computed","immediate","get","Object","keys","query","includes","Boolean","parseInt","set","sortObj","newSortQuery","newQuery","replace","path","filter","value","currentQuery","currentPath","updatedQuery","_createElementVNode","class","_createElementBlock","_toDisplayString","$data","person","name","_createVNode","_component_object_dictionary","obj","$options","onClick","_hoisted_1","_component_data_table","fields","data","_createBlock","_Teleport","to","_component_modal_dialog","$event","title","_hoisted_2","_Fragment","_renderList","role","key","id","_component_checkbox","label","_ctx","display_name","_hoisted_4","permission","modelValue","disabled","_hoisted_8","_hoisted_9","_component_button_row","onSubmitted","onCanceled","props","require","user","User","membershipFields","showEditForm","systemRoles","systemPermissions","values","configs","system","permissions","checkedRoles","checkedPermissions","userInfo","this","email","roles","map","r","join","additional_permissions","registered","formatDate","created_at","membershipInfo","memberships","m","group","extra_permissions","is_contact","checkedRolePermissionIds","checkedRolePerms","flat","p","Set","availableSystemRoles","hasRole","availableSystemPermissions","canEditUser","currentUser","$store","getters","hasPermission","currentUserIsUser","hasNoRole","watch","handler","getUser","methods","async","api","then","response","resetCheckedRolesAndPermissions","initEdit","payload","role_ids","permission_ids","closeEditForm","mounted","getSystemRoles","__exports__","render","$setup","onRowClick","ref","paginated","header","type","placeholder","users","Number","sortable","String","resolveValue","item","filteredUsers","pattern","RegExp","u","match","triggerSearch","currentPage","pageSize","setTotalItems","params","page","page_size","pageResponse","meta","total","goToUser","$router","push","setup","sortAndFilterSetup","created","debounce","$refs","dataTable","getItems"],"sourceRoot":""}