"use strict";(self["webpackChunkepam"]=self["webpackChunkepam"]||[]).push([[192],{2790:function(e,t,r){r.d(t,{Z:function(){return s}});r(6699);var i=r(2119),a=r(6252);function s(e=null){const t=(0,i.tv)(),r=(0,i.yj)();e||(console.log('Warning: defaultSort is deprecated.  Please provide a sort object: {field: "fieldname", desc: boolean}'),e=e||{field:"name",desc:!1});const s=(0,a.Fl)({immediate:!0,get(){return Object.keys(r.query).includes("sort-field")?{field:r.query["sort-field"],desc:Boolean(parseInt(r.query["sort-desc"]))}:e},set(e){const i={"sort-field":e.field,"sort-desc":e.desc?1:0},a={...r.query,...i};t.replace({path:r.path,query:a})}}),n=(0,a.Fl)({set(e){let i=r.query,a=r.path,s={...i};e?s={...i,filter:e}:delete s.filter,t.replace({path:a,query:s})},get(){return r.query.filter},immediate:!0});return{sort:s,filter:n}}},8196:function(e,t,r){r.r(t),r.d(t,{default:function(){return w}});var i=r(6252),a=r(9963);const s=(0,i._)("h1",null,"People",-1),n={class:"block mb-2",for:"filter-input"},l=(0,i.Uk)("Filter:Â ");function o(e,t,r,o,d,u){const c=(0,i.up)("data-table");return(0,i.wg)(),(0,i.iD)("div",null,[s,(0,i.Wm)(c,{data:u.itemProvider,fields:d.fields,class:"width-full","row-click-handler":u.goToPerson,"row-class":"cursor-pointer",sort:o.sort,"onUpdate:sort":t[1]||(t[1]=e=>o.sort=e),"page-size":20,paginated:"",ref:"dataTable"},{header:(0,i.w5)((()=>[(0,i._)("label",n,[l,(0,i.wy)((0,i._)("input",{type:"text","onUpdate:modelValue":t[0]||(t[0]=e=>o.filter=e),placeholder:"filter"},null,512),[[a.nr,o.filter]])])])),_:1},8,["data","fields","row-click-handler","sort"])])}var d=r(6486),u=r(3907),c=r(9028),p=r(2790),h=r(2262);const f=20,g=(0,h.iH)(0),m=e=>{const t=g.value*f,r=t+f-1;return e.slice(t,r)},S=[{name:"name",sortable:!0,type:String},{name:"email",sortable:!0,type:String},{name:"institution.name",label:"Institution",sortable:!0,type:String,resolveSort(e){return e.institution?e.institution.name:""}}];var b={data(){return{fields:S}},computed:{...(0,u.Se)({currentUser:"currentUser"})},watch:{filter:{immediate:!0,handler(){this.triggerSearch&&this.triggerSearch()}},sort:{immediate:!0,handler(){this.triggerSearch&&this.triggerSearch()}}},methods:{goToPerson(e){this.$router.push("/people/"+e.uuid)},goToEditPerson(e){this.$router.push(`/people/${e.uuid}/edit`)},canEdit(e){return!!this.hasPermission("people-manage")||this.currentUser.id==e.user_id},async itemProvider(e,t,r,i){const a={page:e,page_size:t,"sort[field]":r.field.name,"sort[dir]":r.desc?"DESC":"ASC","where[filterString]":this.filter},s=await c.hi.get("/api/people",{params:a}).then((e=>e.data));return i(s.meta.total),s.data}},created(){this.triggerSearch&&this.triggerSearch(),this.triggerSearch=(0,d.debounce)((()=>this.$refs.dataTable.getItems()),500)},setup(){const{sort:e,filter:t}=(0,p.Z)();return{sort:e,filter:t,pageSize:f,currentPage:g,getPageItems:m}}},y=r(3744);const v=(0,y.Z)(b,[["render",o]]);var w=v}}]);
//# sourceMappingURL=192.34a090b3.js.map